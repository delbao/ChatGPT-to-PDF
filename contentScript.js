/*! For license information please see contentScript.js.LICENSE.txt */
(()=>{"use strict";var e,t,i,n,s,r={36:(e,t,i)=>{i.d(t,{T:()=>xh});var n=i(382),s=i(976),r=i(664);function o(e){chrome.storage.local.get([r.i3,r.xt,r.Oq,r.VE],function(t){var i=t.successCount||0,n=t.failureCount||0,s=t.hasRated||!1,r=t.lastRatePrompt||0,o=Date.now();e(!s&&(5===i&&0===n||i>5&&0===n&&i%15==5&&o-r>=9e5))})}var a={rateChatGptToPdf:chrome.i18n.getMessage("rateChatGptToPdf"),shareYourExperience:chrome.i18n.getMessage("shareYourExperience"),later:chrome.i18n.getMessage("later")};function l(){var e=document.createElement("div");e.className="rate-us-overlay";var t=document.createElement("div");t.className="rate-us-popup";var i=document.createElement("h2");i.textContent=a.rateChatGptToPdf;var n=document.createElement("p");n.textContent=a.shareYourExperience;var s=document.createElement("div");s.className="star-container",s.addEventListener("mouseleave",function(){e.querySelectorAll(".star").forEach(function(e){e.classList.add("hover")})});for(var o=1;o<=5;o++){var l=document.createElement("span");l.className="star",l.dataset.value=o.toString(),l.innerHTML="&#9733;",l.classList.add("hover"),s.appendChild(l)}var d=document.createElement("button");d.className="later-button",d.textContent=a.later,t.appendChild(i),t.appendChild(n),t.appendChild(s),t.appendChild(d),e.appendChild(t),document.body.appendChild(e),function(e){var t=e.querySelectorAll(".star"),i=e.querySelector(".later-button"),n=0;t.forEach(function(i){var s=i;s.addEventListener("mouseover",function(){var e=parseInt(s.dataset.value||"0",10);c(t,e)}),s.addEventListener("mouseout",function(){c(t,n)}),s.addEventListener("click",function(){var i,o;n=parseInt(s.dataset.value||"0",10),c(t,n),i=n,chrome.storage.local.set({hasRated:!0}),i>=4?(o=r.ae,chrome.runtime.sendMessage({action:r.Dn,url:o})):function(){var e=r.uk;chrome.runtime.sendMessage({action:r.Dn,url:e})}(),e.remove()})}),null==i||i.addEventListener("click",function(){chrome.storage.local.set({lastRatePrompt:Date.now()}),e.remove()})}(e)}function c(e,t){e.forEach(function(e){var i=e;parseInt(i.dataset.value||"0",10)<=t?i.classList.add("hover"):i.classList.remove("hover")})}const d="generated",u="pointerleave",h="pointermove",p="touchend",f="tsParticles - Error",g=100,v=.5,_=1e3,m="random",y=2*Math.PI,b="true",w="false",x="canvas",k=255,S=360,P=255;var T;function E(e){return"boolean"==typeof e}function C(e){return"string"==typeof e}function I(e){return"number"==typeof e}function M(e){return"object"==typeof e&&null!==e}function R(e){return Array.isArray(e)}function F(e){return null==e}!function(e){e.bottom="bottom",e.bottomLeft="bottom-left",e.bottomRight="bottom-right",e.left="left",e.none="none",e.right="right",e.top="top",e.topLeft="top-left",e.topRight="top-right",e.outside="outside",e.inside="inside"}(T||(T={}));class O{constructor(e,t,i){if(this._updateFromAngle=(e,t)=>{this.x=Math.cos(e)*t,this.y=Math.sin(e)*t},!I(e)&&e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:0}else{if(void 0===e||void 0===t)throw new Error(`${f} Vector3d not initialized correctly`);this.x=e,this.y=t,this.z=i??0}}static get origin(){return O.create(0,0,0)}get angle(){return Math.atan2(this.y,this.x)}set angle(e){this._updateFromAngle(e,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(e){this._updateFromAngle(this.angle,e)}static clone(e){return O.create(e.x,e.y,e.z)}static create(e,t,i){return new O(e,t,i)}add(e){return O.create(this.x+e.x,this.y+e.y,this.z+e.z)}addTo(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}copy(){return O.clone(this)}distanceTo(e){return this.sub(e).length}distanceToSq(e){return this.sub(e).getLengthSq()}div(e){return O.create(this.x/e,this.y/e,this.z/e)}divTo(e){this.x/=e,this.y/=e,this.z/=e}getLengthSq(){return this.x**2+this.y**2}mult(e){return O.create(this.x*e,this.y*e,this.z*e)}multTo(e){this.x*=e,this.y*=e,this.z*=e}normalize(){const e=this.length;0!=e&&this.multTo(1/e)}rotate(e){return O.create(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e),0)}setTo(e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:0}sub(e){return O.create(this.x-e.x,this.y-e.y,this.z-e.z)}subFrom(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}class L extends O{constructor(e,t){super(e,t,0)}static get origin(){return L.create(0,0)}static clone(e){return L.create(e.x,e.y)}static create(e,t){return new L(e,t)}}let D=Math.random;const z=e=>requestAnimationFrame(e),G=e=>cancelAnimationFrame(e);function A(){return $(D(),0,1-Number.EPSILON)}function $(e,t,i){return Math.min(Math.max(e,t),i)}function B(e){const t=N(e);let i=j(e);return t===i&&(i=0),A()*(t-i)+i}function q(e){return I(e)?e:B(e)}function j(e){return I(e)?e:e.min}function N(e){return I(e)?e:e.max}function U(e,t){if(e===t||void 0===t&&I(e))return e;const i=j(e),n=N(e);return void 0!==t?{min:Math.min(i,t),max:Math.max(n,t)}:U(i,n)}function H(e,t){const i=e.x-t.x,n=e.y-t.y;return{dx:i,dy:n,distance:Math.sqrt(i**2+n**2)}}function V(e,t){return H(e,t).distance}function W(e){return e*Math.PI/180}function Y(e){return e?e.endsWith("%")?parseFloat(e)/g:parseFloat(e):1}var X,Q,J,K,Z,ee;!function(e){e.auto="auto",e.increase="increase",e.decrease="decrease",e.random="random"}(X||(X={})),function(e){e.increasing="increasing",e.decreasing="decreasing"}(Q||(Q={})),function(e){e.none="none",e.max="max",e.min="min"}(J||(J={})),function(e){e.bottom="bottom",e.left="left",e.right="right",e.top="top"}(K||(K={})),function(e){e.precise="precise",e.percent="percent"}(Z||(Z={})),function(e){e.max="max",e.min="min",e.random="random"}(ee||(ee={}));const te={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function ie(){return te}function ne(){return"undefined"==typeof window||!window||void 0===window.document||!window.document}function se(e){if(!ne()&&"undefined"!=typeof matchMedia)return matchMedia(e)}function re(e,t){return e===t||R(t)&&t.indexOf(e)>-1}async function oe(e,t){try{await document.fonts.load(`${t??"400"} 36px '${e??"Verdana"}'`)}catch{}}function ae(e){return Math.floor(A()*e.length)}function le(e,t,i=!0){return e[void 0!==t&&i?t%e.length:ae(e)]}function ce(e,t,i,n,s){return function(e,t,i,n){let s=!0;return n&&n!==K.bottom||(s=e.top<t.height+i.x),!s||n&&n!==K.left||(s=e.right>i.x),!s||n&&n!==K.right||(s=e.left<t.width+i.y),!s||n&&n!==K.top||(s=e.bottom>i.y),s}(de(e,n??0),t,i,s)}function de(e,t){return{bottom:e.y+t,left:e.x-t,right:e.x+t,top:e.y-t}}function ue(e,...t){for(const i of t){if(null==i)continue;if(!M(i)){e=i;continue}const t=Array.isArray(i);!t||!M(e)&&e&&Array.isArray(e)?t||!M(e)&&e&&!Array.isArray(e)||(e={}):e=[];for(const t in i){if("__proto__"===t)continue;const n=i[t],s=e;s[t]=M(n)&&Array.isArray(n)?n.map(e=>ue(s[t],e)):ue(s[t],n)}}return e}function he(e,t){return R(e)?e.map((e,i)=>t(e,i)):t(e,0)}function pe(e,t,i){return R(e)?le(e,t,i):e}function fe(e,t){const i=e.value,n=e.animation,s={delayTime:q(n.delay)*_,enable:n.enable,value:q(e.value)*t,max:N(i)*t,min:j(i)*t,loops:0,maxLoops:q(n.count),time:0};if(n.enable){switch(s.decay=1-q(n.decay),n.mode){case X.increase:s.status=Q.increasing;break;case X.decrease:s.status=Q.decreasing;break;case X.random:s.status=A()>=v?Q.increasing:Q.decreasing}const e=n.mode===X.auto;switch(n.startValue){case ee.min:s.value=s.min,e&&(s.status=Q.increasing);break;case ee.max:s.value=s.max,e&&(s.status=Q.decreasing);break;case ee.random:default:s.value=B(s),e&&(s.status=A()>=v?Q.increasing:Q.decreasing)}}return s.initialValue=s.value,s}function ge(e,t){if(e.mode!==Z.percent){const{mode:t,...i}=e;return i}return"x"in e?{x:e.x/g*t.width,y:e.y/g*t.height}:{width:e.width/g*t.width,height:e.height/g*t.height}}function ve(e,t){return ge(e,t)}function _e(e,t){return ge(e,t)}function me(e,t,i,n,s){if(e.destroyed||!t||!t.enable||(t.maxLoops??0)>0&&(t.loops??0)>(t.maxLoops??0))return;const r=(t.velocity??0)*s.factor,o=t.min,a=t.max,l=t.decay??1;if(t.time||(t.time=0),(t.delayTime??0)>0&&t.time<(t.delayTime??0)&&(t.time+=s.value),!((t.delayTime??0)>0&&t.time<(t.delayTime??0))){switch(t.status){case Q.increasing:t.value>=a?(i?t.status=Q.decreasing:t.value-=a,t.loops||(t.loops=0),t.loops++):t.value+=r;break;case Q.decreasing:t.value<=o?(i?t.status=Q.increasing:t.value+=a,t.loops||(t.loops=0),t.loops++):t.value-=r}t.velocity&&1!==l&&(t.velocity*=l),function(e,t,i,n,s){switch(t){case J.max:i>=s&&e.destroy();break;case J.min:i<=n&&e.destroy()}}(e,n,t.value,o,a),e.destroyed||(t.value=$(t.value,o,a))}}const ye=function(){const e=new Map;return(...t)=>{const i=JSON.stringify(t);if(e.has(i))return e.get(i);const n=function(e){const t=document.createElement("div").style,i={width:"100%",height:"100%",margin:"0",padding:"0",borderWidth:"0",position:"fixed",zIndex:e.toString(10),"z-index":e.toString(10),top:"0",left:"0"};for(const e in i){const n=i[e];t.setProperty(e,n)}return t}(...t);return e.set(i,n),n}}();var be,we,xe,ke,Se,Pe,Te,Ee,Ce,Ie,Me,Re,Fe;function Oe(e,t,i,n=!0){if(!t)return;const s=C(t)?{value:t}:t;if(C(s.value))return Le(e,s.value,i,n);if(R(s.value))return Oe(e,{value:le(s.value,i,n)});for(const t of e.colorManagers.values()){const e=t.handleRangeColor(s);if(e)return e}}function Le(e,t,i,n=!0){if(!t)return;const s=C(t)?{value:t}:t;if(C(s.value))return s.value===m?function(e){const t=e??0;return{b:Math.floor(B(U(t,256))),g:Math.floor(B(U(t,256))),r:Math.floor(B(U(t,256)))}}():function(e,t){return function(e,t){if(t)for(const i of e.colorManagers.values())if(t.startsWith(i.stringPrefix))return i.parseString(t)}(e,t)}(e,s.value);if(R(s.value))return Le(e,{value:le(s.value,i,n)});for(const t of e.colorManagers.values()){const e=t.handleColor(s);if(e)return e}}function De(e,t,i,n=!0){const s=Oe(e,t,i,n);return s?function(e){const t=e.r/k,i=e.g/k,n=e.b/k,s=Math.max(t,i,n),r=Math.min(t,i,n),o={h:0,l:(s+r)*v,s:0};return s!==r&&(o.s=o.l<v?(s-r)/(s+r):(s-r)/(2-s-r),o.h=t===s?(i-n)/(s-r):o.h=i===s?2+(n-t)/(s-r):4+(t-i)/(s-r)),o.l*=100,o.s*=100,o.h*=60,o.h<0&&(o.h+=S),o.h>=S&&(o.h-=S),o}(s):void 0}function ze(e){const t=(e.h%S+S)%S,i=Math.max(0,Math.min(100,e.s)),n=Math.max(0,Math.min(100,e.l)),s=t/S,r=i/100,o=n/100;if(0===i){const e=Math.round(o*P);return{r:e,g:e,b:e}}const a=(e,t,i)=>(i<0&&i++,i>1&&i--,6*i<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e),l=o<v?o*(1+r):o+r-o*r,c=2*o-l,d=1/3,u=Math.min(P,P*a(c,l,s+d)),h=Math.min(P,P*a(c,l,s)),p=Math.min(P,P*a(c,l,s-d));return{r:Math.round(u),g:Math.round(h),b:Math.round(p)}}function Ge(e,t){return`rgba(${e.r}, ${e.g}, ${e.b}, ${t??1})`}function Ae(e,t){return`hsla(${e.h}, ${e.s}%, ${e.l}%, ${t??1})`}function $e(e){return void 0!==e?{h:e.h.value,s:e.s.value,l:e.l.value}:void 0}function Be(e,t,i){e.enable=t.enable,e.enable?(e.velocity=q(t.speed)/g*i,e.decay=1-q(t.decay),e.status=Q.increasing,e.loops=0,e.maxLoops=q(t.count),e.time=0,e.delayTime=q(t.delay)*_,t.sync||(e.velocity*=A(),e.value*=A()),e.initialValue=e.value,e.offset=U(t.offset)):e.velocity=0}function qe(e,t,i,n){if(!e||!e.enable||(e.maxLoops??0)>0&&(e.loops??0)>(e.maxLoops??0))return;if(e.time||(e.time=0),(e.delayTime??0)>0&&e.time<(e.delayTime??0)&&(e.time+=n.value),(e.delayTime??0)>0&&e.time<(e.delayTime??0))return;const s=e.offset?B(e.offset):0,r=(e.velocity??0)*n.factor+3.6*s,o=e.decay??1,a=N(t),l=j(t);if(i&&e.status!==Q.increasing){e.value-=r;const t=0;e.value<t&&(e.loops||(e.loops=0),e.loops++,e.status=Q.increasing)}else e.value+=r,e.value>a&&(e.loops||(e.loops=0),e.loops++,i?e.status=Q.decreasing:e.value-=a);e.velocity&&1!==o&&(e.velocity*=o),e.value=$(e.value,l,a)}function je(e,t){e.clearRect(0,0,t.width,t.height)}function Ne(e,t,i){const n=t[i];void 0!==n&&(e[i]=(e[i]??1)*n)}function Ue(e,t,i=!1){if(!t)return;if(!e)return;const n=e.style;if(!n)return;const s=new Set;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&s.add(n[e]);for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&s.add(t[e]);for(const e of s){const s=t.getPropertyValue(e);s?n.setProperty(e,s,i?"important":""):n.removeProperty(e)}}!function(e){e.darken="darken",e.enlighten="enlighten"}(be||(be={}));class He{constructor(e,t){this.container=e,this._applyPostDrawUpdaters=e=>{for(const t of this._postDrawUpdaters)t.afterDraw?.(e)},this._applyPreDrawUpdaters=(e,t,i,n,s,r)=>{for(const o of this._preDrawUpdaters){if(o.getColorStyles){const{fill:r,stroke:a}=o.getColorStyles(t,e,i,n);r&&(s.fill=r),a&&(s.stroke=a)}if(o.getTransformValues){const e=o.getTransformValues(t);for(const t in e)Ne(r,e,t)}o.beforeDraw?.(t)}},this._applyResizePlugins=()=>{for(const e of this._resizePlugins)e.resize?.()},this._getPluginParticleColors=e=>{let t,i;for(const n of this._colorPlugins)if(!t&&n.particleFillColor&&(t=De(this._engine,n.particleFillColor(e))),!i&&n.particleStrokeColor&&(i=De(this._engine,n.particleStrokeColor(e))),t&&i)break;return[t,i]},this._initCover=async()=>{const e=this.container.actualOptions.backgroundMask.cover,t=e.color;if(t){const i=Oe(this._engine,t);if(i){const t={...i,a:e.opacity};this._coverColorStyle=Ge(t,t.a)}}else await new Promise((t,i)=>{if(!e.image)return;const n=document.createElement("img");n.addEventListener("load",()=>{this._coverImage={image:n,opacity:e.opacity},t()}),n.addEventListener("error",e=>{i(e.error)}),n.src=e.image})},this._initStyle=()=>{const e=this.element,t=this.container.actualOptions;if(e){this._fullScreen?this._setFullScreenStyle():this._resetOriginalStyle();for(const i in t.style){if(!i||!t.style||!Object.prototype.hasOwnProperty.call(t.style,i))continue;const n=t.style[i];n&&e.style.setProperty(i,n,"important")}}},this._initTrail=async()=>{const e=this.container.actualOptions.particles.move.trail,t=e.fill;if(!e.enable)return;const i=1/e.length;if(t.color){const e=Oe(this._engine,t.color);if(!e)return;this._trailFill={color:{...e},opacity:i}}else await new Promise((e,n)=>{if(!t.image)return;const s=document.createElement("img");s.addEventListener("load",()=>{this._trailFill={image:s,opacity:i},e()}),s.addEventListener("error",e=>{n(e.error)}),s.src=t.image})},this._paintBase=e=>{this.draw(t=>function(e,t,i){e.fillStyle=i??"rgba(0,0,0,0)",e.fillRect(0,0,t.width,t.height)}(t,this.size,e))},this._paintImage=(e,t)=>{this.draw(i=>function(e,t,i,n){i&&(e.globalAlpha=n,e.drawImage(i,0,0,t.width,t.height),e.globalAlpha=1)}(i,this.size,e,t))},this._repairStyle=()=>{const e=this.element;e&&(this._safeMutationObserver(e=>e.disconnect()),this._initStyle(),this.initBackground(),this._safeMutationObserver(t=>{e&&e instanceof Node&&t.observe(e,{attributes:!0})}))},this._resetOriginalStyle=()=>{const e=this.element,t=this._originalStyle;e&&t&&Ue(e,t,!0)},this._safeMutationObserver=e=>{this._mutationObserver&&e(this._mutationObserver)},this._setFullScreenStyle=()=>{const e=this.element;e&&Ue(e,ye(this.container.actualOptions.fullScreen.zIndex),!0)},this._engine=t,this._standardSize={height:0,width:0};const i=e.retina.pixelRatio,n=this._standardSize;this.size={height:n.height*i,width:n.width*i},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){const e=this.container.actualOptions,t=e.particles.move.trail,i=this._trailFill;e.backgroundMask.enable?this.paint():t.enable&&t.length>0&&i?i.color?this._paintBase(Ge(i.color,i.opacity)):i.image&&this._paintImage(i.image,i.opacity):e.clear&&this.draw(e=>{je(e,this.size)})}destroy(){if(this.stop(),this._generated){const e=this.element;e?.remove(),this.element=void 0}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(e){const t=this._context;if(t)return e(t)}drawAsync(e){const t=this._context;if(t)return e(t)}drawParticle(e,t){if(e.spawning||e.destroyed)return;const i=e.getRadius();if(i<=0)return;const n=e.getFillColor(),s=e.getStrokeColor()??n;let[r,o]=this._getPluginParticleColors(e);r||(r=n),o||(o=s),(r||o)&&this.draw(n=>{const s=this.container,a=s.actualOptions,l=e.options.zIndex,c=1-e.zIndexFactor,d=c**l.opacityRate,u=e.bubble.opacity??e.opacity?.value??1,h=u*d,p=(e.strokeOpacity??u)*d,f={},g={fill:r?Ae(r,h):void 0};g.stroke=o?Ae(o,p):g.fill,this._applyPreDrawUpdaters(n,e,i,h,g,f),function(e){const{container:t,context:i,particle:n,delta:s,colorStyles:r,backgroundMask:o,composite:a,radius:l,opacity:c,shadow:d,transform:u}=e,h=n.getPosition(),p=n.rotation+(n.pathRotation?n.velocity.angle:0),f=Math.sin(p),g=Math.cos(p),v=!!p,_={a:g*(u.a??1),b:v?f*(u.b??1):u.b??0,c:v?-f*(u.c??1):u.c??0,d:g*(u.d??1)};i.setTransform(_.a,_.b,_.c,_.d,h.x,h.y),o&&(i.globalCompositeOperation=a);const m=n.shadowColor;d.enable&&m&&(i.shadowBlur=d.blur,i.shadowColor=Ge(m),i.shadowOffsetX=d.offset.x,i.shadowOffsetY=d.offset.y),r.fill&&(i.fillStyle=r.fill);const y=n.strokeWidth??0;i.lineWidth=y,r.stroke&&(i.strokeStyle=r.stroke);const b={container:t,context:i,particle:n,radius:l,opacity:c,delta:s,transformData:_,strokeWidth:y};!function(e){const{container:t,context:i,particle:n,radius:s,opacity:r,delta:o,strokeWidth:a,transformData:l}=e;if(!n.shape)return;const c=t.shapeDrawers.get(n.shape);c&&(i.beginPath(),c.draw({context:i,particle:n,radius:s,opacity:r,delta:o,pixelRatio:t.retina.pixelRatio,transformData:{...l}}),n.shapeClose&&i.closePath(),a>0&&i.stroke(),n.shapeFill&&i.fill())}(b),function(e){const{container:t,context:i,particle:n,radius:s,opacity:r,delta:o,transformData:a}=e;if(!n.shape)return;const l=t.shapeDrawers.get(n.shape);l?.afterDraw&&l.afterDraw({context:i,particle:n,radius:s,opacity:r,delta:o,pixelRatio:t.retina.pixelRatio,transformData:{...a}})}(b),function(e){const{container:t,context:i,particle:n,radius:s,opacity:r,delta:o,transformData:a}=e;if(!n.effect)return;const l=t.effectDrawers.get(n.effect);l&&l.draw({context:i,particle:n,radius:s,opacity:r,delta:o,pixelRatio:t.retina.pixelRatio,transformData:{...a}})}(b),i.globalCompositeOperation="source-over",i.resetTransform()}({container:s,context:n,particle:e,delta:t,colorStyles:g,backgroundMask:a.backgroundMask.enable,composite:a.backgroundMask.composite,radius:i*c**l.sizeRate,opacity:h,shadow:e.options.shadow,transform:f}),this._applyPostDrawUpdaters(e)})}drawParticlePlugin(e,t,i){this.draw(n=>function(e,t,i,n){t.drawParticle&&t.drawParticle(e,i,n)}(n,e,t,i))}drawPlugin(e,t){this.draw(i=>function(e,t,i){t.draw&&t.draw(e,i)}(i,e,t))}async init(){this._safeMutationObserver(e=>e.disconnect()),this._mutationObserver=function(e){if(!ne()&&"undefined"!=typeof MutationObserver)return new MutationObserver(e)}(e=>{for(const t of e)"attributes"===t.type&&"style"===t.attributeName&&this._repairStyle()}),this.resize(),this._initStyle(),await this._initCover();try{await this._initTrail()}catch(e){ie().error(e)}this.initBackground(),this._safeMutationObserver(e=>{this.element&&this.element instanceof Node&&e.observe(this.element,{attributes:!0})}),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){const e=this.container.actualOptions.background,t=this.element;if(!t)return;const i=t.style;if(i){if(e.color){const t=Oe(this._engine,e.color);i.backgroundColor=t?Ge(t,e.opacity):""}else i.backgroundColor="";i.backgroundImage=e.image||"",i.backgroundPosition=e.position||"",i.backgroundRepeat=e.repeat||"",i.backgroundSize=e.size||""}}initPlugins(){this._resizePlugins=[];for(const e of this.container.plugins.values())e.resize&&this._resizePlugins.push(e),(e.particleFillColor??e.particleStrokeColor)&&this._colorPlugins.push(e)}initUpdaters(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];for(const e of this.container.particles.updaters)e.afterDraw&&this._postDrawUpdaters.push(e),(e.getColorStyles??e.getTransformValues??e.beforeDraw)&&this._preDrawUpdaters.push(e)}loadCanvas(e){this._generated&&this.element&&this.element.remove(),this._generated=e.dataset&&d in e.dataset?"true"===e.dataset[d]:this._generated,this.element=e,this.element.ariaHidden="true",this._originalStyle=function(e){const t=document.createElement("div").style;if(!e)return t;for(const i in e){const n=e[i];if(!Object.prototype.hasOwnProperty.call(e,i)||F(n))continue;const s=e.getPropertyValue?.(n);if(!s)continue;const r=e.getPropertyPriority?.(n);r?t.setProperty?.(n,s,r):t.setProperty?.(n,s)}return t}(this.element.style);const t=this._standardSize;t.height=e.offsetHeight,t.width=e.offsetWidth;const i=this.container.retina.pixelRatio,n=this.size;e.height=n.height=t.height*i,e.width=n.width=t.width*i,this._context=this.element.getContext("2d"),this._safeMutationObserver(e=>e.disconnect()),this.container.retina.init(),this.initBackground(),this._safeMutationObserver(e=>{this.element&&this.element instanceof Node&&e.observe(this.element,{attributes:!0})})}paint(){const e=this.container.actualOptions;this.draw(t=>{e.backgroundMask.enable&&e.backgroundMask.cover?(je(t,this.size),this._coverImage?this._paintImage(this._coverImage.image,this._coverImage.opacity):this._coverColorStyle?this._paintBase(this._coverColorStyle):this._paintBase()):this._paintBase()})}resize(){if(!this.element)return!1;const e=this.container,t=e.canvas._standardSize,i={width:this.element.offsetWidth,height:this.element.offsetHeight},n=e.retina.pixelRatio,s={width:i.width*n,height:i.height*n};if(i.height===t.height&&i.width===t.width&&s.height===this.element.height&&s.width===this.element.width)return!1;const r={...t};t.height=i.height,t.width=i.width;const o=this.size;return this.element.width=o.width=s.width,this.element.height=o.height=s.height,this.container.started&&e.particles.setResizeFactor({width:t.width/r.width,height:t.height/r.height}),!0}stop(){this._safeMutationObserver(e=>e.disconnect()),this._mutationObserver=void 0,this.draw(e=>je(e,this.size))}async windowResize(){if(!this.element||!this.resize())return;const e=this.container,t=e.updateActualOptions();e.particles.setDensity(),this._applyResizePlugins(),t&&await e.refresh()}}function Ve(e,t,i,n,s){if(n){let n={passive:!0};E(s)?n.capture=s:void 0!==s&&(n=s),e.addEventListener(t,i,n)}else{const n=s;e.removeEventListener(t,i,n)}}!function(e){e.canvas="canvas",e.parent="parent",e.window="window"}(we||(we={}));class We{constructor(e){this.container=e,this._doMouseTouchClick=e=>{const t=this.container,i=t.actualOptions;if(this._canPush){const e=t.interactivity.mouse,n=e.position;if(!n)return;e.clickPosition={...n},e.clickTime=(new Date).getTime(),he(i.interactivity.events.onClick.mode,e=>this.container.handleClickMode(e))}"touchend"===e.type&&setTimeout(()=>this._mouseTouchFinish(),500)},this._handleThemeChange=e=>{const t=e,i=this.container,n=i.options,s=n.defaultThemes,r=t.matches?s.dark:s.light,o=n.themes.find(e=>e.name===r);o?.default.auto&&i.loadTheme(r)},this._handleVisibilityChange=()=>{const e=this.container,t=e.actualOptions;this._mouseTouchFinish(),t.pauseOnBlur&&(document?.hidden?(e.pageHidden=!0,e.pause()):(e.pageHidden=!1,e.animationStatus?e.play(!0):e.draw(!0)))},this._handleWindowResize=()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout);const e=async()=>{const e=this.container.canvas;await(e?.windowResize())};this._resizeTimeout=setTimeout(()=>{e()},this.container.actualOptions.interactivity.events.resize.delay*_)},this._manageInteractivityListeners=(e,t)=>{const i=this._handlers,n=this.container,s=n.actualOptions,r=n.interactivity.element;if(!r)return;const o=r,a=n.canvas.element;a&&(a.style.pointerEvents=o===a?"initial":"none"),(s.interactivity.events.onHover.enable||s.interactivity.events.onClick.enable)&&(Ve(r,h,i.mouseMove,t),Ve(r,"touchstart",i.touchStart,t),Ve(r,"touchmove",i.touchMove,t),s.interactivity.events.onClick.enable?(Ve(r,p,i.touchEndClick,t),Ve(r,"pointerup",i.mouseUp,t),Ve(r,"pointerdown",i.mouseDown,t)):Ve(r,p,i.touchEnd,t),Ve(r,e,i.mouseLeave,t),Ve(r,"touchcancel",i.touchCancel,t))},this._manageListeners=e=>{const t=this._handlers,i=this.container,n=i.actualOptions.interactivity.detectsOn,s=i.canvas.element;let r=u;n===we.window?(i.interactivity.element=window,r="pointerout"):n===we.parent&&s?i.interactivity.element=s.parentElement??s.parentNode:i.interactivity.element=s,this._manageMediaMatch(e),this._manageResize(e),this._manageInteractivityListeners(r,e),document&&Ve(document,"visibilitychange",t.visibilityChange,e,!1)},this._manageMediaMatch=e=>{const t=this._handlers,i=se("(prefers-color-scheme: dark)");i&&(void 0===i.addEventListener?void 0!==i.addListener&&(e?i.addListener(t.oldThemeChange):i.removeListener(t.oldThemeChange)):Ve(i,"change",t.themeChange,e))},this._manageResize=e=>{const t=this._handlers,i=this.container;if(!i.actualOptions.interactivity.events.resize)return;if("undefined"==typeof ResizeObserver)return void Ve(window,"resize",t.resize,e);const n=i.canvas.element;this._resizeObserver&&!e?(n&&this._resizeObserver.unobserve(n),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&e&&n&&(this._resizeObserver=new ResizeObserver(e=>{const t=e.find(e=>e.target===n);t&&this._handleWindowResize()}),this._resizeObserver.observe(n))},this._mouseDown=()=>{const{interactivity:e}=this.container;if(!e)return;const{mouse:t}=e;t.clicking=!0,t.downPosition=t.position},this._mouseTouchClick=e=>{const t=this.container,i=t.actualOptions,{mouse:n}=t.interactivity;n.inside=!0;let s=!1;const r=n.position;if(r&&i.interactivity.events.onClick.enable){for(const e of t.plugins.values())if(e.clickPositionValid&&(s=e.clickPositionValid(r),s))break;s||this._doMouseTouchClick(e),n.clicking=!1}},this._mouseTouchFinish=()=>{const e=this.container.interactivity;if(!e)return;const t=e.mouse;delete t.position,delete t.clickPosition,delete t.downPosition,e.status=u,t.inside=!1,t.clicking=!1},this._mouseTouchMove=e=>{const t=this.container,i=t.actualOptions,n=t.interactivity,s=t.canvas.element;if(!n?.element)return;let r;if(n.mouse.inside=!0,e.type.startsWith("pointer")){this._canPush=!0;const t=e;if(n.element===window){if(s){const e=s.getBoundingClientRect();r={x:t.clientX-e.left,y:t.clientY-e.top}}}else if(i.interactivity.detectsOn===we.parent){const e=t.target,i=t.currentTarget;if(e&&i&&s){const n=e.getBoundingClientRect(),o=i.getBoundingClientRect(),a=s.getBoundingClientRect();r={x:t.offsetX+2*n.left-(o.left+a.left),y:t.offsetY+2*n.top-(o.top+a.top)}}else r={x:t.offsetX??t.clientX,y:t.offsetY??t.clientY}}else t.target===s&&(r={x:t.offsetX??t.clientX,y:t.offsetY??t.clientY})}else if(this._canPush="touchmove"!==e.type,s){const t=e,i=t.touches[t.touches.length-1],n=s.getBoundingClientRect();r={x:i.clientX-(n.left??0),y:i.clientY-(n.top??0)}}const o=t.retina.pixelRatio;r&&(r.x*=o,r.y*=o),n.mouse.position=r,n.status=h},this._touchEnd=e=>{const t=e,i=Array.from(t.changedTouches);for(const e of i)this._touches.delete(e.identifier);this._mouseTouchFinish()},this._touchEndClick=e=>{const t=e,i=Array.from(t.changedTouches);for(const e of i)this._touches.delete(e.identifier);this._mouseTouchClick(e)},this._touchStart=e=>{const t=e,i=Array.from(t.changedTouches);for(const e of i)this._touches.set(e.identifier,performance.now());this._mouseTouchMove(e)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:e=>this._mouseTouchMove(e),mouseUp:e=>this._mouseTouchClick(e),touchStart:e=>this._touchStart(e),touchMove:e=>this._mouseTouchMove(e),touchEnd:e=>this._touchEnd(e),touchCancel:e=>this._touchEnd(e),touchEndClick:e=>this._touchEndClick(e),visibilityChange:()=>this._handleVisibilityChange(),themeChange:e=>this._handleThemeChange(e),oldThemeChange:e=>this._handleThemeChange(e),resize:()=>{this._handleWindowResize()}}}addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}}!function(e){e.configAdded="configAdded",e.containerInit="containerInit",e.particlesSetup="particlesSetup",e.containerStarted="containerStarted",e.containerStopped="containerStopped",e.containerDestroyed="containerDestroyed",e.containerPaused="containerPaused",e.containerPlay="containerPlay",e.containerBuilt="containerBuilt",e.particleAdded="particleAdded",e.particleDestroyed="particleDestroyed",e.particleRemoved="particleRemoved"}(xe||(xe={}));class Ye{constructor(){this.value=""}static create(e,t){const i=new Ye;return i.load(e),void 0!==t&&(C(t)||R(t)?i.load({value:t}):i.load(t)),i}load(e){F(e)||F(e.value)||(this.value=e.value)}}class Xe{constructor(){this.color=new Ye,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}load(e){F(e)||(void 0!==e.color&&(this.color=Ye.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.position&&(this.position=e.position),void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.size&&(this.size=e.size),void 0!==e.opacity&&(this.opacity=e.opacity))}}class Qe{constructor(){this.opacity=1}load(e){F(e)||(void 0!==e.color&&(this.color=Ye.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.opacity&&(this.opacity=e.opacity))}}class Je{constructor(){this.composite="destination-out",this.cover=new Qe,this.enable=!1}load(e){if(!F(e)){if(void 0!==e.composite&&(this.composite=e.composite),void 0!==e.cover){const t=e.cover,i=C(e.cover)?{color:e.cover}:e.cover;this.cover.load(void 0!==t.color||void 0!==t.image?t:{color:i})}void 0!==e.enable&&(this.enable=e.enable)}}}class Ke{constructor(){this.enable=!0,this.zIndex=0}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.zIndex&&(this.zIndex=e.zIndex))}}class Ze{constructor(){this.enable=!1,this.mode=[]}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode))}}!function(e){e.circle="circle",e.rectangle="rectangle"}(ke||(ke={}));class et{constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type=ke.circle}load(e){F(e)||(void 0!==e.selectors&&(this.selectors=e.selectors),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.type&&(this.type=e.type))}}class tt{constructor(){this.enable=!1,this.force=2,this.smooth=10}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.force&&(this.force=e.force),void 0!==e.smooth&&(this.smooth=e.smooth))}}class it{constructor(){this.enable=!1,this.mode=[],this.parallax=new tt}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),this.parallax.load(e.parallax))}}class nt{constructor(){this.delay=.5,this.enable=!0}load(e){F(e)||(void 0!==e.delay&&(this.delay=e.delay),void 0!==e.enable&&(this.enable=e.enable))}}class st{constructor(){this.onClick=new Ze,this.onDiv=new et,this.onHover=new it,this.resize=new nt}load(e){if(F(e))return;this.onClick.load(e.onClick);const t=e.onDiv;void 0!==t&&(this.onDiv=he(t,e=>{const t=new et;return t.load(e),t})),this.onHover.load(e.onHover),this.resize.load(e.resize)}}class rt{constructor(e,t){this._engine=e,this._container=t}load(e){if(F(e))return;if(!this._container)return;const t=this._engine.interactors.get(this._container);if(t)for(const i of t)i.loadModeOptions&&i.loadModeOptions(this,e)}}class ot{constructor(e,t){this.detectsOn=we.window,this.events=new st,this.modes=new rt(e,t)}load(e){if(F(e))return;const t=e.detectsOn;void 0!==t&&(this.detectsOn=t),this.events.load(e.events),this.modes.load(e.modes)}}class at{load(e){F(e)||(e.position&&(this.position={x:e.position.x??50,y:e.position.y??50,mode:e.position.mode??Z.percent}),e.options&&(this.options=ue({},e.options)))}}!function(e){e.screen="screen",e.canvas="canvas"}(Se||(Se={}));class lt{constructor(){this.maxWidth=1/0,this.options={},this.mode=Se.canvas}load(e){F(e)||(F(e.maxWidth)||(this.maxWidth=e.maxWidth),F(e.mode)||(e.mode===Se.screen?this.mode=Se.screen:this.mode=Se.canvas),F(e.options)||(this.options=ue({},e.options)))}}!function(e){e.any="any",e.dark="dark",e.light="light"}(Pe||(Pe={}));class ct{constructor(){this.auto=!1,this.mode=Pe.any,this.value=!1}load(e){F(e)||(void 0!==e.auto&&(this.auto=e.auto),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}class dt{constructor(){this.name="",this.default=new ct}load(e){F(e)||(void 0!==e.name&&(this.name=e.name),this.default.load(e.default),void 0!==e.options&&(this.options=ue({},e.options)))}}class ut{constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}load(e){F(e)||(void 0!==e.count&&(this.count=U(e.count)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=U(e.speed)),void 0!==e.decay&&(this.decay=U(e.decay)),void 0!==e.delay&&(this.delay=U(e.delay)),void 0!==e.sync&&(this.sync=e.sync))}}class ht extends ut{constructor(){super(),this.mode=X.auto,this.startValue=ee.random}load(e){super.load(e),F(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.startValue&&(this.startValue=e.startValue))}}class pt extends ut{constructor(){super(),this.offset=0,this.sync=!0}load(e){super.load(e),F(e)||void 0!==e.offset&&(this.offset=U(e.offset))}}class ft{constructor(){this.h=new pt,this.s=new pt,this.l=new pt}load(e){F(e)||(this.h.load(e.h),this.s.load(e.s),this.l.load(e.l))}}class gt extends Ye{constructor(){super(),this.animation=new ft}static create(e,t){const i=new gt;return i.load(e),void 0!==t&&(C(t)||R(t)?i.load({value:t}):i.load(t)),i}load(e){if(super.load(e),F(e))return;const t=e.animation;void 0!==t&&(void 0!==t.enable?this.animation.h.load(t):this.animation.load(e.animation))}}!function(e){e.absorb="absorb",e.bounce="bounce",e.destroy="destroy"}(Te||(Te={}));class vt{constructor(){this.speed=2}load(e){F(e)||void 0!==e.speed&&(this.speed=e.speed)}}class _t{constructor(){this.enable=!0,this.retries=0}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.retries&&(this.retries=e.retries))}}class mt{constructor(){this.value=0}load(e){F(e)||F(e.value)||(this.value=U(e.value))}}class yt extends mt{constructor(){super(),this.animation=new ut}load(e){if(super.load(e),F(e))return;const t=e.animation;void 0!==t&&this.animation.load(t)}}class bt extends yt{constructor(){super(),this.animation=new ht}load(e){super.load(e)}}class wt extends mt{constructor(){super(),this.value=1}}class xt{constructor(){this.horizontal=new wt,this.vertical=new wt}load(e){F(e)||(this.horizontal.load(e.horizontal),this.vertical.load(e.vertical))}}class kt{constructor(){this.absorb=new vt,this.bounce=new xt,this.enable=!1,this.maxSpeed=50,this.mode=Te.bounce,this.overlap=new _t}load(e){F(e)||(this.absorb.load(e.absorb),this.bounce.load(e.bounce),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.maxSpeed&&(this.maxSpeed=U(e.maxSpeed)),void 0!==e.mode&&(this.mode=e.mode),this.overlap.load(e.overlap))}}class St{constructor(){this.close=!0,this.fill=!0,this.options={},this.type=[]}load(e){if(F(e))return;const t=e.options;if(void 0!==t)for(const e in t){const i=t[e];i&&(this.options[e]=ue(this.options[e]??{},i))}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}class Pt{constructor(){this.offset=0,this.value=90}load(e){F(e)||(void 0!==e.offset&&(this.offset=U(e.offset)),void 0!==e.value&&(this.value=U(e.value)))}}class Tt{constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}load(e){if(!F(e)&&(void 0!==e.distance&&(this.distance=U(e.distance)),void 0!==e.enable&&(this.enable=e.enable),e.rotate)){const t=e.rotate.x;void 0!==t&&(this.rotate.x=t);const i=e.rotate.y;void 0!==i&&(this.rotate.y=i)}}}class Et{constructor(){this.x=50,this.y=50,this.mode=Z.percent,this.radius=0}load(e){F(e)||(void 0!==e.x&&(this.x=e.x),void 0!==e.y&&(this.y=e.y),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.radius&&(this.radius=e.radius))}}class Ct{constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}load(e){F(e)||(void 0!==e.acceleration&&(this.acceleration=U(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.inverse&&(this.inverse=e.inverse),void 0!==e.maxSpeed&&(this.maxSpeed=U(e.maxSpeed)))}}class It{constructor(){this.clamp=!0,this.delay=new mt,this.enable=!1,this.options={}}load(e){F(e)||(void 0!==e.clamp&&(this.clamp=e.clamp),this.delay.load(e.delay),void 0!==e.enable&&(this.enable=e.enable),this.generator=e.generator,e.options&&(this.options=ue(this.options,e.options)))}}class Mt{load(e){F(e)||(void 0!==e.color&&(this.color=Ye.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image))}}class Rt{constructor(){this.enable=!1,this.length=10,this.fill=new Mt}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.fill&&this.fill.load(e.fill),void 0!==e.length&&(this.length=e.length))}}!function(e){e.bounce="bounce",e.none="none",e.out="out",e.destroy="destroy",e.split="split"}(Ee||(Ee={}));class Ft{constructor(){this.default=Ee.out}load(e){F(e)||(void 0!==e.default&&(this.default=e.default),this.bottom=e.bottom??e.default,this.left=e.left??e.default,this.right=e.right??e.default,this.top=e.top??e.default)}}class Ot{constructor(){this.acceleration=0,this.enable=!1}load(e){F(e)||(void 0!==e.acceleration&&(this.acceleration=U(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),e.position&&(this.position=ue({},e.position)))}}class Lt{constructor(){this.angle=new Pt,this.attract=new Tt,this.center=new Et,this.decay=0,this.distance={},this.direction=T.none,this.drift=0,this.enable=!1,this.gravity=new Ct,this.path=new It,this.outModes=new Ft,this.random=!1,this.size=!1,this.speed=2,this.spin=new Ot,this.straight=!1,this.trail=new Rt,this.vibrate=!1,this.warp=!1}load(e){if(F(e))return;this.angle.load(I(e.angle)?{value:e.angle}:e.angle),this.attract.load(e.attract),this.center.load(e.center),void 0!==e.decay&&(this.decay=U(e.decay)),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.distance&&(this.distance=I(e.distance)?{horizontal:e.distance,vertical:e.distance}:{...e.distance}),void 0!==e.drift&&(this.drift=U(e.drift)),void 0!==e.enable&&(this.enable=e.enable),this.gravity.load(e.gravity);const t=e.outModes;void 0!==t&&(M(t)?this.outModes.load(t):this.outModes.load({default:t})),this.path.load(e.path),void 0!==e.random&&(this.random=e.random),void 0!==e.size&&(this.size=e.size),void 0!==e.speed&&(this.speed=U(e.speed)),this.spin.load(e.spin),void 0!==e.straight&&(this.straight=e.straight),this.trail.load(e.trail),void 0!==e.vibrate&&(this.vibrate=e.vibrate),void 0!==e.warp&&(this.warp=e.warp)}}class Dt extends ht{constructor(){super(),this.destroy=J.none,this.speed=2}load(e){super.load(e),F(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}class zt extends bt{constructor(){super(),this.animation=new Dt,this.value=1}load(e){if(F(e))return;super.load(e);const t=e.animation;void 0!==t&&this.animation.load(t)}}class Gt{constructor(){this.enable=!1,this.width=1920,this.height=1080}load(e){if(F(e))return;void 0!==e.enable&&(this.enable=e.enable);const t=e.width;void 0!==t&&(this.width=t);const i=e.height;void 0!==i&&(this.height=i)}}!function(e){e.delete="delete",e.wait="wait"}(Ce||(Ce={}));class At{constructor(){this.mode=Ce.delete,this.value=0}load(e){F(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}class $t{constructor(){this.density=new Gt,this.limit=new At,this.value=0}load(e){F(e)||(this.density.load(e.density),this.limit.load(e.limit),void 0!==e.value&&(this.value=e.value))}}class Bt{constructor(){this.blur=0,this.color=new Ye,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}load(e){F(e)||(void 0!==e.blur&&(this.blur=e.blur),this.color=Ye.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.offset&&(void 0!==e.offset.x&&(this.offset.x=e.offset.x),void 0!==e.offset.y&&(this.offset.y=e.offset.y)))}}class qt{constructor(){this.close=!0,this.fill=!0,this.options={},this.type="circle"}load(e){if(F(e))return;const t=e.options;if(void 0!==t)for(const e in t){const i=t[e];i&&(this.options[e]=ue(this.options[e]??{},i))}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}class jt extends ht{constructor(){super(),this.destroy=J.none,this.speed=5}load(e){super.load(e),F(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}class Nt extends bt{constructor(){super(),this.animation=new jt,this.value=3}load(e){if(super.load(e),F(e))return;const t=e.animation;void 0!==t&&this.animation.load(t)}}class Ut{constructor(){this.width=0}load(e){F(e)||(void 0!==e.color&&(this.color=gt.create(this.color,e.color)),void 0!==e.width&&(this.width=U(e.width)),void 0!==e.opacity&&(this.opacity=U(e.opacity)))}}class Ht extends mt{constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}load(e){super.load(e),F(e)||(void 0!==e.opacityRate&&(this.opacityRate=e.opacityRate),void 0!==e.sizeRate&&(this.sizeRate=e.sizeRate),void 0!==e.velocityRate&&(this.velocityRate=e.velocityRate))}}class Vt{constructor(e,t){this._engine=e,this._container=t,this.bounce=new xt,this.collisions=new kt,this.color=new gt,this.color.value="#fff",this.effect=new St,this.groups={},this.move=new Lt,this.number=new $t,this.opacity=new zt,this.reduceDuplicates=!1,this.shadow=new Bt,this.shape=new qt,this.size=new Nt,this.stroke=new Ut,this.zIndex=new Ht}load(e){if(F(e))return;if(void 0!==e.groups)for(const t of Object.keys(e.groups)){if(!Object.hasOwn(e.groups,t))continue;const i=e.groups[t];void 0!==i&&(this.groups[t]=ue(this.groups[t]??{},i))}void 0!==e.reduceDuplicates&&(this.reduceDuplicates=e.reduceDuplicates),this.bounce.load(e.bounce),this.color.load(gt.create(this.color,e.color)),this.effect.load(e.effect),this.move.load(e.move),this.number.load(e.number),this.opacity.load(e.opacity),this.shape.load(e.shape),this.size.load(e.size),this.shadow.load(e.shadow),this.zIndex.load(e.zIndex),this.collisions.load(e.collisions),void 0!==e.interactivity&&(this.interactivity=ue({},e.interactivity));const t=e.stroke;if(t&&(this.stroke=he(t,e=>{const t=new Ut;return t.load(e),t})),this._container){const t=this._engine.updaters.get(this._container);if(t)for(const i of t)i.loadOptions&&i.loadOptions(this,e);const i=this._engine.interactors.get(this._container);if(i)for(const t of i)t.loadParticlesOptions&&t.loadParticlesOptions(this,e)}}}function Wt(e,...t){for(const i of t)e.load(i)}function Yt(e,t,...i){const n=new Vt(e,t);return Wt(n,...i),n}class Xt{constructor(e,t){this._findDefaultTheme=e=>this.themes.find(t=>t.default.value&&t.default.mode===e)??this.themes.find(e=>e.default.value&&e.default.mode===Pe.any),this._importPreset=e=>{this.load(this._engine.getPreset(e))},this._engine=e,this._container=t,this.autoPlay=!0,this.background=new Xe,this.backgroundMask=new Je,this.clear=!0,this.defaultThemes={},this.delay=0,this.fullScreen=new Ke,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new ot(e,t),this.manualParticles=[],this.particles=Yt(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}load(e){if(F(e))return;void 0!==e.preset&&he(e.preset,e=>this._importPreset(e)),void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.clear&&(this.clear=e.clear),void 0!==e.key&&(this.key=e.key),void 0!==e.name&&(this.name=e.name),void 0!==e.delay&&(this.delay=U(e.delay));const t=e.detectRetina;void 0!==t&&(this.detectRetina=t),void 0!==e.duration&&(this.duration=U(e.duration));const i=e.fpsLimit;void 0!==i&&(this.fpsLimit=i),void 0!==e.pauseOnBlur&&(this.pauseOnBlur=e.pauseOnBlur),void 0!==e.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=e.pauseOnOutsideViewport),void 0!==e.zLayers&&(this.zLayers=e.zLayers),this.background.load(e.background);const n=e.fullScreen;E(n)?this.fullScreen.enable=n:this.fullScreen.load(n),this.backgroundMask.load(e.backgroundMask),this.interactivity.load(e.interactivity),e.manualParticles&&(this.manualParticles=e.manualParticles.map(e=>{const t=new at;return t.load(e),t})),this.particles.load(e.particles),this.style=ue(this.style,e.style),this._engine.loadOptions(this,e),void 0!==e.smooth&&(this.smooth=e.smooth);const s=this._engine.interactors.get(this._container);if(s)for(const t of s)t.loadOptions&&t.loadOptions(this,e);if(void 0!==e.responsive)for(const t of e.responsive){const e=new lt;e.load(t),this.responsive.push(e)}if(this.responsive.sort((e,t)=>e.maxWidth-t.maxWidth),void 0!==e.themes)for(const t of e.themes){const e=this.themes.find(e=>e.name===t.name);if(e)e.load(t);else{const e=new dt;e.load(t),this.themes.push(e)}}this.defaultThemes.dark=this._findDefaultTheme(Pe.dark)?.name,this.defaultThemes.light=this._findDefaultTheme(Pe.light)?.name}setResponsive(e,t,i){this.load(i);const n=this.responsive.find(i=>i.mode===Se.screen&&screen?i.maxWidth>screen.availWidth:i.maxWidth*t>e);return this.load(n?.options),n?.maxWidth}setTheme(e){if(e){const t=this.themes.find(t=>t.name===e);t&&this.load(t.options)}else{const e=se("(prefers-color-scheme: dark)"),t=e?.matches,i=this._findDefaultTheme(t?Pe.dark:Pe.light);i&&this.load(i.options)}}}(Fe=Ie||(Ie={})).external="external",Fe.particles="particles";class Qt{constructor(e,t){this.container=t,this._engine=e,this._interactors=[],this._externalInteractors=[],this._particleInteractors=[]}externalInteract(e){for(const t of this._externalInteractors)t.isEnabled()&&t.interact(e)}handleClickMode(e){for(const t of this._externalInteractors)t.handleClickMode?.(e)}async init(){this._interactors=await this._engine.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[];for(const e of this._interactors){switch(e.type){case Ie.external:this._externalInteractors.push(e);break;case Ie.particles:this._particleInteractors.push(e)}e.init()}}particlesInteract(e,t){for(const i of this._externalInteractors)i.clear(e,t);for(const i of this._particleInteractors)i.isEnabled(e)&&i.interact(e,t)}reset(e){for(const t of this._externalInteractors)t.isEnabled()&&t.reset(e);for(const t of this._particleInteractors)t.isEnabled(e)&&t.reset(e)}}function Jt(e){if(!re(e.outMode,e.checkModes))return;const t=2*e.radius;e.coord>e.maxCoord-t?e.setCb(-e.radius):e.coord<t&&e.setCb(e.radius)}!function(e){e.normal="normal",e.inside="inside",e.outside="outside"}(Me||(Me={}));class Kt{constructor(e,t){this.container=t,this._calcPosition=(e,t,i,n=0)=>{for(const n of e.plugins.values()){const e=void 0!==n.particlePosition?n.particlePosition(t,this):void 0;if(e)return O.create(e.x,e.y,i)}const s=(d={size:e.canvas.size,position:t},{x:d.position?.x??A()*d.size.width,y:d.position?.y??A()*d.size.height}),r=O.create(s.x,s.y,i),o=this.getRadius(),a=this.options.move.outModes,l=t=>{Jt({outMode:t,checkModes:[Ee.bounce],coord:r.x,maxCoord:e.canvas.size.width,setCb:e=>r.x+=e,radius:o})},c=t=>{Jt({outMode:t,checkModes:[Ee.bounce],coord:r.y,maxCoord:e.canvas.size.height,setCb:e=>r.y+=e,radius:o})};var d;return l(a.left??a.default),l(a.right??a.default),c(a.top??a.default),c(a.bottom??a.default),this._checkOverlap(r,n)?this._calcPosition(e,void 0,i,n+1):r},this._calculateVelocity=()=>{const e=function(e){const t=L.origin;return t.length=1,t.angle=e,t}(this.direction).copy(),t=this.options.move;if(t.direction===T.inside||t.direction===T.outside)return e;const i=W(q(t.angle.value)),n=W(q(t.angle.offset)),s={left:n-i*v,right:n+i*v};return t.straight||(e.angle+=B(U(s.left,s.right))),t.random&&"number"==typeof t.speed&&(e.length*=A()),e},this._checkOverlap=(e,t=0)=>{const i=this.options.collisions,n=this.getRadius();if(!i.enable)return!1;const s=i.overlap;if(s.enable)return!1;const r=s.retries;if(r>=0&&t>r)throw new Error(`${f} particle is overlapping and can't be placed`);return!!this.container.particles.find(t=>V(e,t.position)<n+t.getRadius())},this._getRollColor=e=>{if(!e||!this.roll||!this.backColor&&!this.roll.alter)return e;const t=this.roll.horizontal&&this.roll.vertical?2:1,i=this.roll.horizontal?Math.PI*v:0;return Math.floor(((this.roll.angle??0)+i)/(Math.PI/t))%2?this.backColor?this.backColor:this.roll.alter?function(e,t,i){return{h:e.h,s:e.s,l:e.l+(t===be.darken?-1:1)*i}}(e,this.roll.alter.type,this.roll.alter.value):e:e},this._initPosition=e=>{const t=this.container,i=q(this.options.zIndex.value);this.position=this._calcPosition(t,e,$(i,0,t.zLayers)),this.initialPosition=this.position.copy();const n=t.canvas.size;switch(this.moveCenter={...ve(this.options.move.center,n),radius:this.options.move.center.radius??0,mode:this.options.move.center.mode??Z.percent},this.direction=function(e,t,i){if(I(e))return W(e);switch(e){case T.top:return-Math.PI*v;case T.topRight:return.25*-Math.PI;case T.right:return 0;case T.bottomRight:return.25*Math.PI;case T.bottom:return Math.PI*v;case T.bottomLeft:return.75*Math.PI;case T.left:return Math.PI;case T.topLeft:return.75*-Math.PI;case T.inside:return Math.atan2(i.y-t.y,i.x-t.x);case T.outside:return Math.atan2(t.y-i.y,t.x-i.x);default:return A()*y}}(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case T.inside:this.outType=Me.inside;break;case T.outside:this.outType=Me.outside}this.offset=L.origin},this._engine=e}destroy(e){if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;const t=this.container,i=this.pathGenerator,n=t.shapeDrawers.get(this.shape);n?.particleDestroy?.(this);for(const i of t.plugins.values())i.particleDestroyed?.(this,e);for(const i of t.particles.updaters)i.particleDestroyed?.(this,e);i?.reset(this),this._engine.dispatchEvent(xe.particleDestroyed,{container:this.container,data:{particle:this}})}draw(e){const t=this.container,i=t.canvas;for(const n of t.plugins.values())i.drawParticlePlugin(n,this,e);i.drawParticle(this,e)}getFillColor(){return this._getRollColor(this.bubble.color??$e(this.color))}getMass(){return this.getRadius()**2*Math.PI*v}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){return this.bubble.radius??this.size.value}getStrokeColor(){return this._getRollColor(this.bubble.color??$e(this.strokeColor))}init(e,t,i,n){const s=this.container,r=this._engine;this.id=e,this.group=n,this.effectClose=!0,this.effectFill=!0,this.shapeClose=!0,this.shapeFill=!0,this.pathRotation=!1,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.isRotating=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType=Me.normal,this.ignoresResizeRatio=!0;const o=s.retina.pixelRatio,a=s.actualOptions,l=Yt(this._engine,s,a.particles),{reduceDuplicates:c}=l,d=l.effect.type,u=l.shape.type;this.effect=pe(d,this.id,c),this.shape=pe(u,this.id,c);const h=l.effect,p=l.shape;if(i){if(i.effect?.type){const e=pe(i.effect.type,this.id,c);e&&(this.effect=e,h.load(i.effect))}if(i.shape?.type){const e=pe(i.shape.type,this.id,c);e&&(this.shape=e,p.load(i.shape))}}if(this.effect===m){const e=[...this.container.effectDrawers.keys()];this.effect=e[Math.floor(Math.random()*e.length)]}if(this.shape===m){const e=[...this.container.shapeDrawers.keys()];this.shape=e[Math.floor(Math.random()*e.length)]}this.effectData=function(e,t,i,n){const s=t.options[e];if(s)return ue({close:t.close,fill:t.fill},pe(s,i,n))}(this.effect,h,this.id,c),this.shapeData=function(e,t,i,n){const s=t.options[e];if(s)return ue({close:t.close,fill:t.fill},pe(s,i,n))}(this.shape,p,this.id,c),l.load(i);const f=this.effectData;f&&l.load(f.particles);const g=this.shapeData;g&&l.load(g.particles);const v=new ot(r,s);v.load(s.actualOptions.interactivity),v.load(l.interactivity),this.interactivity=v,this.effectFill=f?.fill??l.effect.fill,this.effectClose=f?.close??l.effect.close,this.shapeFill=g?.fill??l.shape.fill,this.shapeClose=g?.close??l.shape.close,this.options=l;const y=this.options.move.path;this.pathDelay=q(y.delay.value)*_,y.generator&&(this.pathGenerator=this._engine.getPathGenerator(y.generator),this.pathGenerator&&s.addPath(y.generator,this.pathGenerator)&&this.pathGenerator.init(s)),s.retina.initParticle(this),this.size=fe(this.options.size,o),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(t),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=1-q(this.options.move.decay);const b=s.particles;b.setLastZIndex(this.position.z),this.zIndexFactor=this.position.z/s.zLayers,this.sides=24;let w=s.effectDrawers.get(this.effect);w||(w=this._engine.getEffectDrawer(this.effect),w&&s.effectDrawers.set(this.effect,w)),w?.loadEffect&&w.loadEffect(this);let x=s.shapeDrawers.get(this.shape);x||(x=this._engine.getShapeDrawer(this.shape),x&&s.shapeDrawers.set(this.shape,x)),x?.loadShape&&x.loadShape(this);const k=x?.getSidesCount;k&&(this.sides=k(this)),this.spawning=!1,this.shadowColor=Oe(this._engine,this.options.shadow.color);for(const e of b.updaters)e.init(this);for(const e of b.movers)e.init?.(this);w?.particleInit?.(s,this),x?.particleInit?.(s,this);for(const e of s.plugins.values())e.particleCreated?.(this)}isInsideCanvas(){const e=this.getRadius(),t=this.container.canvas.size,i=this.position;return i.x>=-e&&i.y>=-e&&i.y<=t.height+e&&i.x<=t.width+e}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){for(const e of this.container.particles.updaters)e.reset?.(this)}}class Zt{constructor(e,t){this.position=e,this.particle=t}}!function(e){e.circle="circle",e.rectangle="rectangle"}(Re||(Re={}));class ei{constructor(e,t,i){this.position={x:e,y:t},this.type=i}}class ti extends ei{constructor(e,t,i){super(e,t,Re.circle),this.radius=i}contains(e){return V(e,this.position)<=this.radius}intersects(e){const t=this.position,i=e.position,n=Math.abs(i.x-t.x),s=Math.abs(i.y-t.y),r=this.radius;if(e instanceof ti||e.type===Re.circle)return r+e.radius>Math.sqrt(n**2+s**2);if(e instanceof ii||e.type===Re.rectangle){const t=e,{width:i,height:o}=t.size;return Math.pow(n-i,2)+Math.pow(s-o,2)<=r**2||n<=r+i&&s<=r+o||n<=i||s<=o}return!1}}class ii extends ei{constructor(e,t,i,n){super(e,t,Re.rectangle),this.size={height:n,width:i}}contains(e){const t=this.size.width,i=this.size.height,n=this.position;return e.x>=n.x&&e.x<=n.x+t&&e.y>=n.y&&e.y<=n.y+i}intersects(e){if(e instanceof ti)return e.intersects(this);const t=this.size.width,i=this.size.height,n=this.position,s=e.position,r=e instanceof ii?e.size:{width:0,height:0},o=r.width,a=r.height;return s.x<n.x+t&&s.x+o>n.x&&s.y<n.y+i&&s.y+a>n.y}}class ni{constructor(e,t){this.rectangle=e,this.capacity=t,this._subdivide=()=>{const{x:e,y:t}=this.rectangle.position,{width:i,height:n}=this.rectangle.size,{capacity:s}=this;for(let r=0;r<4;r++){const o=r%2;this._subs.push(new ni(new ii(e+i*v*o,t+n*v*(Math.round(r*v)-o),i*v,n*v),s))}this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}insert(e){return!!this.rectangle.contains(e.position)&&(this._points.length<this.capacity?(this._points.push(e),!0):(this._divided||this._subdivide(),this._subs.some(t=>t.insert(e))))}query(e,t){const i=[];if(!e.intersects(this.rectangle))return[];for(const n of this._points)!e.contains(n.position)&&V(e.position,n.position)>n.particle.getRadius()&&(!t||t(n.particle))||i.push(n.particle);if(this._divided)for(const n of this._subs)i.push(...n.query(e,t));return i}queryCircle(e,t,i){return this.query(new ti(e.x,e.y,t),i)}queryRectangle(e,t,i){return this.query(new ii(e.x,e.y,t.width,t.height),i)}}const si=e=>{const{height:t,width:i}=e;return new ii(-.25*i,-.25*t,1.5*i,1.5*t)};class ri{constructor(e,t){this._addToPool=(...e)=>{this._pool.push(...e)},this._applyDensity=(e,t,i)=>{const n=e.number;if(!e.number.density?.enable)return void(void 0===i?this._limit=n.limit.value:n.limit&&this._groupLimits.set(i,n.limit.value));const s=this._initDensityFactor(n.density),r=n.value,o=n.limit.value>0?n.limit.value:r,a=Math.min(r,o)*s+t,l=Math.min(this.count,this.filter(e=>e.group===i).length);void 0===i?this._limit=n.limit.value*s:this._groupLimits.set(i,n.limit.value*s),l<a?this.push(Math.abs(a-l),void 0,e,i):l>a&&this.removeQuantity(l-a,i)},this._initDensityFactor=e=>{const t=this._container;if(!t.canvas.element||!e.enable)return 1;const i=t.canvas.element,n=t.retina.pixelRatio;return i.width*i.height/(e.height*e.width*n**2)},this._pushParticle=(e,t,i,n)=>{try{let s=this._pool.pop();s||(s=new Kt(this._engine,this._container)),s.init(this._nextId,e,t,i);let r=!0;if(n&&(r=n(s)),!r)return;return this._array.push(s),this._zArray.push(s),this._nextId++,this._engine.dispatchEvent(xe.particleAdded,{container:this._container,data:{particle:s}}),s}catch(e){ie().warning(`${f} adding particle: ${e}`)}},this._removeParticle=(e,t,i)=>{const n=this._array[e];if(!n||n.group!==t)return!1;const s=this._zArray.indexOf(n);return this._array.splice(e,1),this._zArray.splice(s,1),n.destroy(i),this._engine.dispatchEvent(xe.particleRemoved,{container:this._container,data:{particle:n}}),this._addToPool(n),!0},this._engine=e,this._container=t,this._nextId=0,this._array=[],this._zArray=[],this._pool=[],this._limit=0,this._groupLimits=new Map,this._needsSort=!1,this._lastZIndex=0,this._interactionManager=new Qt(e,t),this._pluginsInitialized=!1;const i=t.canvas.size;this.quadTree=new ni(si(i),4),this.movers=[],this.updaters=[]}get count(){return this._array.length}addManualParticles(){const e=this._container;e.actualOptions.manualParticles.forEach(t=>this.addParticle(t.position?ve(t.position,e.canvas.size):void 0,t.options))}addParticle(e,t,i,n){const s=this._container.actualOptions.particles.number.limit.mode,r=void 0===i?this._limit:this._groupLimits.get(i)??this._limit,o=this.count;if(r>0)switch(s){case Ce.delete:{const e=o+1-r;e>0&&this.removeQuantity(e);break}case Ce.wait:if(o>=r)return}return this._pushParticle(e,t,i,n)}clear(){this._array=[],this._zArray=[],this._pluginsInitialized=!1}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}draw(e){const t=this._container,i=t.canvas;i.clear(),this.update(e);for(const n of t.plugins.values())i.drawPlugin(n,e);for(const t of this._zArray)t.draw(e)}filter(e){return this._array.filter(e)}find(e){return this._array.find(e)}get(e){return this._array[e]}handleClickMode(e){this._interactionManager.handleClickMode(e)}async init(){const e=this._container,t=e.actualOptions;this._lastZIndex=0,this._needsSort=!1,await this.initPlugins();let i=!1;for(const t of e.plugins.values())if(i=t.particlesInitialization?.()??i,i)break;if(this.addManualParticles(),!i){const e=t.particles,i=e.groups;for(const t in i){const n=i[t];for(let i=this.count,s=0;s<n.number?.value&&i<e.number.value;i++,s++)this.addParticle(void 0,n,t)}for(let t=this.count;t<e.number.value;t++)this.addParticle()}}async initPlugins(){if(this._pluginsInitialized)return;const e=this._container;this.movers=await this._engine.getMovers(e,!0),this.updaters=await this._engine.getUpdaters(e,!0),await this._interactionManager.init();for(const t of e.pathGenerators.values())t.init(e)}push(e,t,i,n){for(let s=0;s<e;s++)this.addParticle(t?.position,i,n)}async redraw(){this.clear(),await this.init(),this.draw({value:0,factor:0})}remove(e,t,i){this.removeAt(this._array.indexOf(e),void 0,t,i)}removeAt(e,t=1,i,n){if(e<0||e>this.count)return;let s=0;for(let r=e;s<t&&r<this.count;r++)this._removeParticle(r,i,n)&&(r--,s++)}removeQuantity(e,t){this.removeAt(0,e,t)}setDensity(){const e=this._container.actualOptions,t=e.particles.groups;for(const e in t)this._applyDensity(t[e],0,e);this._applyDensity(e.particles,e.manualParticles.length)}setLastZIndex(e){this._lastZIndex=e,this._needsSort=this._needsSort||this._lastZIndex<e}setResizeFactor(e){this._resizeFactor=e}update(e){const t=this._container,i=new Set;this.quadTree=new ni(si(t.canvas.size),4);for(const e of t.pathGenerators.values())e.update();for(const i of t.plugins.values())i.update?.(e);const n=this._resizeFactor;for(const t of this._array){n&&!t.ignoresResizeRatio&&(t.position.x*=n.width,t.position.y*=n.height,t.initialPosition.x*=n.width,t.initialPosition.y*=n.height),t.ignoresResizeRatio=!1,this._interactionManager.reset(t);for(const i of this._container.plugins.values()){if(t.destroyed)break;i.particleUpdate?.(t,e)}for(const i of this.movers)i.isEnabled(t)&&i.move(t,e);t.destroyed?i.add(t):this.quadTree.insert(new Zt(t.getPosition(),t))}if(i.size){const e=e=>!i.has(e);this._array=this.filter(e),this._zArray=this._zArray.filter(e);for(const e of i)this._engine.dispatchEvent(xe.particleRemoved,{container:this._container,data:{particle:e}});this._addToPool(...i)}this._interactionManager.externalInteract(e);for(const t of this._array){for(const i of this.updaters)i.update(t,e);t.destroyed||t.spawning||this._interactionManager.particlesInteract(t,e)}if(delete this._resizeFactor,this._needsSort){const e=this._zArray;e.sort((e,t)=>t.position.z-e.position.z||e.id-t.id),this._lastZIndex=e[e.length-1].position.z,this._needsSort=!1}}}class oi{constructor(e){this.container=e,this.pixelRatio=1,this.reduceFactor=1}init(){const e=this.container,t=e.actualOptions;this.pixelRatio=!t.detectRetina||ne()?1:window.devicePixelRatio,this.reduceFactor=1;const i=this.pixelRatio,n=e.canvas;if(n.element){const e=n.element;n.size.width=e.offsetWidth*i,n.size.height=e.offsetHeight*i}const s=t.particles,r=s.move;this.maxSpeed=q(r.gravity.maxSpeed)*i,this.sizeAnimationSpeed=q(s.size.animation.speed)*i}initParticle(e){const t=e.options,i=this.pixelRatio,n=t.move,s=n.distance,r=e.retina;r.moveDrift=q(n.drift)*i,r.moveSpeed=q(n.speed)*i,r.sizeAnimationSpeed=q(t.size.animation.speed)*i;const o=r.maxDistance;o.horizontal=void 0!==s.horizontal?s.horizontal*i:void 0,o.vertical=void 0!==s.vertical?s.vertical*i:void 0,r.maxSpeed=q(n.gravity.maxSpeed)*i}}function ai(e){return e&&!e.destroyed}function li(e,t,...i){const n=new Xt(e,t);return Wt(n,...i),n}class ci{constructor(e,t,i){this._intersectionManager=e=>{if(ai(this)&&this.actualOptions.pauseOnOutsideViewport)for(const t of e)t.target===this.interactivity.element&&(t.isIntersecting?this.play():this.pause())},this._nextFrame=e=>{try{if(!this._smooth&&void 0!==this._lastFrameTime&&e<this._lastFrameTime+_/this.fpsLimit)return void this.draw(!1);this._lastFrameTime??=e;const t=function(e,t=60,i=!1){return{value:e,factor:i?60/t:60*e/_}}(e-this._lastFrameTime,this.fpsLimit,this._smooth);if(this.addLifeTime(t.value),this._lastFrameTime=e,t.value>_)return void this.draw(!1);if(this.particles.draw(t),!this.alive())return void this.destroy();this.animationStatus&&this.draw(!1)}catch(e){ie().error(`${f} in animation loop`,e)}},this._engine=e,this.id=Symbol(t),this.fpsLimit=120,this._smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this._lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._clickHandlers=new Map,this._sourceOptions=i,this._initialSourceOptions=i,this.retina=new oi(this),this.canvas=new He(this,this._engine),this.particles=new ri(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this._options=li(this._engine,this),this.actualOptions=li(this._engine,this),this._eventListeners=new We(this),this._intersectionObserver=function(e){if(!ne()&&"undefined"!=typeof IntersectionObserver)return new IntersectionObserver(e)}(e=>this._intersectionManager(e)),this._engine.dispatchEvent(xe.containerBuilt,{container:this})}get animationStatus(){return!this._paused&&!this.pageHidden&&ai(this)}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(e){if(!ai(this))return;const t=this.interactivity.element;if(!t)return;const i=(t,i,n)=>{if(!ai(this))return;const s=this.retina.pixelRatio,r={x:i.x*s,y:i.y*s},o=this.particles.quadTree.queryCircle(r,n*s);e(t,o)};let n=!1,s=!1;this._clickHandlers.set("click",e=>{if(!ai(this))return;const t=e,n={x:t.offsetX||t.clientX,y:t.offsetY||t.clientY};i(e,n,1)}),this._clickHandlers.set("touchstart",()=>{ai(this)&&(n=!0,s=!1)}),this._clickHandlers.set("touchmove",()=>{ai(this)&&(s=!0)}),this._clickHandlers.set("touchend",e=>{if(ai(this)){if(n&&!s){const t=e;let n=t.touches[t.touches.length-1];if(!n&&(n=t.changedTouches[t.changedTouches.length-1],!n))return;const s=this.canvas.element,r=s?s.getBoundingClientRect():void 0,o={x:n.clientX-(r?r.left:0),y:n.clientY-(r?r.top:0)};i(e,o,Math.max(n.radiusX,n.radiusY))}n=!1,s=!1}}),this._clickHandlers.set("touchcancel",()=>{ai(this)&&(n=!1,s=!1)});for(const[e,i]of this._clickHandlers)t.addEventListener(e,i)}addLifeTime(e){this._lifeTime+=e}addPath(e,t,i=!1){return!(!ai(this)||!i&&this.pathGenerators.has(e)||(this.pathGenerators.set(e,t),0))}alive(){return!this._duration||this._lifeTime<=this._duration}clearClickHandlers(){if(ai(this)){for(const[e,t]of this._clickHandlers)this.interactivity.element?.removeEventListener(e,t);this._clickHandlers.clear()}}destroy(e=!0){if(ai(this)){this.stop(),this.clearClickHandlers(),this.particles.destroy(),this.canvas.destroy();for(const e of this.effectDrawers.values())e.destroy?.(this);for(const e of this.shapeDrawers.values())e.destroy?.(this);for(const e of this.effectDrawers.keys())this.effectDrawers.delete(e);for(const e of this.shapeDrawers.keys())this.shapeDrawers.delete(e);if(this._engine.clearPlugins(this),this.destroyed=!0,e){const e=this._engine.items,t=e.findIndex(e=>e===this);t>=0&&e.splice(t,1)}this._engine.dispatchEvent(xe.containerDestroyed,{container:this})}}draw(e){if(!ai(this))return;let t=e;const i=e=>{t&&(this._lastFrameTime=void 0,t=!1),this._nextFrame(e)};this._drawAnimationFrame=z(e=>i(e))}async export(e,t={}){for(const i of this.plugins.values()){if(!i.export)continue;const n=await i.export(e,t);if(n.supported)return n.blob}ie().error(`${f} - Export plugin with type ${e} not found`)}handleClickMode(e){if(ai(this)){this.particles.handleClickMode(e);for(const t of this.plugins.values())t.handleClickMode?.(e)}}async init(){if(!ai(this))return;const e=this._engine.getSupportedEffects();for(const t of e){const e=this._engine.getEffectDrawer(t);e&&this.effectDrawers.set(t,e)}const t=this._engine.getSupportedShapes();for(const e of t){const t=this._engine.getShapeDrawer(e);t&&this.shapeDrawers.set(e,t)}await this.particles.initPlugins(),this._options=li(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=li(this._engine,this,this._options);const i=await this._engine.getAvailablePlugins(this);for(const[e,t]of i)this.plugins.set(e,t);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize();const{zLayers:n,duration:s,delay:r,fpsLimit:o,smooth:a}=this.actualOptions;this.zLayers=n,this._duration=q(s)*_,this._delay=q(r)*_,this._lifeTime=0,this.fpsLimit=o>0?o:120,this._smooth=a;for(const e of this.effectDrawers.values())await(e.init?.(this));for(const e of this.shapeDrawers.values())await(e.init?.(this));for(const e of this.plugins.values())await(e.init?.());this._engine.dispatchEvent(xe.containerInit,{container:this}),await this.particles.init(),this.particles.setDensity();for(const e of this.plugins.values())e.particlesSetup?.();this._engine.dispatchEvent(xe.particlesSetup,{container:this})}async loadTheme(e){ai(this)&&(this._currentTheme=e,await this.refresh())}pause(){var e;if(ai(this)&&(void 0!==this._drawAnimationFrame&&(e=this._drawAnimationFrame,G(e),delete this._drawAnimationFrame),!this._paused)){for(const e of this.plugins.values())e.pause?.();this.pageHidden||(this._paused=!0),this._engine.dispatchEvent(xe.containerPaused,{container:this})}}play(e){if(!ai(this))return;const t=this._paused||e;if(!this._firstStart||this.actualOptions.autoPlay){if(this._paused&&(this._paused=!1),t)for(const e of this.plugins.values())e.play&&e.play();this._engine.dispatchEvent(xe.containerPlay,{container:this}),this.draw(t??!1)}else this._firstStart=!1}async refresh(){if(ai(this))return this.stop(),this.start()}async reset(e){if(ai(this))return this._initialSourceOptions=e,this._sourceOptions=e,this._options=li(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=li(this._engine,this,this._options),this.refresh()}async start(){ai(this)&&!this.started&&(await this.init(),this.started=!0,await new Promise(e=>{const t=async()=>{this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element);for(const e of this.plugins.values())await(e.start?.());this._engine.dispatchEvent(xe.containerStarted,{container:this}),this.play(),e()};this._delayTimeout=setTimeout(()=>{t()},this._delay)}))}stop(){if(ai(this)&&this.started){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);for(const e of this.plugins.values())e.stop?.();for(const e of this.plugins.keys())this.plugins.delete(e);this._sourceOptions=this._options,this._engine.dispatchEvent(xe.containerStopped,{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];const e=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this._responsiveMaxWidth!==e&&(this._responsiveMaxWidth=e,!0)}}class di{constructor(){this._listeners=new Map}addEventListener(e,t){this.removeEventListener(e,t);let i=this._listeners.get(e);i||(i=[],this._listeners.set(e,i)),i.push(t)}dispatchEvent(e,t){const i=this._listeners.get(e);i?.forEach(e=>e(t))}hasEventListener(e){return!!this._listeners.get(e)}removeAllEventListeners(e){e?this._listeners.delete(e):this._listeners=new Map}removeEventListener(e,t){const i=this._listeners.get(e);if(!i)return;const n=i.length,s=i.indexOf(t);s<0||(1===n?this._listeners.delete(e):i.splice(s,1))}}async function ui(e,t,i,n=!1){let s=t.get(e);return s&&!n||(s=await Promise.all([...i.values()].map(t=>t(e))),t.set(e,s)),s}class hi{constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new di,this._initialized=!1,this.plugins=[],this.colorManagers=new Map,this.easingFunctions=new Map,this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this.pathGenerators=new Map}get configs(){const e={};for(const[t,i]of this._configs)e[t]=i;return e}get items(){return this._domArray}get version(){return"3.8.1"}async addColorManager(e,t=!0){this.colorManagers.set(e.key,e),await this.refresh(t)}addConfig(e){const t=e.key??e.name??"default";this._configs.set(t,e),this._eventDispatcher.dispatchEvent(xe.configAdded,{data:{name:t,config:e}})}async addEasing(e,t,i=!0){this.getEasing(e)||(this.easingFunctions.set(e,t),await this.refresh(i))}async addEffect(e,t,i=!0){he(e,e=>{this.getEffectDrawer(e)||this.effectDrawers.set(e,t)}),await this.refresh(i)}addEventListener(e,t){this._eventDispatcher.addEventListener(e,t)}async addInteractor(e,t,i=!0){this._initializers.interactors.set(e,t),await this.refresh(i)}async addMover(e,t,i=!0){this._initializers.movers.set(e,t),await this.refresh(i)}async addParticleUpdater(e,t,i=!0){this._initializers.updaters.set(e,t),await this.refresh(i)}async addPathGenerator(e,t,i=!0){this.getPathGenerator(e)||this.pathGenerators.set(e,t),await this.refresh(i)}async addPlugin(e,t=!0){this.getPlugin(e.id)||this.plugins.push(e),await this.refresh(t)}async addPreset(e,t,i=!1,n=!0){!i&&this.getPreset(e)||this.presets.set(e,t),await this.refresh(n)}async addShape(e,t=!0){for(const t of e.validTypes)this.getShapeDrawer(t)||this.shapeDrawers.set(t,e);await this.refresh(t)}checkVersion(e){if(this.version!==e)throw new Error(`The tsParticles version is different from the loaded plugins version. Engine version: ${this.version}. Plugin version: ${e}`)}clearPlugins(e){this.updaters.delete(e),this.movers.delete(e),this.interactors.delete(e)}dispatchEvent(e,t){this._eventDispatcher.dispatchEvent(e,t)}dom(){return this.items}domItem(e){return this.item(e)}async getAvailablePlugins(e){const t=new Map;for(const i of this.plugins)i.needsPlugin(e.actualOptions)&&t.set(i.id,await i.getPlugin(e));return t}getEasing(e){return this.easingFunctions.get(e)??(e=>e)}getEffectDrawer(e){return this.effectDrawers.get(e)}async getInteractors(e,t=!1){return ui(e,this.interactors,this._initializers.interactors,t)}async getMovers(e,t=!1){return ui(e,this.movers,this._initializers.movers,t)}getPathGenerator(e){return this.pathGenerators.get(e)}getPlugin(e){return this.plugins.find(t=>t.id===e)}getPreset(e){return this.presets.get(e)}getShapeDrawer(e){return this.shapeDrawers.get(e)}getSupportedEffects(){return this.effectDrawers.keys()}getSupportedShapes(){return this.shapeDrawers.keys()}async getUpdaters(e,t=!1){return ui(e,this.updaters,this._initializers.updaters,t)}init(){this._initialized||(this._initialized=!0)}item(e){const{items:t}=this,i=t[e];if(i&&!i.destroyed)return i;t.splice(e,1)}async load(e){const t=e.id??e.element?.id??`tsparticles${Math.floor(1e4*A())}`,{index:i,url:n}=e,s=n?await async function(e){const t=pe(e.url,e.index);if(!t)return e.fallback;const i=await fetch(t);return i.ok?await i.json():(ie().error(`${f} ${i.status} while retrieving config file`),e.fallback)}({fallback:e.options,url:n,index:i}):e.options,r=pe(s,i),{items:o}=this,a=o.findIndex(e=>e.id.description===t),l=new ci(this,t,r);if(a>=0){const e=this.item(a),t=e?1:0;e&&!e.destroyed&&e.destroy(!1),o.splice(a,t,l)}else o.push(l);const c=((e,t)=>{let i=t??document.getElementById(e);return i||(i=document.createElement("div"),i.id=e,i.dataset[d]=b,document.body.append(i),i)})(t,e.element),u=(e=>{let t;if(e instanceof HTMLCanvasElement||e.tagName.toLowerCase()===x)t=e,t.dataset[d]||(t.dataset[d]=w);else{const i=e.getElementsByTagName(x);i.length?(t=i[0],t.dataset[d]=w):(t=document.createElement(x),t.dataset[d]=b,e.appendChild(t))}const i="100%";return t.style.width||(t.style.width=i),t.style.height||(t.style.height=i),t})(c);return l.canvas.loadCanvas(u),await l.start(),l}loadOptions(e,t){this.plugins.forEach(i=>i.loadOptions?.(e,t))}loadParticlesOptions(e,t,...i){const n=this.updaters.get(e);n&&n.forEach(e=>e.loadOptions?.(t,...i))}async refresh(e=!0){e&&await Promise.all(this.items.map(e=>e.refresh()))}removeEventListener(e,t){this._eventDispatcher.removeEventListener(e,t)}setOnClickHandler(e){const{items:t}=this;if(!t.length)throw new Error(`${f} can only set click handlers after calling tsParticles.load()`);t.forEach(t=>t.addClickHandler(e))}}var pi,fi,gi;!function(e){e.clockwise="clockwise",e.counterClockwise="counter-clockwise",e.random="random"}(pi||(pi={})),function(e){e.linear="linear",e.radial="radial",e.random="random"}(fi||(fi={})),function(e){e.easeInBack="ease-in-back",e.easeInCirc="ease-in-circ",e.easeInCubic="ease-in-cubic",e.easeInLinear="ease-in-linear",e.easeInQuad="ease-in-quad",e.easeInQuart="ease-in-quart",e.easeInQuint="ease-in-quint",e.easeInExpo="ease-in-expo",e.easeInSine="ease-in-sine",e.easeOutBack="ease-out-back",e.easeOutCirc="ease-out-circ",e.easeOutCubic="ease-out-cubic",e.easeOutLinear="ease-out-linear",e.easeOutQuad="ease-out-quad",e.easeOutQuart="ease-out-quart",e.easeOutQuint="ease-out-quint",e.easeOutExpo="ease-out-expo",e.easeOutSine="ease-out-sine",e.easeInOutBack="ease-in-out-back",e.easeInOutCirc="ease-in-out-circ",e.easeInOutCubic="ease-in-out-cubic",e.easeInOutLinear="ease-in-out-linear",e.easeInOutQuad="ease-in-out-quad",e.easeInOutQuart="ease-in-out-quart",e.easeInOutQuint="ease-in-out-quint",e.easeInOutExpo="ease-in-out-expo",e.easeInOutSine="ease-in-out-sine"}(gi||(gi={}));const vi=function(){const e=new hi;return e.init(),e}();ne()||(window.tsParticles=vi);class _i{constructor(){this.wait=!1}load(e){F(e)||(void 0!==e.count&&(this.count=e.count),void 0!==e.delay&&(this.delay=U(e.delay)),void 0!==e.duration&&(this.duration=U(e.duration)),void 0!==e.wait&&(this.wait=e.wait))}}class mi{constructor(){this.quantity=1,this.delay=.1}load(e){F(e)||(void 0!==e.quantity&&(this.quantity=U(e.quantity)),void 0!==e.delay&&(this.delay=U(e.delay)))}}class yi{constructor(){this.color=!1,this.opacity=!1}load(e){F(e)||(void 0!==e.color&&(this.color=e.color),void 0!==e.opacity&&(this.opacity=e.opacity))}}class bi{constructor(){this.options={},this.replace=new yi,this.type="square"}load(e){F(e)||(void 0!==e.options&&(this.options=ue({},e.options??{})),this.replace.load(e.replace),void 0!==e.type&&(this.type=e.type))}}class wi{constructor(){this.mode=Z.percent,this.height=0,this.width=0}load(e){F(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.height&&(this.height=e.height),void 0!==e.width&&(this.width=e.width))}}class xi{constructor(){this.autoPlay=!0,this.fill=!0,this.life=new _i,this.rate=new mi,this.shape=new bi,this.startCount=0}load(e){F(e)||(void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.size&&(this.size||(this.size=new wi),this.size.load(e.size)),void 0!==e.direction&&(this.direction=e.direction),this.domId=e.domId,void 0!==e.fill&&(this.fill=e.fill),this.life.load(e.life),this.name=e.name,this.particles=he(e.particles,e=>ue({},e)),this.rate.load(e.rate),this.shape.load(e.shape),void 0!==e.position&&(this.position={},void 0!==e.position.x&&(this.position.x=U(e.position.x)),void 0!==e.position.y&&(this.position.y=U(e.position.y))),void 0!==e.spawnColor&&(void 0===this.spawnColor&&(this.spawnColor=new gt),this.spawnColor.load(e.spawnColor)),void 0!==e.startCount&&(this.startCount=e.startCount))}}var ki;function Si(e,t){e.color?e.color.value=t:e.color={value:t}}!function(e){e.emitter="emitter"}(ki||(ki={}));class Pi{constructor(e,t,i,n,s){this.emitters=t,this.container=i,this._destroy=()=>{this._mutationObserver?.disconnect(),this._mutationObserver=void 0,this._resizeObserver?.disconnect(),this._resizeObserver=void 0,this.emitters.removeEmitter(this),this._engine.dispatchEvent("emitterDestroyed",{container:this.container,data:{emitter:this}})},this._prepareToDie=()=>{if(this._paused)return;const e=void 0!==this.options.life?.duration?q(this.options.life.duration):void 0;this.container.retina.reduceFactor&&(this._lifeCount>0||this._immortal)&&void 0!==e&&e>0&&(this._duration=e*_)},this._setColorAnimation=(e,t,i,n=1)=>{const s=this.container;if(!e.enable)return t;const r=B(e.offset),o=q(this.options.rate.delay)*_/s.retina.reduceFactor;return(t+q(e.speed??0)*s.fpsLimit/o+r*n)%i},this._engine=e,this._currentDuration=0,this._currentEmitDelay=0,this._currentSpawnDelay=0,this._initialPosition=s,n instanceof xi?this.options=n:(this.options=new xi,this.options.load(n)),this._spawnDelay=q(this.options.life.delay??0)*_/this.container.retina.reduceFactor,this.position=this._initialPosition??this._calcPosition(),this.name=this.options.name,this.fill=this.options.fill,this._firstSpawn=!this.options.life.wait,this._startParticlesAdded=!1;let r=ue({},this.options.particles);if(r??={},r.move??={},r.move.direction??=this.options.direction,this.options.spawnColor&&(this.spawnColor=De(this._engine,this.options.spawnColor)),this._paused=!this.options.autoPlay,this._particlesOptions=r,this._size=this._calcSize(),this.size=_e(this._size,this.container.canvas.size),this._lifeCount=this.options.life.count??-1,this._immortal=this._lifeCount<=0,this.options.domId){const e=document.getElementById(this.options.domId);e&&(this._mutationObserver=new MutationObserver(()=>{this.resize()}),this._resizeObserver=new ResizeObserver(()=>{this.resize()}),this._mutationObserver.observe(e,{attributes:!0,attributeFilter:["style","width","height"]}),this._resizeObserver.observe(e))}const o=this.options.shape,a=this._engine.emitterShapeManager?.getShapeGenerator(o.type);a&&(this._shape=a.generate(this.position,this.size,this.fill,o.options)),this._engine.dispatchEvent("emitterCreated",{container:i,data:{emitter:this}}),this.play()}externalPause(){this._paused=!0,this.pause()}externalPlay(){this._paused=!1,this.play()}async init(){await(this._shape?.init())}pause(){this._paused||delete this._emitDelay}play(){if(!this._paused&&this.container.retina.reduceFactor&&(this._lifeCount>0||this._immortal||!this.options.life.count)&&(this._firstSpawn||this._currentSpawnDelay>=(this._spawnDelay??0))){if(void 0===this._emitDelay){const e=q(this.options.rate.delay);this._emitDelay=e*_/this.container.retina.reduceFactor}(this._lifeCount>0||this._immortal)&&this._prepareToDie()}}resize(){const e=this._initialPosition;this.position=e&&ce(e,this.container.canvas.size,L.origin)?e:this._calcPosition(),this._size=this._calcSize(),this.size=_e(this._size,this.container.canvas.size),this._shape?.resize(this.position,this.size)}update(e){this._paused||(this._firstSpawn&&(this._firstSpawn=!1,this._currentSpawnDelay=this._spawnDelay??0,this._currentEmitDelay=this._emitDelay??0),this._startParticlesAdded||(this._startParticlesAdded=!0,this._emitParticles(this.options.startCount)),void 0!==this._duration&&(this._currentDuration+=e.value,this._currentDuration>=this._duration&&(this.pause(),void 0!==this._spawnDelay&&delete this._spawnDelay,this._immortal||this._lifeCount--,this._lifeCount>0||this._immortal?(this.position=this._calcPosition(),this._shape?.resize(this.position,this.size),this._spawnDelay=q(this.options.life.delay??0)*_/this.container.retina.reduceFactor):this._destroy(),this._currentDuration-=this._duration,delete this._duration)),void 0!==this._spawnDelay&&(this._currentSpawnDelay+=e.value,this._currentSpawnDelay>=this._spawnDelay&&(this._engine.dispatchEvent("emitterPlay",{container:this.container}),this.play(),this._currentSpawnDelay-=this._currentSpawnDelay,delete this._spawnDelay)),void 0!==this._emitDelay&&(this._currentEmitDelay+=e.value,this._currentEmitDelay>=this._emitDelay&&(this._emit(),this._currentEmitDelay-=this._emitDelay)))}_calcPosition(){if(this.options.domId){const e=document.getElementById(this.options.domId);if(e){const t=e.getBoundingClientRect(),i=this.container.retina.pixelRatio;return{x:(t.x+.5*t.width)*i,y:(t.y+.5*t.height)*i}}}return function(e){const t={x:void 0!==e.position?.x?q(e.position.x):void 0,y:void 0!==e.position?.y?q(e.position.y):void 0};return function(e){return{x:(e.position?.x??A()*g)*e.size.width/g,y:(e.position?.y??A()*g)*e.size.height/g}}({size:e.size,position:t})}({size:this.container.canvas.size,position:this.options.position})}_calcSize(){const e=this.container;if(this.options.domId){const t=document.getElementById(this.options.domId);if(t){const i=t.getBoundingClientRect();return{width:i.width*e.retina.pixelRatio,height:i.height*e.retina.pixelRatio,mode:Z.precise}}}return this.options.size??(()=>{const e=new wi;return e.load({height:0,mode:Z.percent,width:0}),e})()}_emit(){if(this._paused)return;const e=q(this.options.rate.quantity);this._emitParticles(e)}_emitParticles(e){const t=pe(this._particlesOptions);for(let i=0;i<e;i++){const e=ue({},t);if(this.spawnColor){const t=this.options.spawnColor?.animation;if(t){const e={h:360,s:100,l:100},i=3.6;this.spawnColor.h=this._setColorAnimation(t.h,this.spawnColor.h,e.h,i),this.spawnColor.s=this._setColorAnimation(t.s,this.spawnColor.s,e.s),this.spawnColor.l=this._setColorAnimation(t.l,this.spawnColor.l,e.l)}Si(e,this.spawnColor)}const i=this.options.shape;let n=this.position;if(this._shape){const t=this._shape.randomPosition();if(t){n=t.position;const s=i.replace;s.color&&t.color&&Si(e,t.color),s.opacity&&(e.opacity?e.opacity.value=t.opacity:e.opacity={value:t.opacity})}else n=null}n&&this.container.particles.addParticle(n,e)}}}class Ti{constructor(e,t){this.container=t,this._engine=e,this.array=[],this.emitters=[],this.interactivityEmitters={random:{count:1,enable:!1},value:[]},t.getEmitter=e=>void 0===e||I(e)?this.array[e??0]:this.array.find(t=>t.name===e),t.addEmitter=async(e,t)=>this.addEmitter(e,t),t.removeEmitter=e=>{const i=t.getEmitter(e);i&&this.removeEmitter(i)},t.playEmitter=e=>{const i=t.getEmitter(e);i&&i.externalPlay()},t.pauseEmitter=e=>{const i=t.getEmitter(e);i&&i.externalPause()}}async addEmitter(e,t){const i=new xi;i.load(e);const n=new Pi(this._engine,this,this.container,i,t);return await n.init(),this.array.push(n),n}handleClickMode(e){const t=this.emitters,i=this.interactivityEmitters;if(e!==ki.emitter)return;let n;if(i&&R(i.value)){const e=0;if(i.value.length>e&&i.random.enable){n=[];const e=[];for(let t=0;t<i.random.count;t++){const s=ae(i.value);e.includes(s)&&e.length<i.value.length?t--:(e.push(s),n.push(le(i.value,s)))}}else n=i.value}else n=i?.value;const s=n??t,r=this.container.interactivity.mouse.clickPosition;he(s,async e=>{await this.addEmitter(e,r)})}async init(){if(this.emitters=this.container.actualOptions.emitters,this.interactivityEmitters=this.container.actualOptions.interactivity.modes.emitters,this.emitters)if(R(this.emitters))for(const e of this.emitters)await this.addEmitter(e);else await this.addEmitter(this.emitters)}pause(){for(const e of this.array)e.pause()}play(){for(const e of this.array)e.play()}removeEmitter(e){const t=this.array.indexOf(e);t>=0&&this.array.splice(t,1)}resize(){for(const e of this.array)e.resize()}stop(){this.array=[]}update(e){for(const t of this.array)t.update(e)}}class Ei{constructor(e){this._engine=e,this.id="emitters"}getPlugin(e){return Promise.resolve(new Ti(this._engine,e))}loadOptions(e,t){if(!this.needsPlugin(e)&&!this.needsPlugin(t))return;t?.emitters&&(e.emitters=he(t.emitters,e=>{const t=new xi;return t.load(e),t}));const i=t?.interactivity?.modes?.emitters;if(i)if(R(i))e.interactivity.modes.emitters={random:{count:1,enable:!0},value:i.map(e=>{const t=new xi;return t.load(e),t})};else{const t=i;if(void 0!==t.value){const i=1;if(R(t.value))e.interactivity.modes.emitters={random:{count:t.random.count??i,enable:t.random.enable??!1},value:t.value.map(e=>{const t=new xi;return t.load(e),t})};else{const n=new xi;n.load(t.value),e.interactivity.modes.emitters={random:{count:t.random.count??i,enable:t.random.enable??!1},value:n}}}else(e.interactivity.modes.emitters={random:{count:1,enable:!1},value:new xi}).value.load(i)}}needsPlugin(e){if(!e)return!1;const t=e.emitters;return R(t)&&!!t.length||void 0!==t||!!e.interactivity?.events?.onClick?.mode&&re(ki.emitter,e.interactivity.events.onClick.mode)}}const Ci=new Map;class Ii{constructor(e){this._engine=e}addShapeGenerator(e,t){this.getShapeGenerator(e)||Ci.set(e,t)}getShapeGenerator(e){return Ci.get(e)}getSupportedShapeGenerators(){return Ci.keys()}}class Mi{constructor(){this.angle=90,this.count=50,this.spread=45,this.startVelocity=45,this.decay=.9,this.gravity=1,this.drift=0,this.ticks=200,this.position={x:50,y:50},this.colors=["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],this.shapes=["square","circle"],this.scalar=1,this.zIndex=100,this.disableForReducedMotion=!0,this.flat=!1,this.shapeOptions={}}get origin(){return{x:this.position.x/g,y:this.position.y/g}}set origin(e){this.position.x=e.x*g,this.position.y=e.y*g}get particleCount(){return this.count}set particleCount(e){this.count=e}load(e){if(F(e))return;void 0!==e.angle&&(this.angle=e.angle);const t=e.count??e.particleCount;void 0!==t&&(this.count=t),void 0!==e.spread&&(this.spread=e.spread),void 0!==e.startVelocity&&(this.startVelocity=e.startVelocity),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.flat&&(this.flat=e.flat),void 0!==e.gravity&&(this.gravity=e.gravity),void 0!==e.drift&&(this.drift=e.drift),void 0!==e.ticks&&(this.ticks=e.ticks);const i=e.origin;i&&!e.position&&(e.position={x:void 0!==i.x?i.x*g:void 0,y:void 0!==i.y?i.y*g:void 0});const n=e.position;n&&(void 0!==n.x&&(this.position.x=n.x),void 0!==n.y&&(this.position.y=n.y)),void 0!==e.colors&&(R(e.colors)?this.colors=[...e.colors]:this.colors=e.colors);const s=e.shapeOptions;if(void 0!==s)for(const e in s){const t=s[e];t&&(this.shapeOptions[e]=ue(this.shapeOptions[e]??{},t))}void 0!==e.shapes&&(R(e.shapes)?this.shapes=[...e.shapes]:this.shapes=e.shapes),void 0!==e.scalar&&(this.scalar=e.scalar),void 0!==e.zIndex&&(this.zIndex=e.zIndex),void 0!==e.disableForReducedMotion&&(this.disableForReducedMotion=e.disableForReducedMotion)}}const Ri=2*Math.PI;class Fi{init(e){const t=e.options.move.gravity;e.gravity={enable:t.enable,acceleration:q(t.acceleration),inverse:t.inverse},function(e){const t=e.container,i=e.options.move.spin;if(!i.enable)return;const n=i.position??{x:50,y:50},s={x:.01*n.x*t.canvas.size.width,y:.01*n.y*t.canvas.size.height},r=V(e.getPosition(),s),o=q(i.acceleration);e.retina.spinAcceleration=o*t.retina.pixelRatio,e.spin={center:s,direction:e.velocity.x>=0?pi.clockwise:pi.counterClockwise,angle:A()*Ri,radius:r,acceleration:e.retina.spinAcceleration}}(e)}isEnabled(e){return!e.destroyed&&e.options.move.enable}move(e,t){const i=e.options,n=i.move;if(!n.enable)return;const s=e.container,r=s.retina.pixelRatio;e.retina.moveSpeed??=q(n.speed)*r,e.retina.moveDrift??=q(e.options.move.drift)*r;const o=function(e){return e.slow.inRange?e.slow.factor:1}(e),a=e.retina.moveSpeed*s.retina.reduceFactor,l=e.retina.moveDrift,c=N(i.size.value)*r,d=a*(n.size?e.getRadius()/c:1)*o*(t.factor||1)/2,u=e.retina.maxSpeed??s.retina.maxSpeed;n.spin.enable?function(e,t){const i=e.container;if(!e.spin)return;const n=e.spin.direction===pi.clockwise,s={x:n?Math.cos:Math.sin,y:n?Math.sin:Math.cos};e.position.x=e.spin.center.x+e.spin.radius*s.x(e.spin.angle),e.position.y=e.spin.center.y+e.spin.radius*s.y(e.spin.angle),e.spin.radius+=e.spin.acceleration;const r=Math.max(i.canvas.size.width,i.canvas.size.height),o=.5*r;e.spin.radius>o?(e.spin.radius=o,e.spin.acceleration*=-1):e.spin.radius<0&&(e.spin.radius=0,e.spin.acceleration*=-1),e.spin.angle+=.01*t*(1-e.spin.radius/r)}(e,d):function(e,t,i,n,s,r){!function(e,t){const i=e.options.move.path;if(!i.enable)return;if(e.lastPathTime<=e.pathDelay)return void(e.lastPathTime+=t.value);const n=e.pathGenerator?.generate(e,t);n&&e.velocity.addTo(n),i.clamp&&(e.velocity.x=$(e.velocity.x,-1,1),e.velocity.y=$(e.velocity.y,-1,1)),e.lastPathTime-=e.pathDelay}(e,r);const o=e.gravity,a=o?.enable&&o.inverse?-1:1;s&&i&&(e.velocity.x+=s*r.factor/(60*i)),o?.enable&&i&&(e.velocity.y+=a*(o.acceleration*r.factor)/(60*i));const l=e.moveDecay;e.velocity.multTo(l);const c=e.velocity.mult(i);o?.enable&&n>0&&(!o.inverse&&c.y>=0&&c.y>=n||o.inverse&&c.y<=0&&c.y<=-n)&&(c.y=a*n,i&&(e.velocity.y=c.y/i));const d=e.options.zIndex,u=(1-e.zIndexFactor)**d.velocityRate;c.multTo(u);const{position:h}=e;h.addTo(c),t.vibrate&&(h.x+=Math.sin(h.x*Math.cos(h.y)),h.y+=Math.cos(h.y*Math.sin(h.x)))}(e,n,d,u,l,t),function(e){const t=e.initialPosition,{dx:i,dy:n}=H(t,e.position),s=Math.abs(i),r=Math.abs(n),{maxDistance:o}=e.retina,a=o.horizontal,l=o.vertical;if(a||l)if((a&&s>=a||l&&r>=l)&&!e.misplaced)e.misplaced=!!a&&s>a||!!l&&r>l,a&&(e.velocity.x=.5*e.velocity.y-e.velocity.x),l&&(e.velocity.y=.5*e.velocity.x-e.velocity.y);else if((!a||s<a)&&(!l||r<l)&&e.misplaced)e.misplaced=!1;else if(e.misplaced){const i=e.position,n=e.velocity;a&&(i.x<t.x&&n.x<0||i.x>t.x&&n.x>0)&&(n.x*=-A()),l&&(i.y<t.y&&n.y<0||i.y>t.y&&n.y>0)&&(n.y*=-A())}}(e)}}const Oi=2*Math.PI;class Li{constructor(){this.validTypes=["circle"]}draw(e){!function(e){const{context:t,particle:i,radius:n}=e;i.circleRange||(i.circleRange={min:0,max:Oi});const s=i.circleRange;t.arc(0,0,n,s.min,s.max,!1)}(e)}getSidesCount(){return 12}particleInit(e,t){const i=t.shapeData,n=i?.angle??{max:360,min:0};t.circleRange=M(n)?{min:W(n.min),max:W(n.max)}:{min:0,max:W(n)}}}class Di{constructor(e,t){this._container=e,this._engine=t}init(e){const t=De(this._engine,e.options.color,e.id,e.options.reduceDuplicates);t&&(e.color=function(e,t,i){const n={h:{enable:!1,value:e.h},s:{enable:!1,value:e.s},l:{enable:!1,value:e.l}};return t&&(Be(n.h,t.h,i),Be(n.s,t.s,i),Be(n.l,t.l,i)),n}(t,e.options.color.animation,this._container.retina.reduceFactor))}isEnabled(e){const{h:t,s:i,l:n}=e.options.color.animation,{color:s}=e;return!e.destroyed&&!e.spawning&&(void 0!==s?.h.value&&t.enable||void 0!==s?.s.value&&i.enable||void 0!==s?.l.value&&n.enable)}update(e,t){!function(e,t){if(!e)return;const{h:i,s:n,l:s}=e;i&&qe(i,{min:0,max:360},!1,t),n&&qe(n,{min:0,max:100},!0,t),s&&qe(s,{min:0,max:100},!0,t)}(e.color,t)}}var zi;!function(e){e[e.r=1]="r",e[e.g=2]="g",e[e.b=3]="b",e[e.a=4]="a"}(zi||(zi={}));const Gi=/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,Ai=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i;class $i{constructor(){this.key="hex",this.stringPrefix="#"}handleColor(e){return this._parseString(e.value)}handleRangeColor(e){return this._parseString(e.value)}parseString(e){return this._parseString(e)}_parseString(e){if("string"!=typeof e)return;if(!e?.startsWith(this.stringPrefix))return;const t=e.replace(Gi,(e,t,i,n,s)=>t+t+i+i+n+n+(void 0!==s?s+s:"")),i=Ai.exec(t);return i?{a:void 0!==i[zi.a]?parseInt(i[zi.a],16)/255:1,b:parseInt(i[zi.b],16),g:parseInt(i[zi.g],16),r:parseInt(i[zi.r],16)}:void 0}}var Bi,qi;!function(e){e[e.h=1]="h",e[e.s=2]="s",e[e.l=3]="l",e[e.a=5]="a"}(Bi||(Bi={}));class ji{constructor(){this.key="hsl",this.stringPrefix="hsl"}handleColor(e){const t=e.value.hsl??e.value;if(void 0!==t.h&&void 0!==t.s&&void 0!==t.l)return ze(t)}handleRangeColor(e){const t=e.value.hsl??e.value;if(void 0!==t.h&&void 0!==t.l)return ze({h:q(t.h),l:q(t.l),s:q(t.s)})}parseString(e){if(!e.startsWith("hsl"))return;const t=/hsla?\(\s*(\d+)\s*[\s,]\s*(\d+)%\s*[\s,]\s*(\d+)%\s*([\s,]\s*(0|1|0?\.\d+|(\d{1,3})%)\s*)?\)/i.exec(e);return t?function(e){const t=ze(e);return{a:e.a,b:t.b,g:t.g,r:t.r}}({a:t.length>4?Y(t[Bi.a]):1,h:parseInt(t[Bi.h],10),l:parseInt(t[Bi.l],10),s:parseInt(t[Bi.s],10)}):void 0}}class Ni{constructor(e){this.container=e}init(e){const t=e.options.opacity;e.opacity=fe(t,1);const i=t.animation;i.enable&&(e.opacity.velocity=q(i.speed)/g*this.container.retina.reduceFactor,i.sync||(e.opacity.velocity*=A()))}isEnabled(e){return!e.destroyed&&!e.spawning&&!!e.opacity&&e.opacity.enable&&((e.opacity.maxLoops??0)<=0||(e.opacity.maxLoops??0)>0&&(e.opacity.loops??0)<(e.opacity.maxLoops??0))}reset(e){e.opacity&&(e.opacity.time=0,e.opacity.loops=0)}update(e,t){this.isEnabled(e)&&e.opacity&&me(e,e.opacity,!0,e.options.opacity.animation.destroy,t)}}class Ui{constructor(e){this.container=e,this.modes=[Ee.bounce,Ee.split]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;let r=!1;for(const n of s.plugins.values())if(void 0!==n.particleBounce&&(r=n.particleBounce(e,i,t)),r)break;if(r)return;const o=e.getPosition(),a=e.offset,l=e.getRadius(),c=de(o,l),d=s.canvas.size;!function(e){if(e.outMode!==Ee.bounce&&e.outMode!==Ee.split||e.direction!==K.left&&e.direction!==K.right)return;e.bounds.right<0&&e.direction===K.left?e.particle.position.x=e.size+e.offset.x:e.bounds.left>e.canvasSize.width&&e.direction===K.right&&(e.particle.position.x=e.canvasSize.width-e.size-e.offset.x);const t=e.particle.velocity.x;let i=!1;if(e.direction===K.right&&e.bounds.right>=e.canvasSize.width&&t>0||e.direction===K.left&&e.bounds.left<=0&&t<0){const t=q(e.particle.options.bounce.horizontal.value);e.particle.velocity.x*=-t,i=!0}if(!i)return;const n=e.offset.x+e.size;e.bounds.right>=e.canvasSize.width&&e.direction===K.right?e.particle.position.x=e.canvasSize.width-n:e.bounds.left<=0&&e.direction===K.left&&(e.particle.position.x=n),e.outMode===Ee.split&&e.particle.destroy()}({particle:e,outMode:n,direction:t,bounds:c,canvasSize:d,offset:a,size:l}),function(e){if(e.outMode!==Ee.bounce&&e.outMode!==Ee.split||e.direction!==K.bottom&&e.direction!==K.top)return;e.bounds.bottom<0&&e.direction===K.top?e.particle.position.y=e.size+e.offset.y:e.bounds.top>e.canvasSize.height&&e.direction===K.bottom&&(e.particle.position.y=e.canvasSize.height-e.size-e.offset.y);const t=e.particle.velocity.y;let i=!1;if(e.direction===K.bottom&&e.bounds.bottom>=e.canvasSize.height&&t>0||e.direction===K.top&&e.bounds.top<=0&&t<0){const t=q(e.particle.options.bounce.vertical.value);e.particle.velocity.y*=-t,i=!0}if(!i)return;const n=e.offset.y+e.size;e.bounds.bottom>=e.canvasSize.height&&e.direction===K.bottom?e.particle.position.y=e.canvasSize.height-n:e.bounds.top<=0&&e.direction===K.top&&(e.particle.position.y=n),e.outMode===Ee.split&&e.particle.destroy()}({particle:e,outMode:n,direction:t,bounds:c,canvasSize:d,offset:a,size:l})}}class Hi{constructor(e){this.container=e,this.modes=[Ee.destroy]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;switch(e.outType){case Me.normal:case Me.outside:if(ce(e.position,s.canvas.size,L.origin,e.getRadius(),t))return;break;case Me.inside:{const{dx:t,dy:i}=H(e.position,e.moveCenter),{x:n,y:s}=e.velocity;if(n<0&&t>e.moveCenter.radius||s<0&&i>e.moveCenter.radius||n>=0&&t<-e.moveCenter.radius||s>=0&&i<-e.moveCenter.radius)return;break}}s.particles.remove(e,e.group,!0)}}class Vi{constructor(e){this.container=e,this.modes=[Ee.none]}update(e,t,i,n){if(!this.modes.includes(n))return;if((e.options.move.distance.horizontal&&(t===K.left||t===K.right))??(e.options.move.distance.vertical&&(t===K.top||t===K.bottom)))return;const s=e.options.move.gravity,r=this.container,o=r.canvas.size,a=e.getRadius();if(s.enable){const i=e.position;(!s.inverse&&i.y>o.height+a&&t===K.bottom||s.inverse&&i.y<-a&&t===K.top)&&r.particles.remove(e)}else{if(e.velocity.y>0&&e.position.y<=o.height+a||e.velocity.y<0&&e.position.y>=-a||e.velocity.x>0&&e.position.x<=o.width+a||e.velocity.x<0&&e.position.x>=-a)return;ce(e.position,r.canvas.size,L.origin,a,t)||r.particles.remove(e)}}}class Wi{constructor(e){this.container=e,this.modes=[Ee.out]}update(e,t,i,n){if(!this.modes.includes(n))return;const s=this.container;switch(e.outType){case Me.inside:{const{x:t,y:i}=e.velocity,n=L.origin;n.length=e.moveCenter.radius,n.angle=e.velocity.angle+Math.PI,n.addTo(L.create(e.moveCenter));const{dx:r,dy:o}=H(e.position,n);if(t<=0&&r>=0||i<=0&&o>=0||t>=0&&r<=0||i>=0&&o<=0)return;e.position.x=Math.floor(B({min:0,max:s.canvas.size.width})),e.position.y=Math.floor(B({min:0,max:s.canvas.size.height}));const{dx:a,dy:l}=H(e.position,e.moveCenter);e.direction=Math.atan2(-l,-a),e.velocity.angle=e.direction;break}default:if(ce(e.position,s.canvas.size,L.origin,e.getRadius(),t))return;switch(e.outType){case Me.outside:{e.position.x=Math.floor(B({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.x,e.position.y=Math.floor(B({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.y;const{dx:t,dy:i}=H(e.position,e.moveCenter);e.moveCenter.radius&&(e.direction=Math.atan2(i,t),e.velocity.angle=e.direction);break}case Me.normal:{const i=e.options.move.warp,n=s.canvas.size,r={bottom:n.height+e.getRadius()+e.offset.y,left:-e.getRadius()-e.offset.x,right:n.width+e.getRadius()+e.offset.x,top:-e.getRadius()-e.offset.y},o=e.getRadius(),a=de(e.position,o);t===K.right&&a.left>n.width+e.offset.x?(e.position.x=r.left,e.initialPosition.x=e.position.x,i||(e.position.y=A()*n.height,e.initialPosition.y=e.position.y)):t===K.left&&a.right<-e.offset.x&&(e.position.x=r.right,e.initialPosition.x=e.position.x,i||(e.position.y=A()*n.height,e.initialPosition.y=e.position.y)),t===K.bottom&&a.top>n.height+e.offset.y?(i||(e.position.x=A()*n.width,e.initialPosition.x=e.position.x),e.position.y=r.top,e.initialPosition.y=e.position.y):t===K.top&&a.bottom<-e.offset.y&&(i||(e.position.x=A()*n.width,e.initialPosition.x=e.position.x),e.position.y=r.bottom,e.initialPosition.y=e.position.y);break}}}}}class Yi{constructor(e){this._addUpdaterIfMissing=(e,t,i)=>{const n=e.options.move.outModes;!this.updaters.has(t)&&((e,t)=>e.default===t||e.bottom===t||e.left===t||e.right===t||e.top===t)(n,t)&&this.updaters.set(t,i(this.container))},this._updateOutMode=(e,t,i,n)=>{for(const s of this.updaters.values())s.update(e,n,t,i)},this.container=e,this.updaters=new Map}init(e){this._addUpdaterIfMissing(e,Ee.bounce,e=>new Ui(e)),this._addUpdaterIfMissing(e,Ee.out,e=>new Wi(e)),this._addUpdaterIfMissing(e,Ee.destroy,e=>new Hi(e)),this._addUpdaterIfMissing(e,Ee.none,e=>new Vi(e))}isEnabled(e){return!e.destroyed&&!e.spawning}update(e,t){const i=e.options.move.outModes;this._updateOutMode(e,t,i.bottom??i.default,K.bottom),this._updateOutMode(e,t,i.left??i.default,K.left),this._updateOutMode(e,t,i.right??i.default,K.right),this._updateOutMode(e,t,i.top??i.default,K.top)}}!function(e){e[e.r=1]="r",e[e.g=2]="g",e[e.b=3]="b",e[e.a=5]="a"}(qi||(qi={}));class Xi{constructor(){this.key="rgb",this.stringPrefix="rgb"}handleColor(e){const t=e.value.rgb??e.value;if(void 0!==t.r)return t}handleRangeColor(e){const t=e.value.rgb??e.value;if(void 0!==t.r)return{r:q(t.r),g:q(t.g),b:q(t.b)}}parseString(e){if(!e.startsWith(this.stringPrefix))return;const t=/rgba?\(\s*(\d{1,3})\s*[\s,]\s*(\d{1,3})\s*[\s,]\s*(\d{1,3})\s*([\s,]\s*(0|1|0?\.\d+|(\d{1,3})%)\s*)?\)/i.exec(e);return t?{a:t.length>4?Y(t[qi.a]):1,b:parseInt(t[qi.b],10),g:parseInt(t[qi.g],10),r:parseInt(t[qi.r],10)}:void 0}}class Qi{init(e){const t=e.container,i=e.options.size.animation;i.enable&&(e.size.velocity=(e.retina.sizeAnimationSpeed??t.retina.sizeAnimationSpeed)/g*t.retina.reduceFactor,i.sync||(e.size.velocity*=A()))}isEnabled(e){return!e.destroyed&&!e.spawning&&e.size.enable&&((e.size.maxLoops??0)<=0||(e.size.maxLoops??0)>0&&(e.size.loops??0)<(e.size.maxLoops??0))}reset(e){e.size.loops=0}update(e,t){this.isEnabled(e)&&me(e,e.size,!0,e.options.size.animation.destroy,t)}}function Ji(e,t){if(!t.segments.length||!t.segments[0].values.length)return;const{context:i,radius:n}=e;i.moveTo(t.segments[0].values[0].x*n,t.segments[0].values[0].y*n);for(const e of t.segments)i.bezierCurveTo(e.values[1].x*n,e.values[1].y*n,e.values[2].x*n,e.values[2].y*n,e.values[3].x*n,e.values[3].y*n);for(let e=t.segments.length-1;e>=0;e--){const s=t.segments[e];i.bezierCurveTo(-s.values[2].x*n,s.values[2].y*n,-s.values[1].x*n,s.values[1].y*n,-s.values[0].x*n,s.values[0].y*n)}}const Ki=.5,Zi={heart:{segments:[{values:[{x:0,y:Ki},{x:0,y:Ki},{x:Ki,y:0},{x:Ki,y:-Ki/2}]},{values:[{x:Ki,y:-Ki/2},{x:Ki,y:-Ki/2},{x:Ki,y:-Ki},{x:Ki/2,y:-Ki}]},{values:[{x:Ki/2,y:-Ki},{x:Ki/2,y:-Ki},{x:0,y:-Ki},{x:0,y:-Ki/2}]}]},diamond:{segments:[{values:[{x:0,y:Ki},{x:0,y:Ki},{x:.375,y:0},{x:.375,y:0}]},{values:[{x:.375,y:0},{x:.375,y:0},{x:0,y:-Ki},{x:0,y:-Ki}]}]},club:{segments:[{values:[{x:0,y:-Ki},{x:0,y:-Ki},{x:Ki/2,y:-Ki},{x:Ki/2,y:-Ki/2}]},{values:[{x:Ki/2,y:-Ki/2},{x:Ki/2,y:-Ki/2},{x:Ki,y:-Ki/2},{x:Ki,y:0}]},{values:[{x:Ki,y:0},{x:Ki,y:0},{x:Ki,y:Ki/2},{x:Ki/2,y:Ki/2}]},{values:[{x:Ki/2,y:Ki/2},{x:Ki/2,y:Ki/2},{x:Ki/8,y:Ki/2},{x:Ki/8,y:Ki/8}]},{values:[{x:Ki/8,y:Ki/8},{x:Ki/8,y:Ki/2},{x:Ki/2,y:Ki},{x:Ki/2,y:Ki}]},{values:[{x:Ki/2,y:Ki},{x:Ki/2,y:Ki},{x:0,y:Ki},{x:0,y:Ki}]}]},spade:{segments:[{values:[{x:0,y:-Ki},{x:0,y:-Ki},{x:Ki,y:-Ki/2},{x:Ki,y:0}]},{values:[{x:Ki,y:0},{x:Ki,y:0},{x:Ki,y:Ki/2},{x:Ki/2,y:Ki/2}]},{values:[{x:Ki/2,y:Ki/2},{x:Ki/2,y:Ki/2},{x:Ki/8,y:Ki/2},{x:Ki/8,y:Ki/8}]},{values:[{x:Ki/8,y:Ki/8},{x:Ki/8,y:Ki/2},{x:Ki/2,y:Ki},{x:Ki/2,y:Ki}]},{values:[{x:Ki/2,y:Ki},{x:Ki/2,y:Ki},{x:0,y:Ki},{x:0,y:Ki}]}]}};class en{constructor(){this.validTypes=["club","clubs"]}draw(e){Ji(e,Zi.club)}}class tn{constructor(){this.validTypes=["diamond","diamonds"]}draw(e){Ji(e,Zi.diamond)}}class nn{constructor(){this.validTypes=["heart","hearts"]}draw(e){Ji(e,Zi.heart)}}class sn{constructor(){this.validTypes=["spade","spades"]}draw(e){Ji(e,Zi.spade)}}const rn='"Twemoji Mozilla", Apple Color Emoji, "Segoe UI Emoji", "Noto Color Emoji", "EmojiOne Color"';class on{constructor(){this.validTypes=["emoji"],this._emojiShapeDict=new Map}destroy(){for(const[e,t]of this._emojiShapeDict)t instanceof ImageBitmap&&t?.close(),this._emojiShapeDict.delete(e)}draw(e){const t=e.particle.emojiDataKey;if(!t)return;const i=this._emojiShapeDict.get(t);i&&function(e,t){const{context:i,opacity:n}=e,s=i.globalAlpha;if(!t)return;const r=t.width,o=.5*r;i.globalAlpha=n,i.drawImage(t,-o,-o,r,r),i.globalAlpha=s}(e,i)}async init(e){const t=e.actualOptions,{validTypes:i}=this;if(!i.find(e=>re(e,t.particles.shape.type)))return;const n=[oe(rn)],s=i.map(e=>t.particles.shape.options[e]).find(e=>!!e);s&&he(s,e=>{e.font&&n.push(oe(e.font))}),await Promise.all(n)}particleDestroy(e){e.emojiDataKey=void 0}particleInit(e,t){const i=t.shapeData;if(!i?.value)return;const n=pe(i.value,t.randomIndexData);if(!n)return;const s="string"==typeof n?{font:i.font??rn,padding:i.padding??0,value:n}:{font:rn,padding:0,...i,...n},r=s.font,o=s.value,a=`${o}_${r}`;if(this._emojiShapeDict.has(a))return void(t.emojiDataKey=a);const l=2*s.padding,c=N(t.size.value),d=c+l,u=2*d;let h;if("undefined"!=typeof OffscreenCanvas){const e=new OffscreenCanvas(u,u),t=e.getContext("2d");if(!t)return;t.font=`400 ${2*c}px ${r}`,t.textBaseline="middle",t.textAlign="center",t.fillText(o,d,d),h=e.transferToImageBitmap()}else{const e=document.createElement("canvas");e.width=u,e.height=u;const t=e.getContext("2d");if(!t)return;t.font=`400 ${2*c}px ${r}`,t.textBaseline="middle",t.textAlign="center",t.fillText(o,d,d),h=e}this._emojiShapeDict.set(a,h),t.emojiDataKey=a}}class an{constructor(){this.validTypes=["heart"]}draw(e){!function(e){const{context:t,radius:i}=e,n=2*i,s=.5*i,r=i+s,o=-i,a=-i;t.moveTo(o,a+s),t.quadraticCurveTo(o,a,o+s,a),t.quadraticCurveTo(o+i,a,o+i,a+s),t.quadraticCurveTo(o+i,a,o+r,a),t.quadraticCurveTo(o+n,a,o+n,a+s),t.quadraticCurveTo(o+n,a+i,o+r,a+r),t.lineTo(o+i,a+n),t.lineTo(o+s,a+r),t.quadraticCurveTo(o,a+i,o,a+s)}(e)}}const ln=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?\))|currentcolor/gi;async function cn(e){return new Promise(t=>{e.loading=!0;const i=new Image;e.element=i,i.addEventListener("load",()=>{e.loading=!1,t()}),i.addEventListener("error",()=>{e.element=void 0,e.error=!0,e.loading=!1,ie().error(`${f} loading image: ${e.source}`),t()}),i.src=e.source})}async function dn(e){if("svg"!==e.type)return void await cn(e);e.loading=!0;const t=await fetch(e.source);t.ok?e.svgData=await t.text():(ie().error(`${f} Image not found`),e.error=!0),e.loading=!1}const un=[0,4,2,1],hn=[8,8,4,2];class pn{constructor(e){this.pos=0,this.data=new Uint8ClampedArray(e)}getString(e){const t=this.data.slice(this.pos,this.pos+e);return this.pos+=t.length,t.reduce((e,t)=>e+String.fromCharCode(t),"")}nextByte(){return this.data[this.pos++]}nextTwoBytes(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}readSubBlocks(){let e="",t=0;do{t=this.data[this.pos++];for(let i=t;--i>=0;e+=String.fromCharCode(this.data[this.pos++]));}while(0!==t);return e}readSubBlocksBin(){let e=this.data[this.pos],t=0;for(let i=0;0!==e;i+=e+1,e=this.data[this.pos+i])t+=e;const i=new Uint8Array(t);e=this.data[this.pos++];for(let t=0;0!==e;e=this.data[this.pos++])for(let n=e;--n>=0;i[t++]=this.data[this.pos++]);return i}skipSubBlocks(){for(const e=1,t=0;this.data[this.pos]!==t;this.pos+=this.data[this.pos]+e);this.pos++}}var fn,gn;!function(e){e[e.Replace=0]="Replace",e[e.Combine=1]="Combine",e[e.RestoreBackground=2]="RestoreBackground",e[e.RestorePrevious=3]="RestorePrevious",e[e.UndefinedA=4]="UndefinedA",e[e.UndefinedB=5]="UndefinedB",e[e.UndefinedC=6]="UndefinedC",e[e.UndefinedD=7]="UndefinedD"}(fn||(fn={})),function(e){e[e.Extension=33]="Extension",e[e.ApplicationExtension=255]="ApplicationExtension",e[e.GraphicsControlExtension=249]="GraphicsControlExtension",e[e.PlainTextExtension=1]="PlainTextExtension",e[e.CommentExtension=254]="CommentExtension",e[e.Image=44]="Image",e[e.EndOfFile=59]="EndOfFile"}(gn||(gn={}));function vn(e,t){const i=[];for(let n=0;n<t;n++)i.push({r:e.data[e.pos],g:e.data[e.pos+1],b:e.data[e.pos+2]}),e.pos+=3;return i}async function _n(e,t,i,n,s,r){switch(e.nextByte()){case gn.EndOfFile:return!0;case gn.Image:await async function(e,t,i,n,s,r){const o=t.frames[n(!0)];o.left=e.nextTwoBytes(),o.top=e.nextTwoBytes(),o.width=e.nextTwoBytes(),o.height=e.nextTwoBytes();const a=e.nextByte(),l=!(128&~a),c=!(64&~a);o.sortFlag=!(32&~a),o.reserved=(24&a)>>>3;const d=1<<1+(7&a);l&&(o.localColorTable=vn(e,d));const u=e=>{const{r:n,g:r,b:a}=(l?o.localColorTable:t.globalColorTable)[e];return e!==s(null)?{r:n,g:r,b:a,a:255}:{r:n,g:r,b:a,a:i?~~((n+r+a)/3):0}},h=(()=>{try{return new ImageData(o.width,o.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==h)throw new EvalError("GIF frame size is to large");const p=e.nextByte(),f=e.readSubBlocksBin(),g=1<<p,v=(e,t)=>{const i=e>>>3,n=7&e;return(f[i]+(f[i+1]<<8)+(f[i+2]<<16)&(1<<t)-1<<n)>>>n};if(c){for(let i=0,s=p+1,a=0,l=[[0]],c=0;c<4;c++){if(un[c]<o.height){let e=0,t=0,n=!1;for(;!n;){const r=i;if(i=v(a,s),a+=s+1,i===g){s=p+1,l.length=g+2;for(let e=0;e<l.length;e++)l[e]=e<g?[e]:[]}else{i>=l.length?l.push(l[r].concat(l[r][0])):r!==g&&l.push(l[r].concat(l[i][0]));for(const n of l[i]){const{r:i,g:s,b:r,a}=u(n);h.data.set([i,s,r,a],un[c]*o.width+hn[c]*t+e%(4*o.width)),e+=4}l.length===1<<s&&s<12&&s++}e===4*o.width*(t+1)&&(t++,un[c]+hn[c]*t>=o.height&&(n=!0))}}r?.(e.pos/(e.data.length-1),n(!1)+1,h,{x:o.left,y:o.top},{width:t.width,height:t.height})}o.image=h,o.bitmap=await createImageBitmap(h)}else{let i=0,s=p+1,a=0,l=-4,c=!1;const d=[[0]];for(;!c;){const e=i;if(i=v(a,s),a+=s,i===g){s=p+1,d.length=g+2;for(let e=0;e<d.length;e++)d[e]=e<g?[e]:[]}else{if(i===g+1){c=!0;break}i>=d.length?d.push(d[e].concat(d[e][0])):e!==g&&d.push(d[e].concat(d[i][0]));for(const e of d[i]){const{r:t,g:i,b:n,a:s}=u(e);h.data.set([t,i,n,s],l+=4)}d.length>=1<<s&&s<12&&s++}}o.image=h,o.bitmap=await createImageBitmap(h),r?.((e.pos+1)/e.data.length,n(!1)+1,o.image,{x:o.left,y:o.top},{width:t.width,height:t.height})}}(e,t,i,n,s,r);break;case gn.Extension:!function(e,t,i,n){switch(e.nextByte()){case gn.GraphicsControlExtension:{const s=t.frames[i(!1)];e.pos++;const r=e.nextByte();s.GCreserved=(224&r)>>>5,s.disposalMethod=(28&r)>>>2,s.userInputDelayFlag=!(2&~r);const o=!(1&~r);s.delayTime=10*e.nextTwoBytes();const a=e.nextByte();o&&n(a),e.pos++;break}case gn.ApplicationExtension:{e.pos++;const i={identifier:e.getString(8),authenticationCode:e.getString(3),data:e.readSubBlocksBin()};t.applicationExtensions.push(i);break}case gn.CommentExtension:t.comments.push([i(!1),e.readSubBlocks()]);break;case gn.PlainTextExtension:if(0===t.globalColorTable.length)throw new EvalError("plain text extension without global color table");e.pos++,t.frames[i(!1)].plainTextData={left:e.nextTwoBytes(),top:e.nextTwoBytes(),width:e.nextTwoBytes(),height:e.nextTwoBytes(),charSize:{width:e.nextTwoBytes(),height:e.nextTwoBytes()},foregroundColor:e.nextByte(),backgroundColor:e.nextByte(),text:e.readSubBlocks()};break;default:e.skipSubBlocks()}}(e,t,n,s);break;default:throw new EvalError("undefined block found")}return!1}async function mn(e){if("gif"===e.type){e.loading=!0;try{e.gifData=await async function(e,t,i){i||(i=!1);const n=await fetch(e);if(!n.ok&&404===n.status)throw new EvalError("file not found");const s=await n.arrayBuffer(),r={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},o=new pn(new Uint8ClampedArray(s));if("GIF89a"!==o.getString(6))throw new Error("not a supported GIF file");r.width=o.nextTwoBytes(),r.height=o.nextTwoBytes();const a=o.nextByte(),l=!(128&~a);r.colorRes=(112&a)>>>4,r.sortFlag=!(8&~a);const c=1<<1+(7&a),d=o.nextByte();r.pixelAspectRatio=o.nextByte(),0!==r.pixelAspectRatio&&(r.pixelAspectRatio=(r.pixelAspectRatio+15)/64),l&&(r.globalColorTable=vn(o,c));const u=(()=>{try{return new ImageData(r.width,r.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==u)throw new Error("GIF frame size is to large");const{r:h,g:p,b:f}=r.globalColorTable[d];u.data.set(l?[h,p,f,255]:[0,0,0,0]);for(let e=4;e<u.data.length;e*=2)u.data.copyWithin(e,0,e);r.backgroundImage=u;let g=-1,v=!0,_=-1;const m=e=>(e&&(v=!0),g),y=e=>(null!=e&&(_=e),_);try{do{v&&(r.frames.push({left:0,top:0,width:0,height:0,disposalMethod:fn.Replace,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),g++,_=-1,v=!1)}while(!await _n(o,r,i,m,y,undefined));r.frames.length--;for(const e of r.frames){if(e.userInputDelayFlag&&0===e.delayTime){r.totalTime=1/0;break}r.totalTime+=e.delayTime}return r}catch(e){if(e instanceof EvalError)throw new Error(`error while parsing frame ${g} "${e.message}"`);throw e}}(e.source),e.gifLoopCount=function(e){for(const t of e.applicationExtensions)if(t.identifier+t.authenticationCode==="NETSCAPE2.0")return t.data[1]+(t.data[2]<<8);return NaN}(e.gifData)??0,e.gifLoopCount||(e.gifLoopCount=1/0)}catch{e.error=!0}e.loading=!1}else await cn(e)}class yn{constructor(e){this.validTypes=["image","images"],this.loadImageShape=async e=>{if(!this._engine.loadImage)throw new Error(`${f} image shape not initialized`);await this._engine.loadImage({gif:e.gif,name:e.name,replaceColor:e.replaceColor??!1,src:e.src})},this._engine=e}addImage(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}draw(e){const{context:t,radius:i,particle:n,opacity:s}=e,r=n.image,o=r?.element;if(r){if(t.globalAlpha=s,r.gif&&r.gifData)!function(e){const{context:t,radius:i,particle:n,delta:s}=e,r=n.image;if(!r?.gifData||!r.gif)return;const o=new OffscreenCanvas(r.gifData.width,r.gifData.height),a=o.getContext("2d");if(!a)throw new Error("could not create offscreen canvas context");a.imageSmoothingQuality="low",a.imageSmoothingEnabled=!1,a.clearRect(0,0,o.width,o.height),void 0===n.gifLoopCount&&(n.gifLoopCount=r.gifLoopCount??0);let l=n.gifFrame??0;const c={x:.5*-r.gifData.width,y:.5*-r.gifData.height},d=r.gifData.frames[l];if(void 0===n.gifTime&&(n.gifTime=0),d.bitmap){switch(t.scale(i/r.gifData.width,i/r.gifData.height),d.disposalMethod){case fn.UndefinedA:case fn.UndefinedB:case fn.UndefinedC:case fn.UndefinedD:case fn.Replace:a.drawImage(d.bitmap,d.left,d.top),t.drawImage(o,c.x,c.y),a.clearRect(0,0,o.width,o.height);break;case fn.Combine:a.drawImage(d.bitmap,d.left,d.top),t.drawImage(o,c.x,c.y);break;case fn.RestoreBackground:a.drawImage(d.bitmap,d.left,d.top),t.drawImage(o,c.x,c.y),a.clearRect(0,0,o.width,o.height),r.gifData.globalColorTable.length?a.putImageData(r.gifData.backgroundImage,c.x,c.y):a.putImageData(r.gifData.frames[0].image,c.x+d.left,c.y+d.top);break;case fn.RestorePrevious:{const e=a.getImageData(0,0,o.width,o.height);a.drawImage(d.bitmap,d.left,d.top),t.drawImage(o,c.x,c.y),a.clearRect(0,0,o.width,o.height),a.putImageData(e,0,0)}}if(n.gifTime+=s.value,n.gifTime>d.delayTime){if(n.gifTime-=d.delayTime,++l>=r.gifData.frames.length){if(--n.gifLoopCount<=0)return;l=0,a.clearRect(0,0,o.width,o.height)}n.gifFrame=l}t.scale(r.gifData.width/i,r.gifData.height/i)}}(e);else if(o){const e=r.ratio,n={x:-i,y:-i},s=2*i;t.drawImage(o,n.x,n.y,s,s/e)}t.globalAlpha=1}}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(t.preload&&this._engine.loadImage)for(const e of t.preload)await this._engine.loadImage(e)}loadShape(e){if("image"!==e.shape&&"images"!==e.shape)return;this._engine.images||(this._engine.images=[]);const t=e.shapeData;if(!t)return;const i=this._engine.images.find(e=>e.name===t.name||e.source===t.src);i||this.loadImageShape(t).then(()=>{this.loadShape(e)})}particleInit(e,t){if("image"!==t.shape&&"images"!==t.shape)return;this._engine.images||(this._engine.images=[]);const i=this._engine.images,n=t.shapeData;if(!n)return;const s=t.getFillColor(),r=i.find(e=>e.name===n.name||e.source===n.src);if(!r)return;const o=n.replaceColor??r.replaceColor;r.loading?setTimeout(()=>{this.particleInit(e,t)}):(async()=>{let e;e=r.svgData&&s?await function(e,t,i,n){const s=function(e,t,i){const{svgData:n}=e;if(!n)return"";const s=Ae(t,i);if(n.includes("fill"))return n.replace(ln,()=>s);const r=n.indexOf(">");return`${n.substring(0,r)} fill="${s}"${n.substring(r)}`}(e,i,n.opacity?.value??1),r={color:i,gif:t.gif,data:{...e,svgData:s},loaded:!1,ratio:t.width/t.height,replaceColor:t.replaceColor,source:t.src};return new Promise(t=>{const i=new Blob([s],{type:"image/svg+xml"}),n=URL||window.URL||window.webkitURL||window,o=n.createObjectURL(i),a=new Image;a.addEventListener("load",()=>{r.loaded=!0,r.element=a,t(r),n.revokeObjectURL(o)}),a.addEventListener("error",()=>{(async()=>{n.revokeObjectURL(o);const i={...e,error:!1,loading:!0};await cn(i),r.loaded=!0,r.element=i.element,t(r)})()}),a.src=o})}(r,n,s,t):{color:s,data:r,element:r.element,gif:r.gif,gifData:r.gifData,gifLoopCount:r.gifLoopCount,loaded:!0,ratio:n.width&&n.height?n.width/n.height:r.ratio??1,replaceColor:o,source:n.src},e.ratio||(e.ratio=1);const i={image:e,fill:n.fill??t.shapeFill,close:n.close??t.shapeClose};t.image=i.image,t.shapeFill=i.fill,t.shapeClose=i.close})()}}class bn{constructor(){this.src="",this.gif=!1}load(e){F(e)||(void 0!==e.gif&&(this.gif=e.gif),void 0!==e.height&&(this.height=e.height),void 0!==e.name&&(this.name=e.name),void 0!==e.replaceColor&&(this.replaceColor=e.replaceColor),void 0!==e.src&&(this.src=e.src),void 0!==e.width&&(this.width=e.width))}}class wn{constructor(e){this.id="imagePreloader",this._engine=e}async getPlugin(){return await Promise.resolve(),{}}loadOptions(e,t){if(!t?.preload)return;e.preload||(e.preload=[]);const i=e.preload;for(const e of t.preload){const t=i.find(t=>t.name===e.name||t.src===e.src);if(t)t.load(e);else{const t=new bn;t.load(e),i.push(t)}}}needsPlugin(){return!0}}class xn extends mt{constructor(){super(),this.sync=!1}load(e){F(e)||(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class kn extends mt{constructor(){super(),this.sync=!1}load(e){F(e)||(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class Sn{constructor(){this.count=0,this.delay=new xn,this.duration=new kn}load(e){F(e)||(void 0!==e.count&&(this.count=e.count),this.delay.load(e.delay),this.duration.load(e.duration))}}class Pn{constructor(e){this.container=e}init(e){const t=this.container,i=e.options.life;i&&(e.life={delay:t.retina.reduceFactor?q(i.delay.value)*(i.delay.sync?1:A())/t.retina.reduceFactor*_:0,delayTime:0,duration:t.retina.reduceFactor?q(i.duration.value)*(i.duration.sync?1:A())/t.retina.reduceFactor*_:0,time:0,count:i.count},e.life.duration<=0&&(e.life.duration=-1),e.life.count<=0&&(e.life.count=-1),e.life&&(e.spawning=e.life.delay>0))}isEnabled(e){return!e.destroyed}loadOptions(e,...t){e.life||(e.life=new Sn);for(const i of t)e.life.load(i?.life)}update(e,t){this.isEnabled(e)&&e.life&&function(e,t,i){if(!e.life)return;const n=e.life;let s=!1;if(e.spawning){if(n.delayTime+=t.value,!(n.delayTime>=e.life.delay))return;s=!0,e.spawning=!1,n.delayTime=0,n.time=0}if(-1===n.duration)return;if(e.spawning)return;if(s?n.time=0:n.time+=t.value,n.time<n.duration)return;if(n.time=0,e.life.count>0&&e.life.count--,0===e.life.count)return void e.destroy();const r=U(0,i.width),o=U(0,i.width);e.position.x=B(r),e.position.y=B(o),e.spawning=!0,n.delayTime=0,n.time=0,e.reset();const a=e.options.life;a&&(n.delay=q(a.delay.value)*_,n.duration=q(a.duration.value)*_)}(e,t,this.container.canvas.size)}}class Tn{constructor(){this.factor=4,this.value=!0}load(e){F(e)||(void 0!==e.factor&&(this.factor=e.factor),void 0!==e.value&&(this.value=e.value))}}class En{constructor(){this.disable=!1,this.reduce=new Tn}load(e){F(e)||(void 0!==e.disable&&(this.disable=e.disable),this.reduce.load(e.reduce))}}class Cn{constructor(e,t){this._handleMotionChange=e=>{const t=this._container,i=t.actualOptions.motion;i&&(e.matches?i.disable?t.retina.reduceFactor=0:t.retina.reduceFactor=i.reduce.value?1/i.reduce.factor:1:t.retina.reduceFactor=1)},this._container=e,this._engine=t}async init(){const e=this._container,t=e.actualOptions.motion;if(!t||!t.disable&&!t.reduce.value)return void(e.retina.reduceFactor=1);const i=se("(prefers-reduced-motion: reduce)");if(!i)return void(e.retina.reduceFactor=1);this._handleMotionChange(i);const n=()=>{(async()=>{this._handleMotionChange(i);try{await e.refresh()}catch{}})()};void 0!==i.addEventListener?i.addEventListener("change",n):void 0!==i.addListener&&i.addListener(n),await Promise.resolve()}}class In{constructor(e){this.id="motion",this._engine=e}getPlugin(e){return Promise.resolve(new Cn(e,this._engine))}loadOptions(e,t){if(!this.needsPlugin())return;let i=e.motion;i?.load||(e.motion=i=new En),i.load(t?.motion)}needsPlugin(){return!0}}class Mn{draw(e){const{particle:t,radius:i}=e;!function(e,t,i){const{context:n}=e,s=i.count.numerator*i.count.denominator,r=i.count.numerator/i.count.denominator,o=180*(r-2)/r,a=Math.PI-W(o);if(n){n.beginPath(),n.translate(t.x,t.y),n.moveTo(0,0);for(let e=0;e<s;e++)n.lineTo(i.length,0),n.translate(i.length,0),n.rotate(a)}}(e,this.getCenter(t,i),this.getSidesData(t,i))}getSidesCount(e){const t=e.shapeData;return Math.round(q(t?.sides??5))}}class Rn extends Mn{constructor(){super(...arguments),this.validTypes=["polygon"]}getCenter(e,t){return{x:-t/(e.sides/3.5),y:-t/.76}}getSidesData(e,t){const i=e.sides;return{count:{denominator:1,numerator:i},length:2.66*t/(i/3)}}}class Fn extends Mn{constructor(){super(...arguments),this.validTypes=["triangle"]}getCenter(e,t){return{x:-t,y:t/1.66}}getSidesCount(){return 3}getSidesData(e,t){return{count:{denominator:2,numerator:3},length:2*t}}}var On;!function(e){e.both="both",e.horizontal="horizontal",e.vertical="vertical"}(On||(On={}));const Ln=2*Math.PI;class Dn{constructor(){this.enable=!1,this.value=0}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.value&&(this.value=U(e.value)))}}class zn{constructor(){this.darken=new Dn,this.enable=!1,this.enlighten=new Dn,this.mode=On.vertical,this.speed=25}load(e){F(e)||(void 0!==e.backColor&&(this.backColor=Ye.create(this.backColor,e.backColor)),this.darken.load(e.darken),void 0!==e.enable&&(this.enable=e.enable),this.enlighten.load(e.enlighten),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.speed&&(this.speed=U(e.speed)))}}class Gn{constructor(e){this._engine=e}getTransformValues(e){const t=e.roll?.enable&&e.roll,i=t&&t.horizontal,n=t&&t.vertical;return{a:i?Math.cos(t.angle):void 0,d:n?Math.sin(t.angle):void 0}}init(e){!function(e,t){const i=t.options.roll;if(i?.enable)if(t.roll={enable:i.enable,horizontal:i.mode===On.horizontal||i.mode===On.both,vertical:i.mode===On.vertical||i.mode===On.both,angle:A()*Ln,speed:q(i.speed)/360},i.backColor)t.backColor=De(e,i.backColor);else if(i.darken.enable&&i.enlighten.enable){const e=A()>=v?be.darken:be.enlighten;t.roll.alter={type:e,value:q(e===be.darken?i.darken.value:i.enlighten.value)}}else i.darken.enable?t.roll.alter={type:be.darken,value:q(i.darken.value)}:i.enlighten.enable&&(t.roll.alter={type:be.enlighten,value:q(i.enlighten.value)});else t.roll={enable:!1,horizontal:!1,vertical:!1,angle:0,speed:0}}(this._engine,e)}isEnabled(e){const t=e.options.roll;return!e.destroyed&&!e.spawning&&!!t?.enable}loadOptions(e,...t){e.roll||(e.roll=new zn);for(const i of t)e.roll.load(i?.roll)}update(e,t){this.isEnabled(e)&&function(e,t){const i=e.options.roll,n=e.roll;if(!n||!i?.enable)return;const s=n.speed*t.factor,r=Ln;n.angle+=s,n.angle>r&&(n.angle-=r)}(e,t)}}class An{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=U(e.speed)),void 0!==e.decay&&(this.decay=U(e.decay)),void 0!==e.sync&&(this.sync=e.sync))}}class $n extends mt{constructor(){super(),this.animation=new An,this.direction=pi.clockwise,this.path=!1,this.value=0}load(e){F(e)||(super.load(e),void 0!==e.direction&&(this.direction=e.direction),this.animation.load(e.animation),void 0!==e.path&&(this.path=e.path))}}const Bn=2*Math.PI;class qn{constructor(e){this.container=e}init(e){const t=e.options.rotate;if(!t)return;e.rotate={enable:t.animation.enable,value:W(q(t.value)),min:0,max:Bn},e.pathRotation=t.path;let i=t.direction;switch(i===pi.random&&(i=Math.floor(2*A())>0?pi.counterClockwise:pi.clockwise),i){case pi.counterClockwise:case"counterClockwise":e.rotate.status=Q.decreasing;break;case pi.clockwise:e.rotate.status=Q.increasing}const n=t.animation;n.enable&&(e.rotate.decay=1-q(n.decay),e.rotate.velocity=q(n.speed)/360*this.container.retina.reduceFactor,n.sync||(e.rotate.velocity*=A())),e.rotation=e.rotate.value}isEnabled(e){const t=e.options.rotate;return!!t&&!e.destroyed&&!e.spawning&&(!!t.value||t.animation.enable||t.path)}loadOptions(e,...t){e.rotate||(e.rotate=new $n);for(const i of t)e.rotate.load(i?.rotate)}update(e,t){this.isEnabled(e)&&(e.isRotating=!!e.rotate,e.rotate&&(me(e,e.rotate,!1,J.none,t),e.rotation=e.rotate.value))}}const jn=Math.sqrt(2);class Nn{constructor(){this.validTypes=["edge","square"]}draw(e){!function(e){const{context:t,radius:i}=e,n=i/jn,s=2*n;t.rect(-n,-n,s,s)}(e)}getSidesCount(){return 4}}class Un{constructor(){this.validTypes=["star"]}draw(e){!function(e){const{context:t,particle:i,radius:n}=e,s=i.sides,r=i.starInset??2;t.moveTo(0,0-n);for(let e=0;e<s;e++)t.rotate(Math.PI/s),t.lineTo(0,0-n*r),t.rotate(Math.PI/s),t.lineTo(0,0-n)}(e)}getSidesCount(e){const t=e.shapeData;return Math.round(q(t?.sides??5))}particleInit(e,t){const i=t.shapeData;t.starInset=q(i?.inset??2)}}var Hn;!function(e){e.clockwise="clockwise",e.counterClockwise="counter-clockwise",e.random="random"}(Hn||(Hn={}));class Vn{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){F(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=U(e.speed)),void 0!==e.decay&&(this.decay=U(e.decay)),void 0!==e.sync&&(this.sync=e.sync))}}class Wn extends mt{constructor(){super(),this.animation=new Vn,this.direction=Hn.clockwise,this.enable=!1,this.value=0}load(e){super.load(e),F(e)||(this.animation.load(e.animation),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.enable&&(this.enable=e.enable))}}const Yn=2*Math.PI;class Xn{constructor(e){this.container=e}getTransformValues(e){const t=e.tilt?.enable&&e.tilt;return{b:t?Math.cos(t.value)*t.cosDirection:void 0,c:t?Math.sin(t.value)*t.sinDirection:void 0}}init(e){const t=e.options.tilt;if(!t)return;e.tilt={enable:t.enable,value:W(q(t.value)),sinDirection:A()>=v?1:-1,cosDirection:A()>=v?1:-1,min:0,max:Yn};let i=t.direction;switch(i===Hn.random&&(i=Math.floor(2*A())>0?Hn.counterClockwise:Hn.clockwise),i){case Hn.counterClockwise:case"counterClockwise":e.tilt.status=Q.decreasing;break;case Hn.clockwise:e.tilt.status=Q.increasing}const n=e.options.tilt?.animation;n?.enable&&(e.tilt.decay=1-q(n.decay),e.tilt.velocity=q(n.speed)/360*this.container.retina.reduceFactor,n.sync||(e.tilt.velocity*=A()))}isEnabled(e){const t=e.options.tilt?.animation;return!e.destroyed&&!e.spawning&&!!t?.enable}loadOptions(e,...t){e.tilt||(e.tilt=new Wn);for(const i of t)e.tilt.load(i?.tilt)}async update(e,t){this.isEnabled(e)&&e.tilt&&(me(e,e.tilt,!1,J.none,t),await Promise.resolve())}}class Qn{constructor(){this.angle=50,this.move=10}load(e){F(e)||(void 0!==e.angle&&(this.angle=U(e.angle)),void 0!==e.move&&(this.move=U(e.move)))}}class Jn{constructor(){this.distance=5,this.enable=!1,this.speed=new Qn}load(e){if(!F(e)&&(void 0!==e.distance&&(this.distance=U(e.distance)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed))if(I(e.speed))this.speed.load({angle:e.speed});else{const t=e.speed;void 0!==t.min?this.speed.load({angle:t}):this.speed.load(e.speed)}}}const Kn=2*Math.PI,Zn=2*Math.PI;class es{constructor(e){this.container=e}init(e){const t=e.options.wobble;e.wobble=t?.enable?{angle:A()*Zn,angleSpeed:q(t.speed.angle)/360,moveSpeed:q(t.speed.move)/10}:{angle:0,angleSpeed:0,moveSpeed:0},e.retina.wobbleDistance=q(t?.distance??0)*this.container.retina.pixelRatio}isEnabled(e){return!e.destroyed&&!e.spawning&&!!e.options.wobble?.enable}loadOptions(e,...t){e.wobble||(e.wobble=new Jn);for(const i of t)e.wobble.load(i?.wobble)}update(e,t){this.isEnabled(e)&&function(e,t){const{wobble:i}=e.options,{wobble:n}=e;if(!i?.enable||!n)return;const s=n.angleSpeed*t.factor,r=n.moveSpeed*t.factor*((e.retina.wobbleDistance??0)*t.factor)/16.666666666666668,o=Kn,{position:a}=e;n.angle+=s,n.angle>o&&(n.angle-=o),a.x+=r*Math.cos(n.angle),a.y+=r*Math.abs(Math.sin(n.angle))}(e,t)}}let ts=!1,is=!1;const ns=new Map;async function ss(e){if(!ts){if(is)return new Promise(e=>{const t=setInterval(()=>{ts&&(clearInterval(t),e())},100)});is=!0,e.checkVersion("3.8.1"),await async function(e,t=!0){e.checkVersion("3.8.1"),e.emitterShapeManager||(e.emitterShapeManager=new Ii(e)),e.addEmitterShapeGenerator||(e.addEmitterShapeGenerator=(t,i)=>{e.emitterShapeManager?.addShapeGenerator(t,i)});const i=new Ei(e);await e.addPlugin(i,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addPlugin(new In(e),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new sn,t),await e.addShape(new nn,t),await e.addShape(new tn,t),await e.addShape(new en,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new an,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),function(e){e.loadImage||(e.loadImage=async t=>{if(!t.name&&!t.src)throw new Error(`${f} no image source provided`);if(e.images||(e.images=[]),!e.images.find(e=>e.name===t.name||e.source===t.src))try{const i={gif:t.gif??!1,name:t.name??t.src,source:t.src,type:t.src.substring(t.src.length-3),error:!1,loading:!0,replaceColor:t.replaceColor,ratio:t.width&&t.height?t.width/t.height:void 0};let n;e.images.push(i),n=t.gif?mn:t.replaceColor?dn:cn,await n(i)}catch{throw new Error(`${f} ${t.name??t.src} not found`)}})}(e);const i=new wn(e);await e.addPlugin(i,t),await e.addShape(new yn(e),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new Rn,t)}(e,t),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new Fn,t)}(e,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new Nn,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new Un,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new on,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("rotate",e=>Promise.resolve(new qn(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("life",async e=>Promise.resolve(new Pn(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("roll",()=>Promise.resolve(new Gn(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("tilt",e=>Promise.resolve(new Xn(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("wobble",e=>Promise.resolve(new es(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addColorManager(new $i,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addColorManager(new ji,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addColorManager(new Xi,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addMover("base",()=>Promise.resolve(new Fi),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addShape(new Li,t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("color",t=>Promise.resolve(new Di(t,e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("opacity",e=>Promise.resolve(new Ni(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("outModes",e=>Promise.resolve(new Yi(e)),t)}(e,!1),await async function(e,t=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("size",()=>Promise.resolve(new Qi),t)}(e,!1),await e.refresh(t)}(e),is=!1,ts=!0}}async function rs(e){const t=new Mi;let i;t.load(e.options);const n=t.ticks*_/432e3;if(ns.has(e.id)&&(i=ns.get(e.id),i&&!i.destroyed)){const e=i;if(e.addEmitter)return void await e.addEmitter({startCount:t.count,position:t.position,size:{width:0,height:0},rate:{delay:0,quantity:0},life:{duration:.1,count:1},particles:{color:{value:t.colors},shape:{type:t.shapes,options:t.shapeOptions},life:{count:1},opacity:{value:{min:0,max:1},animation:{enable:!0,sync:!0,speed:n,startValue:"max",destroy:"min"}},size:{value:5*t.scalar},move:{angle:{value:t.spread,offset:0},drift:{min:-t.drift,max:t.drift},gravity:{acceleration:9.81*t.gravity},speed:3*t.startVelocity,decay:1-t.decay,direction:-t.angle},rotate:{value:t.flat?0:{min:0,max:360},direction:"random",animation:{enable:!t.flat,speed:60}},tilt:{direction:"random",enable:!t.flat,value:t.flat?0:{min:0,max:360},animation:{enable:!0,speed:60}},roll:{darken:{enable:!0,value:25},enable:!t.flat,speed:{min:15,max:25}},wobble:{distance:30,enable:!t.flat,speed:{min:-15,max:15}}}})}const s={fullScreen:{enable:!e.canvas,zIndex:t.zIndex},fpsLimit:120,particles:{number:{value:0},color:{value:t.colors},shape:{type:t.shapes,options:t.shapeOptions},opacity:{value:{min:0,max:1},animation:{enable:!0,sync:!0,speed:n,startValue:"max",destroy:"min"}},size:{value:5*t.scalar},links:{enable:!1},life:{count:1},move:{angle:{value:t.spread,offset:0},drift:{min:-t.drift,max:t.drift},enable:!0,gravity:{enable:!0,acceleration:9.81*t.gravity},speed:3*t.startVelocity,decay:1-t.decay,direction:-t.angle,random:!0,straight:!1,outModes:{default:"none",bottom:"destroy"}},rotate:{value:t.flat?0:{min:0,max:360},direction:"random",animation:{enable:!t.flat,speed:60}},tilt:{direction:"random",enable:!t.flat,value:t.flat?0:{min:0,max:360},animation:{enable:!0,speed:60}},roll:{darken:{enable:!0,value:25},enable:!t.flat,speed:{min:15,max:25}},wobble:{distance:30,enable:!t.flat,speed:{min:-15,max:15}}},detectRetina:!0,motion:{disable:t.disableForReducedMotion},emitters:{name:"confetti",startCount:t.count,position:t.position,size:{width:0,height:0},rate:{delay:0,quantity:0},life:{duration:.1,count:1}}};return i=await vi.load({id:e.id,element:e.canvas,options:s}),ns.set(e.id,i),i}async function os(e,t){let i,n;return await ss(vi),C(e)?(n=e,i=t??{}):(n="confetti",i=e),rs({id:n,options:i})}function as(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function r(i,n,s,r){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return ls(c,"_invoke",function(i,n,s){var r,a,l,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,a=0,l=e,h.n=i,o}};function p(i,n){for(a=i,l=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(l=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(a=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,a=0))}if(s||i>1)return o;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),a=d,l=f;(t=a<2?e:l)||!u;){r||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,r){if(a||(s="next"),t=r[s]){if(!(t=t.call(r,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=r.return)&&t.call(r),a<2&&(l=TypeError("The iterator does not provide a '"+s+"' method"),a=1);r=e}else if((t=(u=h.n<0)?l:i.call(n,h))!==o)break}catch(t){r=e,a=1,l=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),c}var o={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(ls(t={},n,function(){return this}),t),u=c.prototype=a.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ls(e,s,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,ls(u,"constructor",c),ls(c,"constructor",l),l.displayName="GeneratorFunction",ls(c,s,"GeneratorFunction"),ls(u),ls(u,s,"Generator"),ls(u,n,function(){return this}),ls(u,"toString",function(){return"[object Generator]"}),(as=function(){return{w:r,m:h}})()}function ls(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}ls=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){ls(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},ls(e,t,i,n)}function cs(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}os.create=async(e,t)=>{if(!e)return os;await ss(vi);const i=e.getAttribute("id")??"confetti";return e.setAttribute("id",i),async(n,s)=>{let r,o;return C(n)?(o=n,r=s??t):(o=i,r=n),rs({id:o,canvas:e,options:r})}},os.init=async()=>{await ss(vi)},os.version="3.8.1",ne()||(window.confetti=os);var ds={infoPopupHeader:chrome.i18n.getMessage("infoPopupHeader"),infoPopupText:chrome.i18n.getMessage("infoPopupText"),infoPopupNote:chrome.i18n.getMessage("infoPopupNote"),infoPopupTip:chrome.i18n.getMessage("infoPopupTip")};function us(){return new Promise(function(e){var t=document.createElement("div");t.className="happy-news-overlay";var i=document.createElement("div");i.className="happy-news-popup";var n=document.createElement("div");n.classList.add("popup-slide","active");var s=document.createElement("h2");s.textContent=" ".concat(ds.infoPopupHeader," ");var r=document.createElement("p");r.textContent=ds.infoPopupText;var o=document.createElement("p");o.textContent=ds.infoPopupNote,o.className="light-text";var a=document.createElement("button");a.classList.add("happy-news-button"),a.textContent="Next",n.appendChild(s),n.appendChild(r),n.appendChild(o),n.appendChild(a);var l=document.createElement("div");l.classList.add("popup-slide");var c=document.createElement("p");c.style.whiteSpace="pre-wrap",c.style.textAlign="left",c.textContent=" ".concat(ds.infoPopupTip);var d=chrome.runtime.getURL("assets/download_instruction.mp4"),u=document.createElement("video");u.controls=!0,u.loop=!0,u.style.marginTop="10px",u.style.borderRadius="8px";var h=document.createElement("source");h.src=d,h.type="video/mp4",u.appendChild(h),a.addEventListener("click",function(){n.classList.remove("active"),l.classList.add("active"),u.play()});var p=document.createElement("button");p.classList.add("happy-news-button"),p.textContent="Close",p.addEventListener("click",function(){t.remove(),e()}),l.appendChild(c),l.appendChild(u),l.appendChild(p),i.appendChild(n),i.appendChild(l),t.appendChild(i),document.body.appendChild(t),function(){hs.apply(this,arguments)}()})}function hs(){return hs=function(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){cs(r,n,s,o,a,"next",e)}function a(e){cs(r,n,s,o,a,"throw",e)}o(void 0)})}}(as().m(function e(){var t,i,n,s;return as().w(function(e){for(;;)switch(e.n){case 0:n=function(e,t){return Math.random()*(t-e)+e},t=Date.now()+1e3,i={startVelocity:30,spread:360,ticks:60,zIndex:0},s=setInterval(function(){var e=t-Date.now();if(e<=0)return clearInterval(s);var r=e/1e3*50;os(Object.assign({},i,{particleCount:r,origin:{x:n(.1,.3),y:Math.random()-.2}})),os(Object.assign({},i,{particleCount:r,origin:{x:n(.7,.9),y:Math.random()-.2}}))},250);case 1:return e.a(2)}},e)})),hs.apply(this,arguments)}function ps(){return ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},ps.apply(null,arguments)}function fs(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}var gs="undefined"!=typeof window?window:void 0,vs="undefined"!=typeof globalThis?globalThis:gs,_s=Array.prototype,ms=_s.forEach,ys=_s.indexOf,bs=null==vs?void 0:vs.navigator,ws=null==vs?void 0:vs.document,xs=null==vs?void 0:vs.location,ks=null==vs?void 0:vs.fetch,Ss=null!=vs&&vs.XMLHttpRequest&&"withCredentials"in new vs.XMLHttpRequest?vs.XMLHttpRequest:void 0,Ps=null==vs?void 0:vs.AbortController,Ts=null==bs?void 0:bs.userAgent,Es=null!=gs?gs:{},Cs={DEBUG:!1,LIB_VERSION:"1.257.1"},Is="$copy_autocapture",Ms=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],Rs=function(e){return e.GZipJS="gzip-js",e.Base64="base64",e}({}),Fs=["fatal","error","warning","log","info","debug"];function Os(e,t){return-1!==e.indexOf(t)}var Ls=function(e){return e.trim()},Ds=function(e){return e.replace(/^\$/,"")},zs=Array.isArray,Gs=Object.prototype,As=Gs.hasOwnProperty,$s=Gs.toString,Bs=zs||function(e){return"[object Array]"===$s.call(e)},qs=e=>"function"==typeof e,js=e=>e===Object(e)&&!Bs(e),Ns=e=>{if(js(e)){for(var t in e)if(As.call(e,t))return!1;return!0}return!1},Us=e=>void 0===e,Hs=e=>"[object String]"==$s.call(e),Vs=e=>Hs(e)&&0===e.trim().length,Ws=e=>null===e,Ys=e=>Us(e)||Ws(e),Xs=e=>"[object Number]"==$s.call(e),Qs=e=>"[object Boolean]"===$s.call(e),Js=e=>Os(Ms,e),Ks=e=>{var t={_log:function(t){if(gs&&(Cs.DEBUG||Es.POSTHOG_DEBUG)&&!Us(gs.console)&&gs.console){for(var i=("__rrweb_original__"in gs.console[t]?gs.console[t].__rrweb_original__:gs.console[t]),n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];i(e,...s)}},info:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._log("log",...i)},warn:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._log("warn",...i)},error:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._log("error",...i)},critical:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];console.error(e,...i)},uninitializedWarning:e=>{t.error("You must initialize PostHog before calling "+e)},createLogger:t=>Ks(e+" "+t)};return t},Zs=Ks("[PostHog.js]"),er=Zs.createLogger,tr={};function ir(e,t,i){if(Bs(e))if(ms&&e.forEach===ms)e.forEach(t,i);else if("length"in e&&e.length===+e.length)for(var n=0,s=e.length;n<s;n++)if(n in e&&t.call(i,e[n],n)===tr)return}function nr(e,t,i){if(!Ys(e)){if(Bs(e))return ir(e,t,i);if((e=>e instanceof FormData)(e)){for(var n of e.entries())if(t.call(i,n[1],n[0])===tr)return}else for(var s in e)if(As.call(e,s)&&t.call(i,e[s],s)===tr)return}}var sr=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ir(i,function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])}),e},rr=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ir(i,function(t){ir(t,function(t){e.push(t)})}),e};function or(e){for(var t=Object.keys(e),i=t.length,n=new Array(i);i--;)n[i]=[t[i],e[t[i]]];return n}var ar=function(e){try{return e()}catch(e){return}},lr=function(e){return function(){try{for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e.apply(this,i)}catch(e){Zs.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Zs.critical(e)}}},cr=function(e){var t={};return nr(e,function(e,i){(Hs(e)&&e.length>0||Xs(e))&&(t[i]=e)}),t},dr=["herokuapp.com","vercel.app","netlify.app"];function ur(e){var t=null==e?void 0:e.hostname;if(!Hs(t))return!1;var i=t.split(".").slice(-2).join(".");for(var n of dr)if(i===n)return!1;return!0}function hr(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return e[i]}function pr(e,t,i,n){var{capture:s=!1,passive:r=!0}=null!=n?n:{};null==e||e.addEventListener(t,i,{capture:s,passive:r})}var fr="$people_distinct_id",gr="__alias",vr="__timers",_r="$autocapture_disabled_server_side",mr="$heatmaps_enabled_server_side",yr="$exception_capture_enabled_server_side",br="$error_tracking_suppression_rules",wr="$web_vitals_enabled_server_side",xr="$dead_clicks_enabled_server_side",kr="$web_vitals_allowed_metrics",Sr="$session_recording_enabled_server_side",Pr="$console_log_recording_enabled_server_side",Tr="$session_recording_network_payload_capture",Er="$session_recording_masking",Cr="$session_recording_canvas_recording",Ir="$replay_sample_rate",Mr="$replay_minimum_duration",Rr="$replay_script_config",Fr="$sesid",Or="$session_is_sampled",Lr="$session_recording_url_trigger_activated_session",Dr="$session_recording_event_trigger_activated_session",zr="$enabled_feature_flags",Gr="$early_access_features",Ar="$feature_flag_details",$r="$stored_person_properties",Br="$stored_group_properties",qr="$surveys",jr="$surveys_activated",Nr="$flag_call_reported",Ur="$user_state",Hr="$client_session_props",Vr="$capture_rate_limit",Wr="$initial_campaign_params",Yr="$initial_referrer_info",Xr="$initial_person_info",Qr="$epp",Jr="__POSTHOG_TOOLBAR__",Kr="$posthog_cookieless",Zr=[fr,gr,"__cmpns",vr,Sr,mr,Fr,zr,br,Ur,Gr,Ar,Br,$r,qr,Nr,Hr,Vr,Wr,Yr,Qr,Xr];function eo(e){return e instanceof Element&&(e.id===Jr||!(null==e.closest||!e.closest(".toolbar-global-fade-container")))}function to(e){return!!e&&1===e.nodeType}function io(e,t){return!!e&&!!e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function no(e){return!!e&&3===e.nodeType}function so(e){return!!e&&11===e.nodeType}function ro(e){return e?Ls(e).split(/\s+/):[]}function oo(e){var t=null==gs?void 0:gs.location.href;return!!(t&&e&&e.some(e=>t.match(e)))}function ao(e){var t="";switch(typeof e.className){case"string":t=e.className;break;case"object":t=(e.className&&"baseVal"in e.className?e.className.baseVal:null)||e.getAttribute("class")||"";break;default:t=""}return ro(t)}function lo(e){return Ys(e)?null:Ls(e).split(/(\s+)/).filter(e=>xo(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function co(e){var t="";return fo(e)&&!go(e)&&e.childNodes&&e.childNodes.length&&nr(e.childNodes,function(e){var i;no(e)&&e.textContent&&(t+=null!==(i=lo(e.textContent))&&void 0!==i?i:"")}),Ls(t)}function uo(e){return Us(e.target)?e.srcElement||null:null!=(t=e.target)&&t.shadowRoot?e.composedPath()[0]||null:e.target||null;var t}var ho=["a","button","form","input","select","textarea","label"];function po(e){var t=e.parentNode;return!(!t||!to(t))&&t}function fo(e){for(var t=e;t.parentNode&&!io(t,"body");t=t.parentNode){var i=ao(t);if(Os(i,"ph-sensitive")||Os(i,"ph-no-capture"))return!1}if(Os(ao(e),"ph-include"))return!0;var n=e.type||"";if(Hs(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=e.name||e.id||"";return!Hs(s)||!/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,""))}function go(e){return!!(io(e,"input")&&!["button","checkbox","submit","reset"].includes(e.type)||io(e,"select")||io(e,"textarea")||"true"===e.getAttribute("contenteditable"))}var vo="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",_o=new RegExp("^(?:"+vo+")$"),mo=new RegExp(vo),yo="\\d{3}-?\\d{2}-?\\d{4}",bo=new RegExp("^("+yo+")$"),wo=new RegExp("("+yo+")");function xo(e,t){if(void 0===t&&(t=!0),Ys(e))return!1;if(Hs(e)){if(e=Ls(e),(t?_o:mo).test((e||"").replace(/[- ]/g,"")))return!1;if((t?bo:wo).test(e))return!1}return!0}function ko(e){var t=co(e);return xo(t=(t+" "+So(e)).trim())?t:""}function So(e){var t="";return e&&e.childNodes&&e.childNodes.length&&nr(e.childNodes,function(e){var i;if(e&&"span"===(null==(i=e.tagName)?void 0:i.toLowerCase()))try{var n=co(e);t=(t+" "+n).trim(),e.childNodes&&e.childNodes.length&&(t=(t+" "+So(e)).trim())}catch(e){Zs.error("[AutoCapture]",e)}}),t}function Po(e){return function(e){var t=e.map(e=>{var t,i,n="";if(e.tag_name&&(n+=e.tag_name),e.attr_class)for(var s of(e.attr_class.sort(),e.attr_class))n+="."+s.replace(/"/g,"");var r=ps({},e.text?{text:e.text}:{},{"nth-child":null!==(t=e.nth_child)&&void 0!==t?t:0,"nth-of-type":null!==(i=e.nth_of_type)&&void 0!==i?i:0},e.href?{href:e.href}:{},e.attr_id?{attr_id:e.attr_id}:{},e.attributes),o={};return or(r).sort((e,t)=>{var[i]=e,[n]=t;return i.localeCompare(n)}).forEach(e=>{var[t,i]=e;return o[To(t.toString())]=To(i.toString())}),(n+=":")+or(o).map(e=>{var[t,i]=e;return t+'="'+i+'"'}).join("")});return t.join(";")}(function(e){return e.map(e=>{var t,i,n={text:null==(t=e.$el_text)?void 0:t.slice(0,400),tag_name:e.tag_name,href:null==(i=e.attr__href)?void 0:i.slice(0,2048),attr_class:Eo(e),attr_id:e.attr__id,nth_child:e.nth_child,nth_of_type:e.nth_of_type,attributes:{}};return or(e).filter(e=>{var[t]=e;return 0===t.indexOf("attr__")}).forEach(e=>{var[t,i]=e;return n.attributes[t]=i}),n})}(e))}function To(e){return e.replace(/"|\\"/g,'\\"')}function Eo(e){var t=e.attr__class;return t?Bs(t)?t:ro(t):void 0}class Co{constructor(){this.clicks=[]}isRageClick(e,t,i){var n=this.clicks[this.clicks.length-1];if(n&&Math.abs(e-n.x)+Math.abs(t-n.y)<30&&i-n.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:i}),3===this.clicks.length)return!0}else this.clicks=[{x:e,y:t,timestamp:i}];return!1}}var Io=["localhost","127.0.0.1"],Mo=e=>{var t=null==ws?void 0:ws.createElement("a");return Us(t)?null:(t.href=e,t)},Ro=function(e,t){for(var i,n=((e.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var r=n[s].split("=");if(r[0]===t){i=r;break}}if(!Bs(i)||i.length<2)return"";var o=i[1];try{o=decodeURIComponent(o)}catch(e){Zs.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},Fo=function(e,t,i){if(!e||!t||!t.length)return e;for(var n=e.split("#"),s=n[0]||"",r=n[1],o=s.split("?"),a=o[1],l=o[0],c=(a||"").split("&"),d=[],u=0;u<c.length;u++){var h=c[u].split("=");Bs(h)&&(t.includes(h[0])?d.push(h[0]+"="+i):d.push(c[u]))}var p=l;return null!=a&&(p+="?"+d.join("&")),null!=r&&(p+="#"+r),p},Oo=function(e,t){var i=e.match(new RegExp(t+"=([^&]*)"));return i?i[1]:null},Lo=er("[AutoCapture]");function Do(e,t){return t.length>e?t.slice(0,e)+"...":t}function zo(e){if(e.previousElementSibling)return e.previousElementSibling;var t=e;do{t=t.previousSibling}while(t&&!to(t));return t}class Go{constructor(e){this._initialized=!1,this._isDisabledServerSide=null,this.rageclicks=new Co,this._elementsChainAsString=!1,this.instance=e,this._elementSelectors=null}get _config(){var e,t,i=js(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=null==(e=i.url_allowlist)?void 0:e.map(e=>new RegExp(e)),i.url_ignorelist=null==(t=i.url_ignorelist)?void 0:t.map(e=>new RegExp(e)),i}_addDomEventHandlers(){if(this.isBrowserSupported()){if(gs&&ws){var e=e=>{e=e||(null==gs?void 0:gs.event);try{this._captureEvent(e)}catch(e){Lo.error("Failed to capture event",e)}};if(pr(ws,"submit",e,{capture:!0}),pr(ws,"change",e,{capture:!0}),pr(ws,"click",e,{capture:!0}),this._config.capture_copied_text){var t=e=>{e=e||(null==gs?void 0:gs.event),this._captureEvent(e,Is)};pr(ws,"copy",t,{capture:!0}),pr(ws,"cut",t,{capture:!0})}}}else Lo.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[_r]:!!e.autocapture_opt_out}),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this._elementSelectors=e}getElementSelectors(e){var t,i=[];return null==(t=this._elementSelectors)||t.forEach(t=>{var n=null==ws?void 0:ws.querySelectorAll(t);null==n||n.forEach(n=>{e===n&&i.push(t)})}),i}get isEnabled(){var e,t,i=null==(e=this.instance.persistence)?void 0:e.props[_r],n=this._isDisabledServerSide;if(Ws(n)&&!Qs(i)&&!this.instance._shouldDisableFlags())return!1;var s=null!==(t=this._isDisabledServerSide)&&void 0!==t?t:!!i;return!!this.instance.config.autocapture&&!s}_captureEvent(e,t){if(void 0===t&&(t="$autocapture"),this.isEnabled){var i,n=uo(e);no(n)&&(n=n.parentNode||null),"$autocapture"===t&&"click"===e.type&&e instanceof MouseEvent&&this.instance.config.rageclick&&null!=(i=this.rageclicks)&&i.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._captureEvent(e,"$rageclick");var s=t===Is;if(n&&function(e,t,i,n,s){var r,o,a;if(void 0===i&&(i=void 0),!gs||!e||io(e,"html")||!to(e))return!1;if(null!=(r=i)&&r.url_allowlist&&!oo(i.url_allowlist))return!1;if(null!=(o=i)&&o.url_ignorelist&&oo(i.url_ignorelist))return!1;if(null!=(a=i)&&a.dom_event_allowlist){var l=i.dom_event_allowlist;if(l&&!l.some(e=>t.type===e))return!1}for(var c=!1,d=[e],u=!0,h=e;h.parentNode&&!io(h,"body");)if(so(h.parentNode))d.push(h.parentNode.host),h=h.parentNode.host;else{if(!(u=po(h)))break;if(n||ho.indexOf(u.tagName.toLowerCase())>-1)c=!0;else{var p=gs.getComputedStyle(u);p&&"pointer"===p.getPropertyValue("cursor")&&(c=!0)}d.push(u),h=u}if(!function(e,t){var i=null==t?void 0:t.element_allowlist;if(Us(i))return!0;var n,s=function(e){if(i.some(t=>e.tagName.toLowerCase()===t))return{v:!0}};for(var r of e)if(n=s(r))return n.v;return!1}(d,i))return!1;if(!function(e,t){var i=null==t?void 0:t.css_selector_allowlist;if(Us(i))return!0;var n,s=function(e){if(i.some(t=>e.matches(t)))return{v:!0}};for(var r of e)if(n=s(r))return n.v;return!1}(d,i))return!1;var f=gs.getComputedStyle(e);if(f&&"pointer"===f.getPropertyValue("cursor")&&"click"===t.type)return!0;var g=e.tagName.toLowerCase();switch(g){case"html":return!1;case"form":return(s||["submit"]).indexOf(t.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(t.type)>=0;default:return c?(s||["click"]).indexOf(t.type)>=0:(s||["click"]).indexOf(t.type)>=0&&(ho.indexOf(g)>-1||"true"===e.getAttribute("contenteditable"))}}(n,e,this._config,s,s?["copy","cut"]:void 0)){var{props:r,explicitNoCapture:o}=function(e,t){for(var i,n,{e:s,maskAllElementAttributes:r,maskAllText:o,elementAttributeIgnoreList:a,elementsChainAsString:l}=t,c=[e],d=e;d.parentNode&&!io(d,"body");)so(d.parentNode)?(c.push(d.parentNode.host),d=d.parentNode.host):(c.push(d.parentNode),d=d.parentNode);var u,h=[],p={},f=!1,g=!1;if(nr(c,e=>{var t=fo(e);"a"===e.tagName.toLowerCase()&&(f=e.getAttribute("href"),f=t&&f&&xo(f)&&f),Os(ao(e),"ph-no-capture")&&(g=!0),h.push(function(e,t,i,n){var s=e.tagName.toLowerCase(),r={tag_name:s};ho.indexOf(s)>-1&&!i&&("a"===s.toLowerCase()||"button"===s.toLowerCase()?r.$el_text=Do(1024,ko(e)):r.$el_text=Do(1024,co(e)));var o=ao(e);o.length>0&&(r.classes=o.filter(function(e){return""!==e})),nr(e.attributes,function(i){var s;if((!go(e)||-1!==["name","id","class","aria-label"].indexOf(i.name))&&(null==n||!n.includes(i.name))&&!t&&xo(i.value)&&(s=i.name,!Hs(s)||"_ngcontent"!==s.substring(0,10)&&"_nghost"!==s.substring(0,7))){var o=i.value;"class"===i.name&&(o=ro(o).join(" ")),r["attr__"+i.name]=Do(1024,o)}});for(var a=1,l=1,c=e;c=zo(c);)a++,c.tagName===e.tagName&&l++;return r.nth_child=a,r.nth_of_type=l,r}(e,r,o,a));var i=function(e){if(!fo(e))return{};var t={};return nr(e.attributes,function(e){if(e.name&&0===e.name.indexOf("data-ph-capture-attribute")){var i=e.name.replace("data-ph-capture-attribute-",""),n=e.value;i&&n&&xo(n)&&(t[i]=n)}}),t}(e);sr(p,i)}),g)return{props:{},explicitNoCapture:g};if(o||("a"===e.tagName.toLowerCase()||"button"===e.tagName.toLowerCase()?h[0].$el_text=ko(e):h[0].$el_text=co(e)),f){var v,_;h[0].attr__href=f;var m=null==(v=Mo(f))?void 0:v.host,y=null==gs||null==(_=gs.location)?void 0:_.host;m&&y&&m!==y&&(u=f)}return{props:sr({$event_type:s.type,$ce_version:1},l?{}:{$elements:h},{$elements_chain:Po(h)},null!=(i=h[0])&&i.$el_text?{$el_text:null==(n=h[0])?void 0:n.$el_text}:{},u&&"click"===s.type?{$external_click_url:u}:{},p)}}(n,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this._config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(o)return!1;var a=this.getElementSelectors(n);if(a&&a.length>0&&(r.$element_selectors=a),t===Is){var l,c=lo(null==gs||null==(l=gs.getSelection())?void 0:l.toString()),d=e.type||"clipboard";if(!c)return!1;r.$selected_content=c,r.$copy_type=d}return this.instance.capture(t,r),!0}}}isBrowserSupported(){return qs(null==ws?void 0:ws.querySelectorAll)}}Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Number.isInteger||(Number.isInteger=function(e){return Xs(e)&&isFinite(e)&&Math.floor(e)===e});var Ao="0123456789abcdef";class $o{constructor(e){if(this.bytes=e,16!==e.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,i,n){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(i)||!Number.isInteger(n)||e<0||t<0||i<0||n<0||e>0xffffffffffff||t>4095||i>1073741823||n>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|t>>>8,s[7]=t,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=n>>>24,s[13]=n>>>16,s[14]=n>>>8,s[15]=n,new $o(s)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Ao.charAt(this.bytes[t]>>>4)+Ao.charAt(15&this.bytes[t]),3!==t&&5!==t&&7!==t&&9!==t||(e+="-");if(36!==e.length)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new $o(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(var t=0;t<16;t++){var i=this.bytes[t]-e.bytes[t];if(0!==i)return Math.sign(i)}return 0}}class Bo{constructor(){this._timestamp=0,this._counter=0,this._random=new No}generate(){var e=this.generateOrAbort();if(Us(e)){this._timestamp=0;var t=this.generateOrAbort();if(Us(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this._timestamp)this._timestamp=e,this._resetCounter();else{if(!(e+1e4>this._timestamp))return;this._counter++,this._counter>4398046511103&&(this._timestamp++,this._resetCounter())}return $o.fromFieldsV7(this._timestamp,Math.trunc(this._counter/Math.pow(2,30)),this._counter&Math.pow(2,30)-1,this._random.nextUint32())}_resetCounter(){this._counter=1024*this._random.nextUint32()+(1023&this._random.nextUint32())}}var qo,jo=e=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var t=0;t<e.length;t++)e[t]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return e};gs&&!Us(gs.crypto)&&crypto.getRandomValues&&(jo=e=>crypto.getRandomValues(e));class No{constructor(){this._buffer=new Uint32Array(8),this._cursor=1/0}nextUint32(){return this._cursor>=this._buffer.length&&(jo(this._buffer),this._cursor=0),this._buffer[this._cursor++]}}var Uo=()=>Ho().toString(),Ho=()=>(qo||(qo=new Bo)).generate(),Vo="",Wo=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,Yo={_is_supported:()=>!!ws,_error:function(e){Zs.error("cookieStore error: "+e)},_get:function(e){if(ws){try{for(var t=e+"=",i=ws.cookie.split(";").filter(e=>e.length),n=0;n<i.length;n++){for(var s=i[n];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return decodeURIComponent(s.substring(t.length,s.length))}}catch(e){}return null}},_parse:function(e){var t;try{t=JSON.parse(Yo._get(e))||{}}catch(e){}return t},_set:function(e,t,i,n,s){if(ws)try{var r="",o="",a=function(e,t){if(t){var i=function(e,t){if(void 0===t&&(t=ws),Vo)return Vo;if(!t)return"";if(["localhost","127.0.0.1"].includes(e))return"";for(var i=e.split("."),n=Math.min(i.length,8),s="dmn_chk_"+Uo();!Vo&&n--;){var r=i.slice(n).join("."),o=s+"=1;domain=."+r+";path=/";t.cookie=o+";max-age=3",t.cookie.includes(s)&&(t.cookie=o+";max-age=0",Vo=r)}return Vo}(e);if(!i){var n=(e=>{var t=e.match(Wo);return t?t[0]:""})(e);n!==i&&Zs.info("Warning: cookie subdomain discovery mismatch",n,i),i=n}return i?"; domain=."+i:""}return""}(ws.location.hostname,n);if(i){var l=new Date;l.setTime(l.getTime()+24*i*60*60*1e3),r="; expires="+l.toUTCString()}s&&(o="; secure");var c=e+"="+encodeURIComponent(JSON.stringify(t))+r+"; SameSite=Lax; path=/"+a+o;return c.length>3686.4&&Zs.warn("cookieStore warning: large cookie, len="+c.length),ws.cookie=c,c}catch(e){return}},_remove:function(e,t){try{Yo._set(e,"",-1,t)}catch(e){return}}},Xo=null,Qo={_is_supported:function(){if(!Ws(Xo))return Xo;var e=!0;if(Us(gs))e=!1;else try{var t="__mplssupport__";Qo._set(t,"xyz"),'"xyz"'!==Qo._get(t)&&(e=!1),Qo._remove(t)}catch(t){e=!1}return e||Zs.error("localStorage unsupported; falling back to cookie store"),Xo=e,e},_error:function(e){Zs.error("localStorage error: "+e)},_get:function(e){try{return null==gs?void 0:gs.localStorage.getItem(e)}catch(e){Qo._error(e)}return null},_parse:function(e){try{return JSON.parse(Qo._get(e))||{}}catch(e){}return null},_set:function(e,t){try{null==gs||gs.localStorage.setItem(e,JSON.stringify(t))}catch(e){Qo._error(e)}},_remove:function(e){try{null==gs||gs.localStorage.removeItem(e)}catch(e){Qo._error(e)}}},Jo=["distinct_id",Fr,Or,Qr,Xr],Ko=ps({},Qo,{_parse:function(e){try{var t={};try{t=Yo._parse(e)||{}}catch(e){}var i=sr(t,JSON.parse(Qo._get(e)||"{}"));return Qo._set(e,i),i}catch(e){}return null},_set:function(e,t,i,n,s,r){try{Qo._set(e,t,void 0,void 0,r);var o={};Jo.forEach(e=>{t[e]&&(o[e]=t[e])}),Object.keys(o).length&&Yo._set(e,o,i,n,s,r)}catch(e){Qo._error(e)}},_remove:function(e,t){try{null==gs||gs.localStorage.removeItem(e),Yo._remove(e,t)}catch(e){Qo._error(e)}}}),Zo={},ea={_is_supported:function(){return!0},_error:function(e){Zs.error("memoryStorage error: "+e)},_get:function(e){return Zo[e]||null},_parse:function(e){return Zo[e]||null},_set:function(e,t){Zo[e]=t},_remove:function(e){delete Zo[e]}},ta=null,ia={_is_supported:function(){if(!Ws(ta))return ta;if(ta=!0,Us(gs))ta=!1;else try{var e="__support__";ia._set(e,"xyz"),'"xyz"'!==ia._get(e)&&(ta=!1),ia._remove(e)}catch(e){ta=!1}return ta},_error:function(e){Zs.error("sessionStorage error: ",e)},_get:function(e){try{return null==gs?void 0:gs.sessionStorage.getItem(e)}catch(e){ia._error(e)}return null},_parse:function(e){try{return JSON.parse(ia._get(e))||null}catch(e){}return null},_set:function(e,t){try{null==gs||gs.sessionStorage.setItem(e,JSON.stringify(t))}catch(e){ia._error(e)}},_remove:function(e){try{null==gs||gs.sessionStorage.removeItem(e)}catch(e){ia._error(e)}}},na=function(e){return e[e.PENDING=-1]="PENDING",e[e.DENIED=0]="DENIED",e[e.GRANTED=1]="GRANTED",e}({});class sa{constructor(e){this._instance=e}get _config(){return this._instance.config}get consent(){return this._getDnt()?na.DENIED:this._storedConsent}isOptedOut(){return this.consent===na.DENIED||this.consent===na.PENDING&&this._config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this._storage._set(this._storageKey,e?1:0,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie)}reset(){this._storage._remove(this._storageKey,this._config.cross_subdomain_cookie)}get _storageKey(){var{token:e,opt_out_capturing_cookie_prefix:t}=this._instance.config;return(t||"__ph_opt_in_out_")+e}get _storedConsent(){var e=this._storage._get(this._storageKey);return"1"===e?na.GRANTED:"0"===e?na.DENIED:na.PENDING}get _storage(){if(!this._persistentStore){var e=this._config.opt_out_capturing_persistence_type;this._persistentStore="localStorage"===e?Qo:Yo;var t="localStorage"===e?Yo:Qo;t._get(this._storageKey)&&(this._persistentStore._get(this._storageKey)||this.optInOut("1"===t._get(this._storageKey)),t._remove(this._storageKey,this._config.cross_subdomain_cookie))}return this._persistentStore}_getDnt(){return!!this._config.respect_dnt&&!!hr([null==bs?void 0:bs.doNotTrack,null==bs?void 0:bs.msDoNotTrack,Es.doNotTrack],e=>Os([!0,1,"1","yes"],e))}}var ra=er("[Dead Clicks]"),oa=()=>!0,aa=e=>{var t,i=!(null==(t=e.instance.persistence)||!t.get_property(xr)),n=e.instance.config.capture_dead_clicks;return Qs(n)?n:i};class la{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(e,t,i){this.instance=e,this.isEnabled=t,this.onCapture=i,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[xr]:null==e?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this._loadScript(()=>{this._start()})}_loadScript(e){var t,i;null!=(t=Es.__PosthogExtensions__)&&t.initDeadClicksAutocapture&&e(),null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this.instance,"dead-clicks-autocapture",t=>{t?ra.error("failed to load script",t):e()})}_start(){var e;if(ws){if(!this._lazyLoadedDeadClicksAutocapture&&null!=(e=Es.__PosthogExtensions__)&&e.initDeadClicksAutocapture){var t=js(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=Es.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this._lazyLoadedDeadClicksAutocapture.start(ws),ra.info("starting...")}}else ra.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,ra.info("stopping..."))}}function ca(e,t,i,n,s){return t>i&&(Zs.warn("min cannot be greater than max."),t=i),Xs(e)?e>i?(n&&Zs.warn(n+" cannot be  greater than max: "+i+". Using max value instead."),i):e<t?(n&&Zs.warn(n+" cannot be less than min: "+t+". Using min value instead."),t):e:(n&&Zs.warn(n+" must be a number. using max or fallback. max: "+i+", fallback: "+s),ca(s||i,t,i,n))}class da{constructor(e){this._buckets={},this._refillBuckets=()=>{Object.keys(this._buckets).forEach(e=>{var t=this._getBucket(e)+this._refillRate;t>=this._bucketSize?delete this._buckets[e]:this._setBucket(e,t)})},this._getBucket=e=>this._buckets[String(e)],this._setBucket=(e,t)=>{this._buckets[String(e)]=t},this.consumeRateLimit=e=>{var t,i=null!==(t=this._getBucket(e))&&void 0!==t?t:this._bucketSize;if(0===(i=Math.max(i-1,0)))return!0;this._setBucket(e,i);var n,s=0===i;return s&&(null==(n=this._onBucketRateLimited)||n.call(this,e)),s},this._options=e,this._onBucketRateLimited=this._options._onBucketRateLimited,this._bucketSize=ca(this._options.bucketSize,0,100,"rate limiter bucket size"),this._refillRate=ca(this._options.refillRate,0,this._bucketSize,"rate limiter refill rate"),this._refillInterval=ca(this._options.refillInterval,0,864e5,"rate limiter refill interval"),setInterval(()=>{this._refillBuckets()},this._refillInterval)}}var ua=er("[ExceptionAutocapture]");class ha{constructor(e){var t,i,n;this._startCapturing=()=>{var e;if(gs&&this.isEnabled&&null!=(e=Es.__PosthogExtensions__)&&e.errorWrappingFunctions){var t=Es.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,i=Es.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,n=Es.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this._unwrapOnError&&this._config.capture_unhandled_errors&&(this._unwrapOnError=t(this.captureException.bind(this))),!this._unwrapUnhandledRejection&&this._config.capture_unhandled_rejections&&(this._unwrapUnhandledRejection=i(this.captureException.bind(this))),!this._unwrapConsoleError&&this._config.capture_console_errors&&(this._unwrapConsoleError=n(this.captureException.bind(this)))}catch(e){ua.error("failed to start",e),this._stopCapturing()}}},this._instance=e,this._remoteEnabled=!(null==(t=this._instance.persistence)||!t.props[yr]),this._config=this._requiredConfig(),this._rateLimiter=new da({refillRate:null!==(i=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)&&void 0!==i?i:1,bucketSize:null!==(n=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)&&void 0!==n?n:10,refillInterval:1e4}),this.startIfEnabled()}_requiredConfig(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return js(e)?t=ps({},t,e):(Us(e)?this._remoteEnabled:e)&&(t=ps({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this._config.capture_console_errors||this._config.capture_unhandled_errors||this._config.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(ua.info("enabled"),this._loadScript(this._startCapturing))}_loadScript(e){var t,i;null!=(t=Es.__PosthogExtensions__)&&t.errorWrappingFunctions&&e(),null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"exception-autocapture",t=>{if(t)return ua.error("failed to load script",t);e()})}_stopCapturing(){var e,t,i;null==(e=this._unwrapOnError)||e.call(this),this._unwrapOnError=void 0,null==(t=this._unwrapUnhandledRejection)||t.call(this),this._unwrapUnhandledRejection=void 0,null==(i=this._unwrapConsoleError)||i.call(this),this._unwrapConsoleError=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this._remoteEnabled=!!t||!1,this._config=this._requiredConfig(),this._instance.persistence&&this._instance.persistence.register({[yr]:this._remoteEnabled}),this.startIfEnabled()}captureException(e){var t,i=this._instance.requestRouter.endpointFor("ui");e.$exception_personURL=i+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id();var n=null!==(t=e.$exception_list[0].type)&&void 0!==t?t:"Exception";this._rateLimiter.consumeRateLimit(n)?ua.info("Skipping exception capture because of client rate limiting.",{exception:e.$exception_list[0].type}):this._instance.exceptions.sendExceptionEvent(e)}}function pa(e){return!Us(Event)&&fa(e,Event)}function fa(e,t){try{return e instanceof t}catch(e){return!1}}function ga(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return fa(e,Error)}}function va(e,t){return Object.prototype.toString.call(e)==="[object "+t+"]"}function _a(e){return va(e,"DOMError")}var ma=/\(error: (.*)\)/,ya="?";function ba(e,t,i,n){var s={platform:"web:javascript",filename:e,function:"<anonymous>"===t?ya:t,in_app:!0};return Us(i)||(s.lineno=i),Us(n)||(s.colno=n),s}var wa=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,xa=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ka=/\((\S*)(?::(\d+))(?::(\d+))\)/,Sa=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Pa=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ta=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return function(e,t){void 0===t&&(t=0);for(var i=[],s=e.split("\n"),r=t;r<s.length;r++){var o=s[r];if(!(o.length>1024)){var a=ma.test(o)?o.replace(ma,"$1"):o;if(!a.match(/\S*Error: /)){for(var l of n){var c=l(a);if(c){i.push(c);break}}if(i.length>=50)break}}}return function(e){if(!e.length)return[];var t=Array.from(e);return t.reverse(),t.slice(0,50).map(e=>ps({},e,{filename:e.filename||Ea(t).filename,function:e.function||ya}))}(i)}}([30,e=>{var t=wa.exec(e);if(t){var[,i,n,s]=t;return ba(i,ya,+n,+s)}var r=xa.exec(e);if(r){if(r[2]&&0===r[2].indexOf("eval")){var o=ka.exec(r[2]);o&&(r[2]=o[1],r[3]=o[2],r[4]=o[3])}var[a,l]=Ra(r[1]||ya,r[2]);return ba(l,a,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}}],[50,e=>{var t=Sa.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var i=Pa.exec(t[3]);i&&(t[1]=t[1]||"eval",t[3]=i[1],t[4]=i[2],t[5]="")}var n=t[3],s=t[1]||ya;return[s,n]=Ra(s,n),ba(n,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]);function Ea(e){return e[e.length-1]||{}}var Ca,Ia,Ma,Ra=(e,t)=>{var i=-1!==e.indexOf("safari-extension"),n=-1!==e.indexOf("safari-web-extension");return i||n?[-1!==e.indexOf("@")?e.split("@")[0]:ya,i?"safari-extension:"+t:"safari-web-extension:"+t]:[e,t]},Fa=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function Oa(e,t){void 0===t&&(t=0);var i=e.stacktrace||e.stack||"",n=function(e){return e&&La.test(e.message)?1:0}(e);try{var s=Ta,r=function(e,t){var i=function(e){var t=globalThis._posthogChunkIds;if(!t)return{};var i=Object.keys(t);return Ma&&i.length===Ia||(Ia=i.length,Ma=i.reduce((i,n)=>{Ca||(Ca={});var s=Ca[n];if(s)i[s[0]]=s[1];else for(var r=e(n),o=r.length-1;o>=0;o--){var a=r[o],l=null==a?void 0:a.filename,c=t[n];if(l&&c){i[l]=c,Ca[n]=[l,c];break}}return i},{})),Ma}(t);return e.forEach(e=>{e.filename&&(e.chunk_id=i[e.filename])}),e}(s(i,n),s);return r.slice(0,r.length-t)}catch(e){}return[]}var La=/Minified React error #\d+;/i;function Da(e,t){var i=function(e,t){var i,n,s=Oa(e),r=null===(i=null==t?void 0:t.handled)||void 0===i||i,o=null!==(n=null==t?void 0:t.synthetic)&&void 0!==n&&n;return{type:null!=t&&t.overrideExceptionType?t.overrideExceptionType:e.name,value:function(e){var t=e.message;return t.error&&"string"==typeof t.error.message?String(t.error.message):String(t)}(e),stacktrace:{frames:s,type:"raw"},mechanism:{handled:r,synthetic:o}}}(e,t);return e.cause&&ga(e.cause)&&e.cause!==e?[i,...Da(e.cause,{handled:null==t?void 0:t.handled,synthetic:null==t?void 0:t.synthetic})]:[i]}function za(e,t){return{$exception_list:Da(e,t),$exception_level:"error"}}function Ga(e,t){var i,n,s,r=null===(i=null==t?void 0:t.handled)||void 0===i||i,o=null===(n=null==t?void 0:t.synthetic)||void 0===n||n,a={type:null!=t&&t.overrideExceptionType?t.overrideExceptionType:null!==(s=null==t?void 0:t.defaultExceptionType)&&void 0!==s?s:"Error",value:e||(null==t?void 0:t.defaultExceptionMessage),mechanism:{handled:r,synthetic:o}};if(null!=t&&t.syntheticException){var l=Oa(t.syntheticException,1);l.length&&(a.stacktrace={frames:l,type:"raw"})}return{$exception_list:[a],$exception_level:"error"}}function Aa(e){return Hs(e)&&!Vs(e)&&Fs.indexOf(e)>=0}function $a(e,t,i){try{if(!(t in e))return()=>{};var n=e[t],s=i(n);return qs(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),e[t]=s,()=>{e[t]=n}}catch(e){return()=>{}}}class Ba{constructor(e){var t;this._instance=e,this._lastPathname=(null==gs||null==(t=gs.location)?void 0:t.pathname)||""}get isEnabled(){return"history_change"===this._instance.config.capture_pageview}startIfEnabled(){this.isEnabled&&(Zs.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this._popstateListener&&this._popstateListener(),this._popstateListener=void 0,Zs.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(gs&&gs.history){var i=this;null!=(e=gs.history.pushState)&&e.__posthog_wrapped__||$a(gs.history,"pushState",e=>function(t,n,s){e.call(this,t,n,s),i._capturePageview("pushState")}),null!=(t=gs.history.replaceState)&&t.__posthog_wrapped__||$a(gs.history,"replaceState",e=>function(t,n,s){e.call(this,t,n,s),i._capturePageview("replaceState")}),this._setupPopstateListener()}}_capturePageview(e){try{var t,i=null==gs||null==(t=gs.location)?void 0:t.pathname;if(!i)return;i!==this._lastPathname&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this._lastPathname=i}catch(t){Zs.error("Error capturing "+e+" pageview",t)}}_setupPopstateListener(){if(!this._popstateListener){var e=()=>{this._capturePageview("popstate")};pr(gs,"popstate",e),this._popstateListener=()=>{gs&&gs.removeEventListener("popstate",e)}}}}function qa(e){var t,i;return(null==(t=JSON.stringify(e,(i=[],function(e,t){if(js(t)){for(;i.length>0&&i[i.length-1]!==this;)i.pop();return i.includes(t)?"[Circular]":(i.push(t),t)}return t})))?void 0:t.length)||0}function ja(e,t){if(void 0===t&&(t=6606028.8),e.size>=t&&e.data.length>1){var i=Math.floor(e.data.length/2),n=e.data.slice(0,i),s=e.data.slice(i);return[ja({size:qa(n),data:n,sessionId:e.sessionId,windowId:e.windowId}),ja({size:qa(s),data:s,sessionId:e.sessionId,windowId:e.windowId})].flatMap(e=>e)}return[e]}var Na=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Na||{}),Ua=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Ua||{}),Ha="[SessionRecording]",Va="redacted",Wa={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:e=>e,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},Ya=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],Xa=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],Qa=["/s/","/e/","/i/"];function Ja(e,t,i,n){if(Ys(e))return e;var s=(null==t?void 0:t["content-length"])||function(e){return new Blob([e]).size}(e);return Hs(s)&&(s=parseInt(s)),s>i?Ha+" "+n+" body too large to record ("+s+" bytes)":e}function Ka(e,t){if(Ys(e))return e;var i=e;return xo(i,!1)||(i=Ha+" "+t+" body "+Va),nr(Xa,e=>{var n,s;null!=(n=i)&&n.length&&-1!==(null==(s=i)?void 0:s.indexOf(e))&&(i=Ha+" "+t+" body "+Va+" as might contain: "+e)}),i}var Za=(e,t)=>{var i,n,s,r={payloadSizeLimitBytes:Wa.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...Wa.performanceEntryTypeToObserve],payloadHostDenyList:[...t.payloadHostDenyList||[],...Wa.payloadHostDenyList]},o=!1!==e.session_recording.recordHeaders&&t.recordHeaders,a=!1!==e.session_recording.recordBody&&t.recordBody,l=!1!==e.capture_performance&&t.recordPerformance,c=(i=r,s=Math.min(1e6,null!==(n=i.payloadSizeLimitBytes)&&void 0!==n?n:1e6),e=>(null!=e&&e.requestBody&&(e.requestBody=Ja(e.requestBody,e.requestHeaders,s,"Request")),null!=e&&e.responseBody&&(e.responseBody=Ja(e.responseBody,e.responseHeaders,s,"Response")),e)),d=t=>{return c(((e,t)=>{var i,n=Mo(e.name),s=0===t.indexOf("http")?null==(i=Mo(t))?void 0:i.pathname:t;"/"===s&&(s="");var r=null==n?void 0:n.pathname.replace(s||"","");if(!(n&&r&&Qa.some(e=>0===r.indexOf(e))))return e})((n=(i=t).requestHeaders,Ys(n)||nr(Object.keys(null!=n?n:{}),e=>{Ya.includes(e.toLowerCase())&&(n[e]=Va)}),i),e.api_host));var i,n},u=qs(e.session_recording.maskNetworkRequestFn);return u&&qs(e.session_recording.maskCapturedNetworkRequestFn)&&Zs.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),u&&(e.session_recording.maskCapturedNetworkRequestFn=t=>{var i=e.session_recording.maskNetworkRequestFn({url:t.name});return ps({},t,{name:null==i?void 0:i.url})}),r.maskRequestFn=qs(e.session_recording.maskCapturedNetworkRequestFn)?t=>{var i,n=d(t);return n&&null!==(i=null==e.session_recording.maskCapturedNetworkRequestFn?void 0:e.session_recording.maskCapturedNetworkRequestFn(n))&&void 0!==i?i:void 0}:e=>function(e){if(!Us(e))return e.requestBody=Ka(e.requestBody,"Request"),e.responseBody=Ka(e.responseBody,"Response"),e}(d(e)),ps({},Wa,r,{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})};class el{constructor(e,t){var i,n;void 0===t&&(t={}),this._loggedTracker={},this._onNodeRateLimited=e=>{if(!this._loggedTracker[e]){var t,i;this._loggedTracker[e]=!0;var n=this._getNode(e);null==(t=(i=this._options).onBlockedNode)||t.call(i,e,n)}},this._getNodeOrRelevantParent=e=>{var t=this._getNode(e);if("svg"!==(null==t?void 0:t.nodeName)&&t instanceof Element){var i=t.closest("svg");if(i)return[this._rrweb.mirror.getId(i),i]}return[e,t]},this._getNode=e=>this._rrweb.mirror.getNode(e),this._numberOfChanges=e=>{var t,i,n,s,r,o,a,l;return(null!==(t=null==(i=e.removes)?void 0:i.length)&&void 0!==t?t:0)+(null!==(n=null==(s=e.attributes)?void 0:s.length)&&void 0!==n?n:0)+(null!==(r=null==(o=e.texts)?void 0:o.length)&&void 0!==r?r:0)+(null!==(a=null==(l=e.adds)?void 0:l.length)&&void 0!==a?a:0)},this.throttleMutations=e=>{if(3!==e.type||0!==e.data.source)return e;var t=e.data,i=this._numberOfChanges(t);t.attributes&&(t.attributes=t.attributes.filter(e=>{var[t]=this._getNodeOrRelevantParent(e.id);return!this._rateLimiter.consumeRateLimit(t)&&e}));var n=this._numberOfChanges(t);return 0!==n||i===n?e:void 0},this._rrweb=e,this._options=t,this._rateLimiter=new da({bucketSize:null!==(i=this._options.bucketSize)&&void 0!==i?i:100,refillRate:null!==(n=this._options.refillRate)&&void 0!==n?n:10,refillInterval:1e3,_onBucketRateLimited:this._onNodeRateLimited})}}var tl=Uint8Array,il=Uint16Array,nl=Uint32Array,sl=new tl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rl=new tl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ol=new tl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),al=function(e,t){for(var i=new il(31),n=0;n<31;++n)i[n]=t+=1<<e[n-1];var s=new nl(i[30]);for(n=1;n<30;++n)for(var r=i[n];r<i[n+1];++r)s[r]=r-i[n]<<5|n;return[i,s]},ll=al(sl,2),cl=ll[0],dl=ll[1];cl[28]=258,dl[258]=28;for(var ul=al(rl,0)[1],hl=new il(32768),pl=0;pl<32768;++pl){var fl=(43690&pl)>>>1|(21845&pl)<<1;fl=(61680&(fl=(52428&fl)>>>2|(13107&fl)<<2))>>>4|(3855&fl)<<4,hl[pl]=((65280&fl)>>>8|(255&fl)<<8)>>>1}var gl=function(e,t,i){for(var n=e.length,s=0,r=new il(t);s<n;++s)++r[e[s]-1];var o,a=new il(t);for(s=0;s<t;++s)a[s]=a[s-1]+r[s-1]<<1;if(i){o=new il(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var c=s<<4|e[s],d=t-e[s],u=a[e[s]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)o[hl[u]>>>l]=c}else for(o=new il(n),s=0;s<n;++s)o[s]=hl[a[e[s]-1]++]>>>15-e[s];return o},vl=new tl(288);for(pl=0;pl<144;++pl)vl[pl]=8;for(pl=144;pl<256;++pl)vl[pl]=9;for(pl=256;pl<280;++pl)vl[pl]=7;for(pl=280;pl<288;++pl)vl[pl]=8;var _l=new tl(32);for(pl=0;pl<32;++pl)_l[pl]=5;var ml=gl(vl,9,0),yl=gl(_l,5,0),bl=function(e){return(e/8|0)+(7&e&&1)},wl=function(e,t,i){(null==i||i>e.length)&&(i=e.length);var n=new(e instanceof il?il:e instanceof nl?nl:tl)(i-t);return n.set(e.subarray(t,i)),n},xl=function(e,t,i){i<<=7&t;var n=t/8|0;e[n]|=i,e[n+1]|=i>>>8},kl=function(e,t,i){i<<=7&t;var n=t/8|0;e[n]|=i,e[n+1]|=i>>>8,e[n+2]|=i>>>16},Sl=function(e,t){for(var i=[],n=0;n<e.length;++n)e[n]&&i.push({s:n,f:e[n]});var s=i.length,r=i.slice();if(!s)return[new tl(0),0];if(1==s){var o=new tl(i[0].s+1);return o[i[0].s]=1,[o,1]}i.sort(function(e,t){return e.f-t.f}),i.push({s:-1,f:25001});var a=i[0],l=i[1],c=0,d=1,u=2;for(i[0]={s:-1,f:a.f+l.f,l:a,r:l};d!=s-1;)a=i[i[c].f<i[u].f?c++:u++],l=i[c!=d&&i[c].f<i[u].f?c++:u++],i[d++]={s:-1,f:a.f+l.f,l:a,r:l};var h=r[0].s;for(n=1;n<s;++n)r[n].s>h&&(h=r[n].s);var p=new il(h+1),f=Pl(i[d-1],p,0);if(f>t){n=0;var g=0,v=f-t,_=1<<v;for(r.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});n<s;++n){var m=r[n].s;if(!(p[m]>t))break;g+=_-(1<<f-p[m]),p[m]=t}for(g>>>=v;g>0;){var y=r[n].s;p[y]<t?g-=1<<t-p[y]++-1:++n}for(;n>=0&&g;--n){var b=r[n].s;p[b]==t&&(--p[b],++g)}f=t}return[new tl(p),f]},Pl=function(e,t,i){return-1==e.s?Math.max(Pl(e.l,t,i+1),Pl(e.r,t,i+1)):t[e.s]=i},Tl=function(e){for(var t=e.length;t&&!e[--t];);for(var i=new il(++t),n=0,s=e[0],r=1,o=function(e){i[n++]=e},a=1;a<=t;++a)if(e[a]==s&&a!=t)++r;else{if(!s&&r>2){for(;r>138;r-=138)o(32754);r>2&&(o(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(o(s),--r;r>6;r-=6)o(8304);r>2&&(o(r-3<<5|8208),r=0)}for(;r--;)o(s);r=1,s=e[a]}return[i.subarray(0,n),t]},El=function(e,t){for(var i=0,n=0;n<t.length;++n)i+=e[n]*t[n];return i},Cl=function(e,t,i){var n=i.length,s=bl(t+2);e[s]=255&n,e[s+1]=n>>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var r=0;r<n;++r)e[s+r+4]=i[r];return 8*(s+4+n)},Il=function(e,t,i,n,s,r,o,a,l,c,d){xl(t,d++,i),++s[256];for(var u=Sl(s,15),h=u[0],p=u[1],f=Sl(r,15),g=f[0],v=f[1],_=Tl(h),m=_[0],y=_[1],b=Tl(g),w=b[0],x=b[1],k=new il(19),S=0;S<m.length;++S)k[31&m[S]]++;for(S=0;S<w.length;++S)k[31&w[S]]++;for(var P=Sl(k,7),T=P[0],E=P[1],C=19;C>4&&!T[ol[C-1]];--C);var I,M,R,F,O=c+5<<3,L=El(s,vl)+El(r,_l)+o,D=El(s,h)+El(r,g)+o+14+3*C+El(k,T)+(2*k[16]+3*k[17]+7*k[18]);if(O<=L&&O<=D)return Cl(t,d,e.subarray(l,l+c));if(xl(t,d,1+(D<L)),d+=2,D<L){I=gl(h,p,0),M=h,R=gl(g,v,0),F=g;var z=gl(T,E,0);for(xl(t,d,y-257),xl(t,d+5,x-1),xl(t,d+10,C-4),d+=14,S=0;S<C;++S)xl(t,d+3*S,T[ol[S]]);d+=3*C;for(var G=[m,w],A=0;A<2;++A){var $=G[A];for(S=0;S<$.length;++S){var B=31&$[S];xl(t,d,z[B]),d+=T[B],B>15&&(xl(t,d,$[S]>>>5&127),d+=$[S]>>>12)}}}else I=ml,M=vl,R=yl,F=_l;for(S=0;S<a;++S)if(n[S]>255){B=n[S]>>>18&31,kl(t,d,I[B+257]),d+=M[B+257],B>7&&(xl(t,d,n[S]>>>23&31),d+=sl[B]);var q=31&n[S];kl(t,d,R[q]),d+=F[q],q>3&&(kl(t,d,n[S]>>>5&8191),d+=rl[q])}else kl(t,d,I[n[S]]),d+=M[n[S]];return kl(t,d,I[256]),d+M[256]},Ml=new nl([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Rl=function(){for(var e=new nl(256),t=0;t<256;++t){for(var i=t,n=9;--n;)i=(1&i&&3988292384)^i>>>1;e[t]=i}return e}(),Fl=function(e,t,i){for(;i;++t)e[t]=i,i>>>=8};function Ol(e,t){void 0===t&&(t={});var i=function(){var e=4294967295;return{p:function(t){for(var i=e,n=0;n<t.length;++n)i=Rl[255&i^t[n]]^i>>>8;e=i},d:function(){return 4294967295^e}}}(),n=e.length;i.p(e);var s=function(e,t,i){return function(e,t,i,n,s,r){var o=e.length,a=new tl(n+o+5*(1+Math.floor(o/7e3))+8),l=a.subarray(n,a.length-8),c=0;if(!t||o<8)for(var d=0;d<=o;d+=65535){var u=d+65535;u<o?c=Cl(l,c,e.subarray(d,u)):(l[d]=r,c=Cl(l,c,e.subarray(d,o)))}else{for(var h=Ml[t-1],p=h>>>13,f=8191&h,g=(1<<i)-1,v=new il(32768),_=new il(g+1),m=Math.ceil(i/3),y=2*m,b=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<y)&g},w=new nl(25e3),x=new il(288),k=new il(32),S=0,P=0,T=(d=0,0),E=0,C=0;d<o;++d){var I=b(d),M=32767&d,R=_[I];if(v[M]=R,_[I]=M,E<=d){var F=o-d;if((S>7e3||T>24576)&&F>423){c=Il(e,l,0,w,x,k,P,T,C,d-C,c),T=S=P=0,C=d;for(var O=0;O<286;++O)x[O]=0;for(O=0;O<30;++O)k[O]=0}var L=2,D=0,z=f,G=M-R&32767;if(F>2&&I==b(d-G))for(var A=Math.min(p,F)-1,$=Math.min(32767,d),B=Math.min(258,F);G<=$&&--z&&M!=R;){if(e[d+L]==e[d+L-G]){for(var q=0;q<B&&e[d+q]==e[d+q-G];++q);if(q>L){if(L=q,D=G,q>A)break;var j=Math.min(G,q-2),N=0;for(O=0;O<j;++O){var U=d-G+O+32768&32767,H=U-v[U]+32768&32767;H>N&&(N=H,R=U)}}}G+=(M=R)-(R=v[M])+32768&32767}if(D){w[T++]=268435456|dl[L]<<18|ul[D];var V=31&dl[L],W=31&ul[D];P+=sl[V]+rl[W],++x[257+V],++k[W],E=d+L,++S}else w[T++]=e[d],++x[e[d]]}}c=Il(e,l,r,w,x,k,P,T,C,d-C,c)}return wl(a,0,n+bl(c)+8)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,i,0,!0)}(e,t,function(e){return 10+(e.filename&&e.filename.length+1||0)}(t)),r=s.length;return function(e,t){var i=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Fl(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),i){e[3]=8;for(var n=0;n<=i.length;++n)e[n+10]=i.charCodeAt(n)}}(s,t),Fl(s,r-8,i.d()),Fl(s,r-4,n),s}function Ll(e,t){var i=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var n=new tl(e.length+(e.length>>>1)),s=0,r=function(e){n[s++]=e},o=0;o<i;++o){if(s+5>n.length){var a=new tl(s+8+(i-o<<1));a.set(n),n=a}var l=e.charCodeAt(o);l<128||t?r(l):l<2048?(r(192|l>>>6),r(128|63&l)):l>55295&&l<57344?(r(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++o))>>>18),r(128|l>>>12&63),r(128|l>>>6&63),r(128|63&l)):(r(224|l>>>12),r(128|l>>>6&63),r(128|63&l))}return wl(n,0,s)}var Dl="disabled",zl="sampled",Gl="active",Al="buffering",$l="paused",Bl="trigger",ql=Bl+"_activated",jl=Bl+"_pending",Nl=Bl+"_"+Dl;function Ul(e,t){return t.some(t=>"regex"===t.matching&&new RegExp(t.url).test(e))}class Hl{constructor(e){this._matchers=e}triggerStatus(e){var t=this._matchers.map(t=>t.triggerStatus(e));return t.includes(ql)?ql:t.includes(jl)?jl:Nl}stop(){this._matchers.forEach(e=>e.stop())}}class Vl{constructor(e){this._matchers=e}triggerStatus(e){var t=new Set;for(var i of this._matchers)t.add(i.triggerStatus(e));switch(t.delete(Nl),t.size){case 0:return Nl;case 1:return Array.from(t)[0];default:return jl}}stop(){this._matchers.forEach(e=>e.stop())}}class Wl{triggerStatus(){return jl}stop(){}}class Yl{constructor(e){this._urlTriggers=[],this._urlBlocklist=[],this.urlBlocked=!1,this._instance=e}onRemoteConfig(e){var t,i;this._urlTriggers=(null==(t=e.sessionRecording)?void 0:t.urlTriggers)||[],this._urlBlocklist=(null==(i=e.sessionRecording)?void 0:i.urlBlocklist)||[]}_urlTriggerStatus(e){var t;return 0===this._urlTriggers.length?Nl:(null==(t=this._instance)?void 0:t.get_property(Lr))===e?ql:jl}triggerStatus(e){var t=this._urlTriggerStatus(e),i=t===ql?ql:t===jl?jl:Nl;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:i}),i}checkUrlTriggerConditions(e,t,i){if(void 0!==gs&&gs.location.href){var n=gs.location.href,s=this.urlBlocked,r=Ul(n,this._urlBlocklist);s&&r||(r&&!s?e():!r&&s&&t(),Ul(n,this._urlTriggers)&&i("url"))}}stop(){}}class Xl{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this._flaglistenerCleanup=()=>{},this._instance=e}triggerStatus(){var e=jl;return Ys(this.linkedFlag)&&(e=Nl),this.linkedFlagSeen&&(e=ql),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onRemoteConfig(e,t){var i;if(this.linkedFlag=(null==(i=e.sessionRecording)?void 0:i.linkedFlag)||null,!Ys(this.linkedFlag)&&!this.linkedFlagSeen){var n=Hs(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,s=Hs(this.linkedFlag)?null:this.linkedFlag.variant;this._flaglistenerCleanup=this._instance.onFeatureFlags((e,i)=>{var r=!1;if(js(i)&&n in i){var o=i[n];r=Qs(o)?!0===o:s?o===s:!!o}this.linkedFlagSeen=r,r&&t(n,s)})}}stop(){this._flaglistenerCleanup()}}class Ql{constructor(e){this._eventTriggers=[],this._instance=e}onRemoteConfig(e){var t;this._eventTriggers=(null==(t=e.sessionRecording)?void 0:t.eventTriggers)||[]}_eventTriggerStatus(e){var t;return 0===this._eventTriggers.length?Nl:(null==(t=this._instance)?void 0:t.get_property(Dr))===e?ql:jl}triggerStatus(e){var t=this._eventTriggerStatus(e),i=t===ql?ql:t===jl?jl:Nl;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:i}),i}stop(){}}function Jl(e){return e.isRecordingEnabled?Al:Dl}function Kl(e){if(!e.receivedFlags)return Al;if(!e.isRecordingEnabled)return Dl;if(e.urlTriggerMatching.urlBlocked)return $l;var t=!0===e.isSampled,i=new Hl([e.eventTriggerMatching,e.urlTriggerMatching,e.linkedFlagMatching]).triggerStatus(e.sessionId);return t?zl:i===ql?Gl:i===jl?Al:!1===e.isSampled?Dl:Gl}function Zl(e){if(!e.receivedFlags)return Al;if(!e.isRecordingEnabled)return Dl;if(e.urlTriggerMatching.urlBlocked)return $l;var t=new Vl([e.eventTriggerMatching,e.urlTriggerMatching,e.linkedFlagMatching]).triggerStatus(e.sessionId),i=t!==Nl,n=Qs(e.isSampled);return i&&t===jl?Al:i&&t===Nl||n&&!e.isSampled?Dl:!0===e.isSampled?zl:Gl}var ec="[SessionRecording]",tc=er(ec);function ic(){var e;return null==Es||null==(e=Es.__PosthogExtensions__)||null==(e=e.rrweb)?void 0:e.record}var nc=[Ua.MouseMove,Ua.MouseInteraction,Ua.Scroll,Ua.ViewportResize,Ua.Input,Ua.TouchMove,Ua.MediaInteraction,Ua.Drag],sc=e=>({rrwebMethod:e,enqueuedAt:Date.now(),attempt:1});function rc(e){return function(e){for(var t="",i=0;i<e.length;){var n=e[i++];t+=String.fromCharCode(n)}return t}(Ol(Ll(JSON.stringify(e))))}function oc(e){return e.type===Na.Custom&&"sessionIdle"===e.data.tag}class ac{get sessionId(){return this._sessionId}get _sessionIdleThresholdMilliseconds(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this._captureStarted}get _sessionManager(){if(!this._instance.sessionManager)throw new Error(ec+" must be started with a valid sessionManager.");return this._instance.sessionManager}get _fullSnapshotIntervalMillis(){var e,t;return this._triggerMatching.triggerStatus(this.sessionId)===jl?6e4:null!==(e=null==(t=this._instance.config.session_recording)?void 0:t.full_snapshot_interval_millis)&&void 0!==e?e:3e5}get _isSampled(){var e=this._instance.get_property(Or);return Qs(e)?e:null}get _sessionDuration(){var e,t,i=null==(e=this._buffer)?void 0:e.data[(null==(t=this._buffer)?void 0:t.data.length)-1],{sessionStartTimestamp:n}=this._sessionManager.checkAndGetSessionAndWindowId(!0);return i?i.timestamp-n:null}get _isRecordingEnabled(){var e=!!this._instance.get_property(Sr),t=!this._instance.config.disable_session_recording;return gs&&e&&t}get _isConsoleLogCaptureEnabled(){var e=!!this._instance.get_property(Pr),t=this._instance.config.enable_recording_console_log;return null!=t?t:e}get _canvasRecording(){var e,t,i,n,s,r,o=this._instance.config.session_recording.captureCanvas,a=this._instance.get_property(Cr),l=null!==(e=null!==(t=null==o?void 0:o.recordCanvas)&&void 0!==t?t:null==a?void 0:a.enabled)&&void 0!==e&&e,c=null!==(i=null!==(n=null==o?void 0:o.canvasFps)&&void 0!==n?n:null==a?void 0:a.fps)&&void 0!==i?i:4,d=null!==(s=null!==(r=null==o?void 0:o.canvasQuality)&&void 0!==r?r:null==a?void 0:a.quality)&&void 0!==s?s:.4;if("string"==typeof d){var u=parseFloat(d);d=isNaN(u)?.4:u}return{enabled:l,fps:ca(c,0,12,"canvas recording fps",4),quality:ca(d,0,1,"canvas recording quality",.4)}}get _networkPayloadCapture(){var e,t,i=this._instance.get_property(Tr),n={recordHeaders:null==(e=this._instance.config.session_recording)?void 0:e.recordHeaders,recordBody:null==(t=this._instance.config.session_recording)?void 0:t.recordBody},s=(null==n?void 0:n.recordHeaders)||(null==i?void 0:i.recordHeaders),r=(null==n?void 0:n.recordBody)||(null==i?void 0:i.recordBody),o=js(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,a=!!(Qs(o)?o:null==i?void 0:i.capturePerformance);return s||r||a?{recordHeaders:s,recordBody:r,recordPerformance:a}:void 0}get _masking(){var e,t,i,n,s,r,o=this._instance.get_property(Er),a={maskAllInputs:null==(e=this._instance.config.session_recording)?void 0:e.maskAllInputs,maskTextSelector:null==(t=this._instance.config.session_recording)?void 0:t.maskTextSelector,blockSelector:null==(i=this._instance.config.session_recording)?void 0:i.blockSelector},l=null!==(n=null==a?void 0:a.maskAllInputs)&&void 0!==n?n:null==o?void 0:o.maskAllInputs,c=null!==(s=null==a?void 0:a.maskTextSelector)&&void 0!==s?s:null==o?void 0:o.maskTextSelector,d=null!==(r=null==a?void 0:a.blockSelector)&&void 0!==r?r:null==o?void 0:o.blockSelector;return Us(l)&&Us(c)&&Us(d)?void 0:{maskAllInputs:null==l||l,maskTextSelector:c,blockSelector:d}}get _sampleRate(){var e=this._instance.get_property(Ir);return Xs(e)?e:null}get _minimumDuration(){var e=this._instance.get_property(Mr);return Xs(e)?e:null}get status(){return this._receivedFlags?this._statusMatcher({receivedFlags:this._receivedFlags,isRecordingEnabled:this._isRecordingEnabled,isSampled:this._isSampled,urlTriggerMatching:this._urlTriggerMatching,eventTriggerMatching:this._eventTriggerMatching,linkedFlagMatching:this._linkedFlagMatching,sessionId:this.sessionId}):Al}constructor(e){if(this._statusMatcher=Jl,this._receivedFlags=!1,this._queuedRRWebEvents=[],this._isIdle="unknown",this._lastActivityTimestamp=Date.now(),this._triggerMatching=new Wl,this._removePageViewCaptureHook=void 0,this._onSessionIdListener=void 0,this._persistFlagsOnSessionListener=void 0,this._samplingSessionListener=void 0,this._removeEventTriggerCaptureHook=void 0,this._forceAllowLocalhostNetworkCapture=!1,this._onBeforeUnload=()=>{this._flushBuffer()},this._onOffline=()=>{this._tryAddCustomEvent("browser offline",{})},this._onOnline=()=>{this._tryAddCustomEvent("browser online",{})},this._onVisibilityChange=()=>{if(null!=ws&&ws.visibilityState){var e="window "+ws.visibilityState;this._tryAddCustomEvent(e,{})}},this._instance=e,this._captureStarted=!1,this._endpoint="/s/",this._stopRrweb=void 0,this._receivedFlags=!1,!this._instance.sessionManager)throw tc.error("started without valid sessionManager"),new Error(ec+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw new Error(ec+" cannot be used with __preview_experimental_cookieless_mode.");this._linkedFlagMatching=new Xl(this._instance),this._urlTriggerMatching=new Yl(this._instance),this._eventTriggerMatching=new Ql(this._instance);var{sessionId:t,windowId:i}=this._sessionManager.checkAndGetSessionAndWindowId();this._sessionId=t,this._windowId=i,this._buffer=this._clearBuffer(),this._sessionIdleThresholdMilliseconds>=this._sessionManager.sessionTimeoutMs&&tc.warn("session_idle_threshold_ms ("+this._sessionIdleThresholdMilliseconds+") is greater than the session timeout ("+this._sessionManager.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this._isRecordingEnabled?(this._startCapture(e),pr(gs,"beforeunload",this._onBeforeUnload),pr(gs,"offline",this._onOffline),pr(gs,"online",this._onOnline),pr(gs,"visibilitychange",this._onVisibilityChange),this._setupSampling(),this._addEventTriggerListener(),Ys(this._removePageViewCaptureHook)&&(this._removePageViewCaptureHook=this._instance.on("eventCaptured",e=>{try{if("$pageview"===e.event){var t=null!=e&&e.properties.$current_url?this._maskUrl(null==e?void 0:e.properties.$current_url):"";if(!t)return;this._tryAddCustomEvent("$pageview",{href:t})}}catch(e){tc.error("Could not add $pageview to rrweb session",e)}})),this._onSessionIdListener||(this._onSessionIdListener=this._sessionManager.onSessionId((e,t,i)=>{var n,s;i&&(this._tryAddCustomEvent("$session_id_change",{sessionId:e,windowId:t,changeReason:i}),null==(n=this._instance)||null==(n=n.persistence)||n.unregister(Dr),null==(s=this._instance)||null==(s=s.persistence)||s.unregister(Lr))}))):this.stopRecording()}stopRecording(){var e,t,i,n;this._captureStarted&&this._stopRrweb&&(this._stopRrweb(),this._stopRrweb=void 0,this._captureStarted=!1,null==gs||gs.removeEventListener("beforeunload",this._onBeforeUnload),null==gs||gs.removeEventListener("offline",this._onOffline),null==gs||gs.removeEventListener("online",this._onOnline),null==gs||gs.removeEventListener("visibilitychange",this._onVisibilityChange),this._clearBuffer(),clearInterval(this._fullSnapshotTimer),null==(e=this._removePageViewCaptureHook)||e.call(this),this._removePageViewCaptureHook=void 0,null==(t=this._removeEventTriggerCaptureHook)||t.call(this),this._removeEventTriggerCaptureHook=void 0,null==(i=this._onSessionIdListener)||i.call(this),this._onSessionIdListener=void 0,null==(n=this._samplingSessionListener)||n.call(this),this._samplingSessionListener=void 0,this._eventTriggerMatching.stop(),this._urlTriggerMatching.stop(),this._linkedFlagMatching.stop(),tc.info("stopped"))}_resetSampling(){var e;null==(e=this._instance.persistence)||e.unregister(Or)}_makeSamplingDecision(e){var t,i=this._sessionId!==e,n=this._sampleRate;if(Xs(n)){var s=this._isSampled,r=i||!Qs(s),o=r?function(e,t){return function(e){for(var t=0,i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return Math.abs(t)}(e)%100<ca(100*t,0,100)}(e,n):s;r&&(o?this._reportStarted(zl):tc.warn("Sample rate ("+n+") has determined that this sessionId ("+e+") will not be sent to the server."),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:n,isSampled:o})),null==(t=this._instance.persistence)||t.register({[Or]:o})}else this._resetSampling()}onRemoteConfig(e){var t,i,n,s;this._tryAddCustomEvent("$remote_config_received",e),this._persistRemoteConfig(e),null!=(t=e.sessionRecording)&&t.endpoint&&(this._endpoint=null==(s=e.sessionRecording)?void 0:s.endpoint),this._setupSampling(),"any"===(null==(i=e.sessionRecording)?void 0:i.triggerMatchType)?(this._statusMatcher=Kl,this._triggerMatching=new Hl([this._eventTriggerMatching,this._urlTriggerMatching])):(this._statusMatcher=Zl,this._triggerMatching=new Vl([this._eventTriggerMatching,this._urlTriggerMatching])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:null==(n=e.sessionRecording)?void 0:n.triggerMatchType}),this._urlTriggerMatching.onRemoteConfig(e),this._eventTriggerMatching.onRemoteConfig(e),this._linkedFlagMatching.onRemoteConfig(e,(e,t)=>{this._reportStarted("linked_flag_matched",{flag:e,variant:t})}),this._receivedFlags=!0,this.startIfEnabledOrStop()}_setupSampling(){Xs(this._sampleRate)&&Ys(this._samplingSessionListener)&&(this._samplingSessionListener=this._sessionManager.onSessionId(e=>{this._makeSamplingDecision(e)}))}_persistRemoteConfig(e){if(this._instance.persistence){var t,i=this._instance.persistence,n=()=>{var t,n,s,r,o,a,l,c,d,u=null==(t=e.sessionRecording)?void 0:t.sampleRate,h=Ys(u)?null:parseFloat(u);Ys(h)&&this._resetSampling();var p=null==(n=e.sessionRecording)?void 0:n.minimumDurationMilliseconds;i.register({[Sr]:!!e.sessionRecording,[Pr]:null==(s=e.sessionRecording)?void 0:s.consoleLogRecordingEnabled,[Tr]:ps({capturePerformance:e.capturePerformance},null==(r=e.sessionRecording)?void 0:r.networkPayloadCapture),[Er]:null==(o=e.sessionRecording)?void 0:o.masking,[Cr]:{enabled:null==(a=e.sessionRecording)?void 0:a.recordCanvas,fps:null==(l=e.sessionRecording)?void 0:l.canvasFps,quality:null==(c=e.sessionRecording)?void 0:c.canvasQuality},[Ir]:h,[Mr]:Us(p)?null:p,[Rr]:null==(d=e.sessionRecording)?void 0:d.scriptConfig})};n(),null==(t=this._persistFlagsOnSessionListener)||t.call(this),this._persistFlagsOnSessionListener=this._sessionManager.onSessionId(n)}}log(e,t){var i;void 0===t&&(t="log"),null==(i=this._instance.sessionRecording)||i.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:t,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}_startCapture(e){var t;Us(Object.assign)||Us(Array.from)||this._captureStarted||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut()||(this._captureStarted=!0,this._sessionManager.checkAndGetSessionAndWindowId(),ic()?this._onScriptLoaded():null==(t=Es.__PosthogExtensions__)||null==t.loadExternalDependency||t.loadExternalDependency(this._instance,this._scriptName,e=>{if(e)return tc.error("could not load recorder",e);this._onScriptLoaded()}),tc.info("starting"),this.status===Gl&&this._reportStarted(e||"recording_initialized"))}get _scriptName(){var e;return(null==(e=this._instance)||null==(e=e.persistence)||null==(e=e.get_property(Rr))?void 0:e.script)||"recorder"}_isInteractiveEvent(e){var t;return 3===e.type&&-1!==nc.indexOf(null==(t=e.data)?void 0:t.source)}_updateWindowAndSessionIds(e){var t=this._isInteractiveEvent(e);t||this._isIdle||e.timestamp-this._lastActivityTimestamp>this._sessionIdleThresholdMilliseconds&&(this._isIdle=!0,clearInterval(this._fullSnapshotTimer),this._tryAddCustomEvent("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this._lastActivityTimestamp,threshold:this._sessionIdleThresholdMilliseconds,bufferLength:this._buffer.data.length,bufferSize:this._buffer.size}),this._flushBuffer());var i=!1;if(t&&(this._lastActivityTimestamp=e.timestamp,this._isIdle)){var n="unknown"===this._isIdle;this._isIdle=!1,n||(this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)}if(!this._isIdle){var{windowId:s,sessionId:r}=this._sessionManager.checkAndGetSessionAndWindowId(!t,e.timestamp),o=this._sessionId!==r,a=this._windowId!==s;this._windowId=s,this._sessionId=r,o||a?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):i&&this._scheduleFullSnapshot()}}_tryRRWebMethod(e){try{return e.rrwebMethod(),!0}catch(t){return this._queuedRRWebEvents.length<10?this._queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):tc.warn("could not emit queued rrweb event.",t,e),!1}}_tryAddCustomEvent(e,t){return this._tryRRWebMethod(sc(()=>ic().addCustomEvent(e,t)))}_tryTakeFullSnapshot(){return this._tryRRWebMethod(sc(()=>ic().takeFullSnapshot()))}_onScriptLoaded(){var e,t,i,n,s={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},r=this._instance.config.session_recording;for(var[o,a]of Object.entries(r||{}))o in s&&("maskInputOptions"===o?s.maskInputOptions=ps({password:!0},a):s[o]=a);this._canvasRecording&&this._canvasRecording.enabled&&(s.recordCanvas=!0,s.sampling={canvas:this._canvasRecording.fps},s.dataURLOptions={type:"image/webp",quality:this._canvasRecording.quality}),this._masking&&(s.maskAllInputs=null===(t=this._masking.maskAllInputs)||void 0===t||t,s.maskTextSelector=null!==(i=this._masking.maskTextSelector)&&void 0!==i?i:void 0,s.blockSelector=null!==(n=this._masking.blockSelector)&&void 0!==n?n:void 0);var l=ic();if(l){this._mutationThrottler=null!==(e=this._mutationThrottler)&&void 0!==e?e:new el(l,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(e,t)=>{var i="Too many mutations on node '"+e+"'. Rate limiting. This could be due to SVG animations or something similar";tc.info(i,{node:t}),this.log(ec+" "+i,"warn")}});var c=this._gatherRRWebPlugins();this._stopRrweb=l(ps({emit:e=>{this.onRRwebEmit(e)},plugins:c},s)),this._lastActivityTimestamp=Date.now(),this._isIdle=Qs(this._isIdle)?this._isIdle:"unknown",this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:s,activePlugins:c.map(e=>null==e?void 0:e.name)}),this._tryAddCustomEvent("$posthog_config",{config:this._instance.config})}else tc.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}_scheduleFullSnapshot(){if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!0!==this._isIdle){var e=this._fullSnapshotIntervalMillis;e&&(this._fullSnapshotTimer=setInterval(()=>{this._tryTakeFullSnapshot()},e))}}_gatherRRWebPlugins(){var e,t,i=[],n=null==(e=Es.__PosthogExtensions__)||null==(e=e.rrwebPlugins)?void 0:e.getRecordConsolePlugin;n&&this._isConsoleLogCaptureEnabled&&i.push(n());var s=null==(t=Es.__PosthogExtensions__)||null==(t=t.rrwebPlugins)?void 0:t.getRecordNetworkPlugin;return this._networkPayloadCapture&&qs(s)&&(!Io.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?i.push(s(Za(this._instance.config,this._networkPayloadCapture))):tc.info("NetworkCapture not started because we are on localhost.")),i}onRRwebEmit(e){var t;if(this._processQueuedEvents(),e&&js(e)){if(e.type===Na.Meta){var i=this._maskUrl(e.data.href);if(this._lastHref=i,!i)return;e.data.href=i}else this._pageViewFallBack();if(this._urlTriggerMatching.checkUrlTriggerConditions(()=>this._pauseRecording(),()=>this._resumeRecording(),e=>this._activateTrigger(e)),!this._urlTriggerMatching.urlBlocked||(n=e).type===Na.Custom&&"recording paused"===n.data.tag){var n;e.type===Na.FullSnapshot&&this._scheduleFullSnapshot(),e.type===Na.FullSnapshot&&this._receivedFlags&&this._triggerMatching.triggerStatus(this.sessionId)===jl&&this._clearBuffer();var s=this._mutationThrottler?this._mutationThrottler.throttleMutations(e):e;if(s){var r=function(e){var t=e;if(t&&js(t)&&6===t.type&&js(t.data)&&"rrweb/console@1"===t.data.plugin){t.data.payload.payload.length>10&&(t.data.payload.payload=t.data.payload.payload.slice(0,10),t.data.payload.payload.push("...[truncated]"));for(var i=[],n=0;n<t.data.payload.payload.length;n++)t.data.payload.payload[n]&&t.data.payload.payload[n].length>2e3?i.push(t.data.payload.payload[n].slice(0,2e3)+"...[truncated]"):i.push(t.data.payload.payload[n]);return t.data.payload.payload=i,e}return e}(s);if(this._updateWindowAndSessionIds(r),!0!==this._isIdle||oc(r)){if(oc(r)){var o=r.data.payload;if(o){var a=o.lastActivityTimestamp,l=o.threshold;r.timestamp=a+l}}var c=null===(t=this._instance.config.session_recording.compress_events)||void 0===t||t?function(e){if(qa(e)<1024)return e;try{if(e.type===Na.FullSnapshot)return ps({},e,{data:rc(e.data),cv:"2024-10"});if(e.type===Na.IncrementalSnapshot&&e.data.source===Ua.Mutation)return ps({},e,{cv:"2024-10",data:ps({},e.data,{texts:rc(e.data.texts),attributes:rc(e.data.attributes),removes:rc(e.data.removes),adds:rc(e.data.adds)})});if(e.type===Na.IncrementalSnapshot&&e.data.source===Ua.StyleSheetRule)return ps({},e,{cv:"2024-10",data:ps({},e.data,{adds:e.data.adds?rc(e.data.adds):void 0,removes:e.data.removes?rc(e.data.removes):void 0})})}catch(e){tc.error("could not compress event - will use uncompressed event",e)}return e}(r):r,d={$snapshot_bytes:qa(c),$snapshot_data:c,$session_id:this._sessionId,$window_id:this._windowId};this.status!==Dl?this._captureSnapshotBuffered(d):this._clearBuffer()}}}}}_pageViewFallBack(){if(!this._instance.config.capture_pageview&&gs){var e=this._maskUrl(gs.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}_processQueuedEvents(){if(this._queuedRRWebEvents.length){var e=[...this._queuedRRWebEvents];this._queuedRRWebEvents=[],e.forEach(e=>{Date.now()-e.enqueuedAt<=2e3&&this._tryRRWebMethod(e)})}}_maskUrl(e){var t=this._instance.config.session_recording;if(t.maskNetworkRequestFn){var i,n={url:e};return null==(i=n=t.maskNetworkRequestFn(n))?void 0:i.url}return e}_clearBuffer(){return this._buffer={size:0,data:[],sessionId:this._sessionId,windowId:this._windowId},this._buffer}_flushBuffer(){this._flushBufferTimer&&(clearTimeout(this._flushBufferTimer),this._flushBufferTimer=void 0);var e=this._minimumDuration,t=this._sessionDuration,i=Xs(t)&&t>=0,n=Xs(e)&&i&&t<e;return this.status===Al||this.status===$l||this.status===Dl||n?(this._flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3),this._buffer):(this._buffer.data.length>0&&ja(this._buffer).forEach(e=>{this._captureSnapshot({$snapshot_bytes:e.size,$snapshot_data:e.data,$session_id:e.sessionId,$window_id:e.windowId,$lib:"web",$lib_version:Cs.LIB_VERSION})}),this._clearBuffer())}_captureSnapshotBuffered(e){var t,i=2+((null==(t=this._buffer)?void 0:t.data.length)||0);!this._isIdle&&(this._buffer.size+e.$snapshot_bytes+i>943718.4||this._buffer.sessionId!==this._sessionId)&&(this._buffer=this._flushBuffer()),this._buffer.size+=e.$snapshot_bytes,this._buffer.data.push(e.$snapshot_data),this._flushBufferTimer||this._isIdle||(this._flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3))}_captureSnapshot(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}_activateTrigger(e){var t;this._triggerMatching.triggerStatus(this.sessionId)===jl&&(null==(t=this._instance)||null==(t=t.persistence)||t.register({["url"===e?Lr:Dr]:this._sessionId}),this._flushBuffer(),this._reportStarted(e+"_trigger_matched"))}_pauseRecording(){this._urlTriggerMatching.urlBlocked||(this._urlTriggerMatching.urlBlocked=!0,clearInterval(this._fullSnapshotTimer),tc.info("recording paused due to URL blocker"),this._tryAddCustomEvent("recording paused",{reason:"url blocker"}))}_resumeRecording(){this._urlTriggerMatching.urlBlocked&&(this._urlTriggerMatching.urlBlocked=!1,this._tryTakeFullSnapshot(),this._scheduleFullSnapshot(),this._tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),tc.info("recording resumed"))}_addEventTriggerListener(){0!==this._eventTriggerMatching._eventTriggers.length&&Ys(this._removeEventTriggerCaptureHook)&&(this._removeEventTriggerCaptureHook=this._instance.on("eventCaptured",e=>{try{this._eventTriggerMatching._eventTriggers.includes(e.event)&&this._activateTrigger("event")}catch(e){tc.error("Could not activate event trigger",e)}}))}overrideLinkedFlag(){this._linkedFlagMatching.linkedFlagSeen=!0,this._tryTakeFullSnapshot(),this._reportStarted("linked_flag_overridden")}overrideSampling(){var e;null==(e=this._instance.persistence)||e.register({[Or]:!0}),this._tryTakeFullSnapshot(),this._reportStarted("sampling_overridden")}overrideTrigger(e){this._activateTrigger(e)}_reportStarted(e,t){this._instance.register_for_session({$session_recording_start_reason:e}),tc.info(e.replace("_"," "),t),Os(["recording_initialized","session_id_changed"],e)||this._tryAddCustomEvent(e,t)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this._sessionManager.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this._buffer.data.length,$sdk_debug_replay_internal_buffer_size:this._buffer.size,$sdk_debug_current_session_duration:this._sessionDuration,$sdk_debug_session_start:e}}}var lc=er("[SegmentIntegration]"),cc="posthog-js";function dc(e,t){var{organization:i,projectId:n,prefix:s,severityAllowList:r=["error"]}=void 0===t?{}:t;return t=>{var o,a,l,c,d;if("*"!==r&&!r.includes(t.level)||!e.__loaded)return t;t.tags||(t.tags={});var u=e.requestRouter.endpointFor("ui","/project/"+e.config.token+"/person/"+e.get_distinct_id());t.tags["PostHog Person URL"]=u,e.sessionRecordingStarted()&&(t.tags["PostHog Recording URL"]=e.get_session_replay_url({withTimestamp:!0}));var h=(null==(o=t.exception)?void 0:o.values)||[],p=h.map(e=>ps({},e,{stacktrace:e.stacktrace?ps({},e.stacktrace,{type:"raw",frames:(e.stacktrace.frames||[]).map(e=>ps({},e,{platform:"web:javascript"}))}):void 0})),f={$exception_message:(null==(a=h[0])?void 0:a.value)||t.message,$exception_type:null==(l=h[0])?void 0:l.type,$exception_personURL:u,$exception_level:t.level,$exception_list:p,$sentry_event_id:t.event_id,$sentry_exception:t.exception,$sentry_exception_message:(null==(c=h[0])?void 0:c.value)||t.message,$sentry_exception_type:null==(d=h[0])?void 0:d.type,$sentry_tags:t.tags};return i&&n&&(f.$sentry_url=(s||"https://sentry.io/organizations/")+i+"/issues/?project="+n+"&query="+t.event_id),e.exceptions.sendExceptionEvent(f),t}}class uc{constructor(e,t,i,n,s){this.name=cc,this.setupOnce=function(r){r(dc(e,{organization:t,projectId:i,prefix:n,severityAllowList:s}))}}}var hc=null!=gs&&gs.location?Oo(gs.location.hash,"__posthog")||Oo(location.hash,"state"):null,pc="_postHogToolbarParams",fc=er("[Toolbar]"),gc=function(e){return e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e}(gc||{});class vc{constructor(e){this.instance=e}_setToolbarState(e){Es.ph_toolbar_state=e}_getToolbarState(){var e;return null!==(e=Es.ph_toolbar_state)&&void 0!==e?e:gc.UNINITIALIZED}maybeLoadToolbar(e,t,i){if(void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===i&&(i=void 0),!gs||!ws)return!1;e=null!=e?e:gs.location,i=null!=i?i:gs.history;try{if(!t){try{gs.localStorage.setItem("test","test"),gs.localStorage.removeItem("test")}catch(e){return!1}t=null==gs?void 0:gs.localStorage}var n,s=hc||Oo(e.hash,"__posthog")||Oo(e.hash,"state"),r=s?ar(()=>JSON.parse(atob(decodeURIComponent(s))))||ar(()=>JSON.parse(decodeURIComponent(s))):null;return r&&"ph_authorize"===r.action?((n=r).source="url",n&&Object.keys(n).length>0&&(r.desiredHash?e.hash=r.desiredHash:i?i.replaceState(i.state,"",e.pathname+e.search):e.hash="")):((n=JSON.parse(t.getItem(pc)||"{}")).source="localstorage",delete n.userIntent),!(!n.token||this.instance.config.token!==n.token||(this.loadToolbar(n),0))}catch(e){return!1}}_callLoadToolbar(e){var t=Es.ph_load_toolbar||Es.ph_load_editor;!Ys(t)&&qs(t)?t(e,this.instance):fc.warn("No toolbar load function found")}loadToolbar(e){var t=!(null==ws||!ws.getElementById(Jr));if(!gs||t)return!1;var i="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,n=ps({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},i?{instrument:!1}:{});if(gs.localStorage.setItem(pc,JSON.stringify(ps({},n,{source:void 0}))),this._getToolbarState()===gc.LOADED)this._callLoadToolbar(n);else if(this._getToolbarState()===gc.UNINITIALIZED){var s;this._setToolbarState(gc.LOADING),null==(s=Es.__PosthogExtensions__)||null==s.loadExternalDependency||s.loadExternalDependency(this.instance,"toolbar",e=>{if(e)return fc.error("[Toolbar] Failed to load",e),void this._setToolbarState(gc.UNINITIALIZED);this._setToolbarState(gc.LOADED),this._callLoadToolbar(n)}),pr(gs,"turbolinks:load",()=>{this._setToolbarState(gc.UNINITIALIZED),this.loadToolbar(n)})}return!0}_loadEditor(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,i){return void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===i&&(i=void 0),this.maybeLoadToolbar(e,t,i)}}var _c=er("[TracingHeaders]");class mc{constructor(e){this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0,this._startCapturing=()=>{var e,t;Us(this._restoreXHRPatch)&&(null==(e=Es.__PosthogExtensions__)||null==(e=e.tracingHeadersPatchFns)||e._patchXHR(this._instance.get_distinct_id(),this._instance.sessionManager)),Us(this._restoreFetchPatch)&&(null==(t=Es.__PosthogExtensions__)||null==(t=t.tracingHeadersPatchFns)||t._patchFetch(this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}_loadScript(e){var t,i;null!=(t=Es.__PosthogExtensions__)&&t.tracingHeadersPatchFns&&e(),null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"tracing-headers",t=>{if(t)return _c.error("failed to load script",t);e()})}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):(null==(e=this._restoreXHRPatch)||e.call(this),null==(t=this._restoreFetchPatch)||t.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}var yc=er("[Web Vitals]"),bc=9e5;class wc{constructor(e){var t;this._enabledServerSide=!1,this._initialized=!1,this._buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0},this._flushToCapture=()=>{clearTimeout(this._delayedFlushTimer),0!==this._buffer.metrics.length&&(this._instance.capture("$web_vitals",this._buffer.metrics.reduce((e,t)=>ps({},e,{["$web_vitals_"+t.name+"_event"]:ps({},t),["$web_vitals_"+t.name+"_value"]:t.value}),{})),this._buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this._addToBuffer=e=>{var t,i=null==(t=this._instance.sessionManager)?void 0:t.checkAndGetSessionAndWindowId(!0);if(Us(i))yc.error("Could not read session ID. Dropping metrics!");else{this._buffer=this._buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var n=this._currentURL();Us(n)||(Ys(null==e?void 0:e.name)||Ys(null==e?void 0:e.value)?yc.error("Invalid metric received",e):this._maxAllowedValue&&e.value>=this._maxAllowedValue?yc.error("Ignoring metric with value >= "+this._maxAllowedValue,e):(this._buffer.url!==n&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),Us(this._buffer.url)&&(this._buffer.url=n),this._buffer.firstMetricTimestamp=Us(this._buffer.firstMetricTimestamp)?Date.now():this._buffer.firstMetricTimestamp,e.attribution&&e.attribution.interactionTargetElement&&(e.attribution.interactionTargetElement=void 0),this._buffer.metrics.push(ps({},e,{$current_url:n,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this._buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}},this._startCapturing=()=>{var e,t,i,n,s=Es.__PosthogExtensions__;Us(s)||Us(s.postHogWebVitalsCallbacks)||({onLCP:e,onCLS:t,onFCP:i,onINP:n}=s.postHogWebVitalsCallbacks),e&&t&&i&&n?(this.allowedMetrics.indexOf("LCP")>-1&&e(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&t(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&n(this._addToBuffer.bind(this)),this._initialized=!0):yc.error("web vitals callbacks not loaded - not starting")},this._instance=e,this._enabledServerSide=!(null==(t=this._instance.persistence)||!t.props[wr]),this.startIfEnabled()}get allowedMetrics(){var e,t,i=js(this._instance.config.capture_performance)?null==(e=this._instance.config.capture_performance)?void 0:e.web_vitals_allowed_metrics:void 0;return Us(i)?(null==(t=this._instance.persistence)?void 0:t.props[kr])||["CLS","FCP","INP","LCP"]:i}get flushToCaptureTimeoutMs(){return(js(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var e=js(this._instance.config.capture_performance)&&Xs(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:bc;return 0<e&&e<=6e4?bc:e}get isEnabled(){var e=null==xs?void 0:xs.protocol;if("http:"!==e&&"https:"!==e)return yc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=js(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Qs(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Qs(t)?t:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(yc.info("enabled, starting..."),this._loadScript(this._startCapturing))}onRemoteConfig(e){var t=js(e.capturePerformance)&&!!e.capturePerformance.web_vitals,i=js(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[wr]:t}),this._instance.persistence.register({[kr]:i})),this._enabledServerSide=t,this.startIfEnabled()}_loadScript(e){var t,i;null!=(t=Es.__PosthogExtensions__)&&t.postHogWebVitalsCallbacks&&e(),null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"web-vitals",t=>{t?yc.error("failed to load script",t):e()})}_currentURL(){var e=gs?gs.location.href:void 0;return e||yc.error("Could not determine current URL"),e}}var xc=er("[Heatmaps]");function kc(e){return js(e)&&"clientX"in e&&"clientY"in e&&Xs(e.clientX)&&Xs(e.clientY)}class Sc{constructor(e){var t;this.rageclicks=new Co,this._enabledServerSide=!1,this._initialized=!1,this._flushInterval=null,this.instance=e,this._enabledServerSide=!(null==(t=this.instance.persistence)||!t.props[mr])}get flushIntervalMilliseconds(){var e=5e3;return js(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return Us(this.instance.config.capture_heatmaps)?Us(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled){if(this._initialized)return;xc.info("starting..."),this._setupListeners(),this._flushInterval=setInterval(this._flush.bind(this),this.flushIntervalMilliseconds)}else{var e,t;clearInterval(null!==(e=this._flushInterval)&&void 0!==e?e:void 0),null==(t=this._deadClicksCapture)||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[mr]:t}),this._enabledServerSide=t,this.startIfEnabled()}getAndClearBuffer(){var e=this._buffer;return this._buffer=void 0,e}_onDeadClick(e){this._onClick(e.originalEvent,"deadclick")}_setupListeners(){gs&&ws&&(pr(gs,"beforeunload",this._flush.bind(this)),pr(ws,"click",e=>this._onClick(e||(null==gs?void 0:gs.event)),{capture:!0}),pr(ws,"mousemove",e=>this._onMouseMove(e||(null==gs?void 0:gs.event)),{capture:!0}),this._deadClicksCapture=new la(this.instance,oa,this._onDeadClick.bind(this)),this._deadClicksCapture.startIfEnabled(),this._initialized=!0)}_getProperties(e,t){var i=this.instance.scrollManager.scrollY(),n=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),r=function(e,t,i){for(var n=e;n&&to(n)&&!io(n,"body");){if(n===i)return!1;if(Os(t,null==gs?void 0:gs.getComputedStyle(n).position))return!0;n=po(n)}return!1}(uo(e),["fixed","sticky"],s);return{x:e.clientX+(r?0:n),y:e.clientY+(r?0:i),target_fixed:r,type:t}}_onClick(e,t){var i;if(void 0===t&&(t="click"),!eo(e.target)&&kc(e)){var n=this._getProperties(e,t);null!=(i=this.rageclicks)&&i.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._capture(ps({},n,{type:"rageclick"})),this._capture(n)}}_onMouseMove(e){!eo(e.target)&&kc(e)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(()=>{this._capture(this._getProperties(e,"mousemove"))},500))}_capture(e){if(gs){var t=gs.location.href;this._buffer=this._buffer||{},this._buffer[t]||(this._buffer[t]=[]),this._buffer[t].push(e)}}_flush(){this._buffer&&!Ns(this._buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class Pc{constructor(e){this._instance=e}doPageView(e,t){var i,n=this._previousPageViewProperties(e,t);return this._currentPageview={pathname:null!==(i=null==gs?void 0:gs.location.pathname)&&void 0!==i?i:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),n}doPageLeave(e){var t;return this._previousPageViewProperties(e,null==(t=this._currentPageview)?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:null==(e=this._currentPageview)?void 0:e.pageViewId}}_previousPageViewProperties(e,t){var i=this._currentPageview;if(!i)return{$pageview_id:t};var n={$pageview_id:t,$prev_pageview_id:i.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:r,lastScrollY:o,maxScrollY:a,maxContentHeight:l,lastContentY:c,maxContentY:d}=s;if(!(Us(r)||Us(o)||Us(a)||Us(l)||Us(c)||Us(d))){r=Math.ceil(r),o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),c=Math.ceil(c),d=Math.ceil(d);var u=r<=1?1:ca(o/r,0,1),h=r<=1?1:ca(a/r,0,1),p=l<=1?1:ca(c/l,0,1),f=l<=1?1:ca(d/l,0,1);n=sr(n,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:u,$prev_pageview_max_scroll:a,$prev_pageview_max_scroll_percentage:h,$prev_pageview_last_content:c,$prev_pageview_last_content_percentage:p,$prev_pageview_max_content:d,$prev_pageview_max_content_percentage:f})}}return i.pathname&&(n.$prev_pageview_pathname=i.pathname),i.timestamp&&(n.$prev_pageview_duration=(e.getTime()-i.timestamp.getTime())/1e3),n}}var Tc=!!Ss||!!ks,Ec="text/plain",Cc=(e,t)=>{var[i,n]=e.split("?"),s=ps({},t);null==n||n.split("&").forEach(e=>{var[t]=e.split("=");delete s[t]});var r=function(e,t){var i,n;void 0===t&&(t="&");var s=[];return nr(e,function(e,t){Us(e)||Us(t)||"undefined"===t||(i=encodeURIComponent((e=>e instanceof File)(e)?e.name:e.toString()),n=encodeURIComponent(t),s[s.length]=n+"="+i)}),s.join(t)}(s);return i+"?"+(r?(n?n+"&":"")+r:n)},Ic=(e,t)=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString():t,t),Mc=e=>{var{data:t,compression:i}=e;if(t){if(i===Rs.GZipJS){var n=Ol(Ll(Ic(t)),{mtime:0}),s=new Blob([n],{type:Ec});return{contentType:Ec,body:s,estimatedSize:s.size}}if(i===Rs.Base64){var r=function(e){var t,i,n,s,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,c="",d=[];if(!e)return e;e=function(e){var t,i,n,s,r="";for(t=i=0,n=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,s=0;s<n;s++){var o=e.charCodeAt(s),a=null;o<128?i++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),Ws(a)||(i>t&&(r+=e.substring(t,i)),r+=a,t=i=s+1)}return i>t&&(r+=e.substring(t,e.length)),r}(e);do{t=(r=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>18&63,i=r>>12&63,n=r>>6&63,s=63&r,d[l++]=o.charAt(t)+o.charAt(i)+o.charAt(n)+o.charAt(s)}while(a<e.length);switch(c=d.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}(Ic(t)),o=(e=>"data="+encodeURIComponent("string"==typeof e?e:Ic(e)))(r);return{contentType:"application/x-www-form-urlencoded",body:o,estimatedSize:new Blob([o]).size}}var a=Ic(t);return{contentType:"application/json",body:a,estimatedSize:new Blob([a]).size}}},Rc=[];ks&&Rc.push({transport:"fetch",method:e=>{var t,i,{contentType:n,body:s,estimatedSize:r}=null!==(t=Mc(e))&&void 0!==t?t:{},o=new Headers;nr(e.headers,function(e,t){o.append(t,e)}),n&&o.append("Content-Type",n);var a=e.url,l=null;if(Ps){var c=new Ps;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),e.timeout)}}ks(a,ps({method:(null==e?void 0:e.method)||"GET",headers:o,keepalive:"POST"===e.method&&(r||0)<52428.8,body:s,signal:null==(i=l)?void 0:i.signal},e.fetchOptions)).then(t=>t.text().then(i=>{var n={statusCode:t.status,text:i};if(200===t.status)try{n.json=JSON.parse(i)}catch(e){Zs.error(e)}null==e.callback||e.callback(n)})).catch(t=>{Zs.error(t),null==e.callback||e.callback({statusCode:0,text:t})}).finally(()=>l?clearTimeout(l.timeout):null)}}),Ss&&Rc.push({transport:"XHR",method:e=>{var t,i=new Ss;i.open(e.method||"GET",e.url,!0);var{contentType:n,body:s}=null!==(t=Mc(e))&&void 0!==t?t:{};nr(e.headers,function(e,t){i.setRequestHeader(t,e)}),n&&i.setRequestHeader("Content-Type",n),e.timeout&&(i.timeout=e.timeout),i.withCredentials=!0,i.onreadystatechange=()=>{if(4===i.readyState){var t={statusCode:i.status,text:i.responseText};if(200===i.status)try{t.json=JSON.parse(i.responseText)}catch(e){}null==e.callback||e.callback(t)}},i.send(s)}}),null!=bs&&bs.sendBeacon&&Rc.push({transport:"sendBeacon",method:e=>{var t=Cc(e.url,{beacon:"1"});try{var i,{contentType:n,body:s}=null!==(i=Mc(e))&&void 0!==i?i:{},r="string"==typeof s?new Blob([s],{type:n}):s;bs.sendBeacon(t,r)}catch(e){}}});var Fc=function(e,t){if(!function(e){try{new RegExp(e)}catch(e){return!1}return!0}(t))return!1;try{return new RegExp(t).test(e)}catch(e){return!1}};function Oc(e,t,i){return Ic({distinct_id:e,userPropertiesToSet:t,userPropertiesToSetOnce:i})}var Lc={exact:(e,t)=>t.some(t=>e.some(e=>t===e)),is_not:(e,t)=>t.every(t=>e.every(e=>t!==e)),regex:(e,t)=>t.some(t=>e.some(e=>Fc(t,e))),not_regex:(e,t)=>t.every(t=>e.every(e=>!Fc(t,e))),icontains:(e,t)=>t.map(Dc).some(t=>e.map(Dc).some(e=>t.includes(e))),not_icontains:(e,t)=>t.map(Dc).every(t=>e.map(Dc).every(e=>!t.includes(e)))},Dc=e=>e.toLowerCase(),zc=er("[Error tracking]");class Gc{constructor(e){var t,i;this._suppressionRules=[],this._instance=e,this._suppressionRules=null!==(t=null==(i=this._instance.persistence)?void 0:i.get_property(br))&&void 0!==t?t:[]}onRemoteConfig(e){var t,i,n=null!==(t=null==(i=e.errorTracking)?void 0:i.suppressionRules)&&void 0!==t?t:[];this._suppressionRules=n,this._instance.persistence&&this._instance.persistence.register({[br]:this._suppressionRules})}sendExceptionEvent(e){if(!this._matchesSuppressionRule(e))return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"});zc.info("Skipping exception capture because a suppression rule matched")}_matchesSuppressionRule(e){var t=e.$exception_list;if(!t||!Bs(t)||0===t.length)return!1;var i=t.reduce((e,t)=>{var{type:i,value:n}=t;return Hs(i)&&i.length>0&&e.$exception_types.push(i),Hs(n)&&n.length>0&&e.$exception_values.push(n),e},{$exception_types:[],$exception_values:[]});return this._suppressionRules.some(e=>{var t=e.values.map(e=>{var t,n=Lc[e.operator],s=Bs(e.value)?e.value:[e.value],r=null!==(t=i[e.key])&&void 0!==t?t:[];return s.length>0&&n(s,r)});return"OR"===e.type?t.some(Boolean):t.every(Boolean)})}}var Ac="Mobile",$c="iOS",Bc="Android",qc="Tablet",jc=Bc+" "+qc,Nc="iPad",Uc="Apple",Hc=Uc+" Watch",Vc="Safari",Wc="BlackBerry",Yc="Samsung",Xc=Yc+"Browser",Qc=Yc+" Internet",Jc="Chrome",Kc=Jc+" OS",Zc=Jc+" "+$c,ed="Internet Explorer",td=ed+" "+Ac,id="Opera",nd=id+" Mini",sd="Edge",rd="Microsoft "+sd,od="Firefox",ad=od+" "+$c,ld="Nintendo",cd="PlayStation",dd="Xbox",ud=Bc+" "+Ac,hd=Ac+" "+Vc,pd="Windows",fd=pd+" Phone",gd="Nokia",vd="Ouya",_d="Generic",md=_d+" "+Ac.toLowerCase(),yd=_d+" "+qc.toLowerCase(),bd="Konqueror",wd="(\\d+(\\.\\d+)?)",xd=new RegExp("Version/"+wd),kd=new RegExp(dd,"i"),Sd=new RegExp(cd+" \\w+","i"),Pd=new RegExp(ld+" \\w+","i"),Td=new RegExp(Wc+"|PlayBook|BB10","i"),Ed={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Cd=function(e,t){return t=t||"",Os(e," OPR/")&&Os(e,"Mini")?nd:Os(e," OPR/")?id:Td.test(e)?Wc:Os(e,"IE"+Ac)||Os(e,"WPDesktop")?td:Os(e,Xc)?Qc:Os(e,sd)||Os(e,"Edg/")?rd:Os(e,"FBIOS")?"Facebook "+Ac:Os(e,"UCWEB")||Os(e,"UCBrowser")?"UC Browser":Os(e,"CriOS")?Zc:Os(e,"CrMo")||Os(e,Jc)?Jc:Os(e,Bc)&&Os(e,Vc)?ud:Os(e,"FxiOS")?ad:Os(e.toLowerCase(),bd.toLowerCase())?bd:((e,t)=>t&&Os(t,Uc)||function(e){return Os(e,Vc)&&!Os(e,Jc)&&!Os(e,Bc)}(e))(e,t)?Os(e,Ac)?hd:Vc:Os(e,od)?od:Os(e,"MSIE")||Os(e,"Trident/")?ed:Os(e,"Gecko")?od:""},Id={[td]:[new RegExp("rv:"+wd)],[rd]:[new RegExp(sd+"?\\/"+wd)],[Jc]:[new RegExp("("+Jc+"|CrMo)\\/"+wd)],[Zc]:[new RegExp("CriOS\\/"+wd)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+wd)],[Vc]:[xd],[hd]:[xd],[id]:[new RegExp("(Opera|OPR)\\/"+wd)],[od]:[new RegExp(od+"\\/"+wd)],[ad]:[new RegExp("FxiOS\\/"+wd)],[bd]:[new RegExp("Konqueror[:/]?"+wd,"i")],[Wc]:[new RegExp(Wc+" "+wd),xd],[ud]:[new RegExp("android\\s"+wd,"i")],[Qc]:[new RegExp(Xc+"\\/"+wd)],[ed]:[new RegExp("(rv:|MSIE )"+wd)],Mozilla:[new RegExp("rv:"+wd)]},Md=function(e,t){var i=Cd(e,t),n=Id[i];if(Us(n))return null;for(var s=0;s<n.length;s++){var r=n[s],o=e.match(r);if(o)return parseFloat(o[o.length-2])}return null},Rd=[[new RegExp(dd+"; "+dd+" (.*?)[);]","i"),e=>[dd,e&&e[1]||""]],[new RegExp(ld,"i"),[ld,""]],[new RegExp(cd,"i"),[cd,""]],[Td,[Wc,""]],[new RegExp(pd,"i"),(e,t)=>{if(/Phone/.test(t)||/WPDesktop/.test(t))return[fd,""];if(new RegExp(Ac).test(t)&&!/IEMobile\b/.test(t))return[pd+" "+Ac,""];var i=/Windows NT ([0-9.]+)/i.exec(t);if(i&&i[1]){var n=i[1],s=Ed[n]||"";return/arm/i.test(t)&&(s="RT"),[pd,s]}return[pd,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,e=>{if(e&&e[3]){var t=[e[3],e[4],e[5]||"0"];return[$c,t.join(".")]}return[$c,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,e=>{var t="";return e&&e.length>=3&&(t=Us(e[2])?e[3]:e[2]),["watchOS",t]}],[new RegExp("("+Bc+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Bc+")","i"),e=>{if(e&&e[2]){var t=[e[2],e[3],e[4]||"0"];return[Bc,t.join(".")]}return[Bc,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,e=>{var t=["Mac OS X",""];if(e&&e[1]){var i=[e[1],e[2],e[3]||"0"];t[1]=i.join(".")}return t}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Kc,""]],[/Linux|debian/i,["Linux",""]]],Fd=function(e){return Pd.test(e)?ld:Sd.test(e)?cd:kd.test(e)?dd:new RegExp(vd,"i").test(e)?vd:new RegExp("("+fd+"|WPDesktop)","i").test(e)?fd:/iPad/.test(e)?Nc:/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(e)?Hc:Td.test(e)?Wc:/(kobo)\s(ereader|touch)/i.test(e)?"Kobo":new RegExp(gd,"i").test(e)?gd:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(e)||/(kf[a-z]+)( bui|\)).+silk\//i.test(e)?"Kindle Fire":/(Android|ZTE)/i.test(e)?!new RegExp(Ac).test(e)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(e)?/pixel[\daxl ]{1,6}/i.test(e)&&!/pixel c/i.test(e)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(e)||/lmy47v/i.test(e)&&!/QTAQZ3/i.test(e)?Bc:jc:Bc:new RegExp("(pda|"+Ac+")","i").test(e)?md:new RegExp(qc,"i").test(e)&&!new RegExp(qc+" pc","i").test(e)?yd:""},Od="https?://(.*)",Ld=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Dd=rr(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],Ld),zd="<masked>",Gd=["li_fat_id"];function Ad(e,t,i){if(!ws)return{};var n,s=t?rr([],Ld,i||[]):[],r=$d(Fo(ws.URL,s,zd),e),o=(n={},nr(Gd,function(e){var t=Yo._get(e);n[e]=t||null}),n);return sr(o,r)}function $d(e,t){var i=Dd.concat(t||[]),n={};return nr(i,function(t){var i=Ro(e,t);n[t]=i||null}),n}function Bd(e){var t=function(e){return e?0===e.search(Od+"google.([^/?]*)")?"google":0===e.search(Od+"bing.com")?"bing":0===e.search(Od+"yahoo.com")?"yahoo":0===e.search(Od+"duckduckgo.com")?"duckduckgo":null:null}(e),i="yahoo"!=t?"q":"p",n={};if(!Ws(t)){n.$search_engine=t;var s=ws?Ro(ws.referrer,i):"";s.length&&(n.ph_keyword=s)}return n}function qd(){return navigator.language||navigator.userLanguage}function jd(){return(null==ws?void 0:ws.referrer)||"$direct"}function Nd(e,t){var i=e?rr([],Ld,t||[]):[],n=null==xs?void 0:xs.href.substring(0,1e3);return{r:jd().substring(0,1e3),u:n?Fo(n,i,zd):void 0}}function Ud(e){var t,{r:i,u:n}=e,s={$referrer:i,$referring_domain:null==i?void 0:"$direct"==i?"$direct":null==(t=Mo(i))?void 0:t.host};if(n){s.$current_url=n;var r=Mo(n);s.$host=null==r?void 0:r.host,s.$pathname=null==r?void 0:r.pathname;var o=$d(n);sr(s,o)}if(i){var a=Bd(i);sr(s,a)}return s}function Hd(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return}}function Vd(){try{return(new Date).getTimezoneOffset()}catch(e){return}}function Wd(e,t){if(!Ts)return{};var i,n,s,r=e?rr([],Ld,t||[]):[],[o,a]=function(e){for(var t=0;t<Rd.length;t++){var[i,n]=Rd[t],s=i.exec(e),r=s&&(qs(n)?n(s,e):n);if(r)return r}return["",""]}(Ts);return sr(cr({$os:o,$os_version:a,$browser:Cd(Ts,navigator.vendor),$device:Fd(Ts),$device_type:(n=Ts,s=Fd(n),s===Nc||s===jc||"Kobo"===s||"Kindle Fire"===s||s===yd?qc:s===ld||s===dd||s===cd||s===vd?"Console":s===Hc?"Wearable":s?Ac:"Desktop"),$timezone:Hd(),$timezone_offset:Vd()}),{$current_url:Fo(null==xs?void 0:xs.href,r,zd),$host:null==xs?void 0:xs.host,$pathname:null==xs?void 0:xs.pathname,$raw_user_agent:Ts.length>1e3?Ts.substring(0,997)+"...":Ts,$browser_version:Md(Ts,navigator.vendor),$browser_language:qd(),$browser_language_prefix:(i=qd(),"string"==typeof i?i.split("-")[0]:void 0),$screen_height:null==gs?void 0:gs.screen.height,$screen_width:null==gs?void 0:gs.screen.width,$viewport_height:null==gs?void 0:gs.innerHeight,$viewport_width:null==gs?void 0:gs.innerWidth,$lib:"web",$lib_version:Cs.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Yd=er("[FeatureFlags]"),Xd="$active_feature_flags",Qd="$override_feature_flags",Jd="$feature_flag_payloads",Kd="$override_feature_flag_payloads",Zd="$feature_flag_request_id",eu=e=>{var t={};for(var[i,n]of or(e||{}))n&&(t[i]=n);return t},tu=function(e){return e.FeatureFlags="feature_flags",e.Recordings="recordings",e}({});class iu{constructor(e){this._override_warning=!1,this._hasLoadedFlags=!1,this._requestInFlight=!1,this._reloadingDisabled=!1,this._additionalReloadRequested=!1,this._flagsCalled=!1,this._flagsLoadedFromRemote=!1,this._instance=e,this.featureFlagEventHandlers=[]}flags(){if(this._instance.config.__preview_remote_config)this._flagsCalled=!0;else{var e=!this._reloadDebouncer&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this._callFlagsEndpoint({disableFlags:e})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Ar),t=this._instance.get_property(Qd),i=this._instance.get_property(Kd);if(!i&&!t)return e||{};var n=sr({},e||{}),s=[...new Set([...Object.keys(i||{}),...Object.keys(t||{})])];for(var r of s){var o,a,l=n[r],c=null==t?void 0:t[r],d=Us(c)?null!==(o=null==l?void 0:l.enabled)&&void 0!==o&&o:!!c,u=Us(c)?l.variant:"string"==typeof c?c:void 0,h=null==i?void 0:i[r],p=ps({},l,{enabled:d,variant:d?null!=u?u:null==l?void 0:l.variant:void 0});d!==(null==l?void 0:l.enabled)&&(p.original_enabled=null==l?void 0:l.enabled),u!==(null==l?void 0:l.variant)&&(p.original_variant=null==l?void 0:l.variant),h&&(p.metadata=ps({},null==l?void 0:l.metadata,{payload:h,original_payload:null==l||null==(a=l.metadata)?void 0:a.payload})),n[r]=p}return this._override_warning||(Yd.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:i,finalDetails:n}),this._override_warning=!0),n}getFlagVariants(){var e=this._instance.get_property(zr),t=this._instance.get_property(Qd);if(!t)return e||{};for(var i=sr({},e),n=Object.keys(t),s=0;s<n.length;s++)i[n[s]]=t[n[s]];return this._override_warning||(Yd.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:i}),this._override_warning=!0),i}getFlagPayloads(){var e=this._instance.get_property(Jd),t=this._instance.get_property(Kd);if(!t)return e||{};for(var i=sr({},e||{}),n=Object.keys(t),s=0;s<n.length;s++)i[n[s]]=t[n[s]];return this._override_warning||(Yd.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:i}),this._override_warning=!0),i}reloadFeatureFlags(){this._reloadingDisabled||this._instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout(()=>{this._callFlagsEndpoint()},5))}_clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this._reloadingDisabled=e}_callFlagsEndpoint(e){var t;if(this._clearDebouncer(),!this._instance._shouldDisableFlags())if(this._requestInFlight)this._additionalReloadRequested=!0;else{var i={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:ps({},(null==(t=this._instance.persistence)?void 0:t.get_initial_props())||{},this._instance.get_property($r)||{}),group_properties:this._instance.get_property(Br)};(null!=e&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0);var n=this._instance.config.__preview_remote_config,s=n?"/flags/?v=2":"/flags/?v=2&config=true",r=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",o=this._instance.requestRouter.endpointFor("api",s+r);n&&(i.timezone=Hd()),this._requestInFlight=!0,this._instance._send_request({method:"POST",url:o,data:i,compression:this._instance.config.disable_compression?void 0:Rs.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:e=>{var t,n,s=!0;if(200===e.statusCode&&(this._additionalReloadRequested||(this.$anon_distinct_id=void 0),s=!1),this._requestInFlight=!1,this._flagsCalled||(this._flagsCalled=!0,this._instance._onRemoteConfig(null!==(n=e.json)&&void 0!==n?n:{})),!i.disable_flags||this._additionalReloadRequested)if(this._flagsLoadedFromRemote=!s,e.json&&null!=(t=e.json.quotaLimited)&&t.includes(tu.FeatureFlags))Yd.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var r;i.disable_flags||this.receivedFeatureFlags(null!==(r=e.json)&&void 0!==r?r:{},s),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callFlagsEndpoint())}}})}}getFeatureFlag(e,t){if(void 0===t&&(t={}),this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var i=this.getFlagVariants()[e],n=""+i,s=this._instance.get_property(Zd)||void 0,r=this._instance.get_property(Nr)||{};if((t.send_event||!("send_event"in t))&&(!(e in r)||!r[e].includes(n))){var o,a,l,c,d,u,h,p,f;Bs(r[e])?r[e].push(n):r[e]=[n],null==(o=this._instance.persistence)||o.register({[Nr]:r});var g=this.getFeatureFlagDetails(e),v={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:s,$feature_flag_bootstrapped_response:(null==(a=this._instance.config.bootstrap)||null==(a=a.featureFlags)?void 0:a[e])||null,$feature_flag_bootstrapped_payload:(null==(l=this._instance.config.bootstrap)||null==(l=l.featureFlagPayloads)?void 0:l[e])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote};Us(null==g||null==(c=g.metadata)?void 0:c.version)||(v.$feature_flag_version=g.metadata.version);var _,m=null!==(d=null==g||null==(u=g.reason)?void 0:u.description)&&void 0!==d?d:null==g||null==(h=g.reason)?void 0:h.code;m&&(v.$feature_flag_reason=m),null!=g&&null!=(p=g.metadata)&&p.id&&(v.$feature_flag_id=g.metadata.id),Us(null==g?void 0:g.original_variant)&&Us(null==g?void 0:g.original_enabled)||(v.$feature_flag_original_response=Us(g.original_variant)?g.original_enabled:g.original_variant),null!=g&&null!=(f=g.metadata)&&f.original_payload&&(v.$feature_flag_original_payload=null==g||null==(_=g.metadata)?void 0:_.original_payload),this._instance.capture("$feature_flag_called",v)}return i}Yd.warn('getFeatureFlag for key "'+e+"\" failed. Feature flags didn't load in time.")}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var i=this._instance.config.token;this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:{distinct_id:this._instance.get_distinct_id(),token:i},compression:this._instance.config.disable_compression?void 0:Rs.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var n,s=null==(n=i.json)?void 0:n.featureFlagPayloads;t((null==s?void 0:s[e])||void 0)}})}isFeatureEnabled(e,t){if(void 0===t&&(t={}),this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);Yd.warn('isFeatureEnabled for key "'+e+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this._instance.persistence){this._hasLoadedFlags=!0;var i=this.getFlagVariants(),n=this.getFlagPayloads(),s=this.getFlagsWithDetails();!function(e,t,i,n,s){void 0===i&&(i={}),void 0===n&&(n={}),void 0===s&&(s={});var r=(e=>{var t=e.flags;return t?(e.featureFlags=Object.fromEntries(Object.keys(t).map(e=>{var i;return[e,null!==(i=t[e].variant)&&void 0!==i?i:t[e].enabled]})),e.featureFlagPayloads=Object.fromEntries(Object.keys(t).filter(e=>t[e].enabled).filter(e=>{var i;return null==(i=t[e].metadata)?void 0:i.payload}).map(e=>{var i;return[e,null==(i=t[e].metadata)?void 0:i.payload]}))):Yd.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),e})(e),o=r.flags,a=r.featureFlags,l=r.featureFlagPayloads;if(a){var c=e.requestId;if(Bs(a)){Yd.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var d={};if(a)for(var u=0;u<a.length;u++)d[a[u]]=!0;t&&t.register({[Xd]:a,[zr]:d})}else{var h=a,p=l,f=o;e.errorsWhileComputingFlags&&(h=ps({},i,h),p=ps({},n,p),f=ps({},s,f)),t&&t.register(ps({[Xd]:Object.keys(eu(h)),[zr]:h||{},[Jd]:p||{},[Ar]:f||{}},c?{[Zd]:c}:{}))}}}(e,this._instance.persistence,i,n,s),this._fireFeatureFlagsCallbacks(t)}}override(e,t){void 0===t&&(t=!1),Yd.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Yd.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(!1===e)return this._instance.persistence.unregister(Qd),this._instance.persistence.unregister(Kd),void this._fireFeatureFlagsCallbacks();if(e&&"object"==typeof e&&("flags"in e||"payloads"in e)){var t,i=e;if(this._override_warning=Boolean(null!==(t=i.suppressWarning)&&void 0!==t&&t),"flags"in i)if(!1===i.flags)this._instance.persistence.unregister(Qd);else if(i.flags)if(Bs(i.flags)){for(var n={},s=0;s<i.flags.length;s++)n[i.flags[s]]=!0;this._instance.persistence.register({[Qd]:n})}else this._instance.persistence.register({[Qd]:i.flags});return"payloads"in i&&(!1===i.payloads?this._instance.persistence.unregister(Kd):i.payloads&&this._instance.persistence.register({[Kd]:i.payloads})),void this._fireFeatureFlagsCallbacks()}this._fireFeatureFlagsCallbacks()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this._hasLoadedFlags){var{flags:t,flagVariants:i}=this._prepareFeatureFlagsForCallbacks();e(t,i)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t){var i,n=(this._instance.get_property(Gr)||[]).find(t=>t.flagKey===e),s={["$feature_enrollment/"+e]:t},r={$feature_flag:e,$feature_enrollment:t,$set:s};n&&(r.$early_access_feature_name=n.name),this._instance.capture("$feature_enrollment_update",r),this.setPersonPropertiesForFlags(s,!1);var o=ps({},this.getFlagVariants(),{[e]:t});null==(i=this._instance.persistence)||i.register({[Xd]:Object.keys(eu(o)),[zr]:o}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(e,t,i){void 0===t&&(t=!1);var n=this._instance.get_property(Gr),s=i?"&"+i.map(e=>"stage="+e).join("&"):"";if(n&&!t)return e(n);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:t=>{var i;if(t.json){var n=t.json.earlyAccessFeatures;return null==(i=this._instance.persistence)||i.register({[Gr]:n}),e(n)}}})}_prepareFeatureFlagsForCallbacks(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(e=>t[e]),flagVariants:Object.keys(t).filter(e=>t[e]).reduce((e,i)=>(e[i]=t[i],e),{})}}_fireFeatureFlagsCallbacks(e){var{flags:t,flagVariants:i}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach(n=>n(t,i,{errorsLoading:e}))}setPersonPropertiesForFlags(e,t){void 0===t&&(t=!0);var i=this._instance.get_property($r)||{};this._instance.register({[$r]:ps({},i,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister($r)}setGroupPropertiesForFlags(e,t){void 0===t&&(t=!0);var i=this._instance.get_property(Br)||{};0!==Object.keys(i).length&&Object.keys(i).forEach(t=>{i[t]=ps({},i[t],e[t]),delete e[t]}),this._instance.register({[Br]:ps({},i,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(Br)||{};this._instance.register({[Br]:ps({},t,{[e]:{}})})}else this._instance.unregister(Br)}reset(){this._hasLoadedFlags=!1,this._requestInFlight=!1,this._reloadingDisabled=!1,this._additionalReloadRequested=!1,this._flagsCalled=!1,this._flagsLoadedFromRemote=!1,this.$anon_distinct_id=void 0,this._clearDebouncer(),this._override_warning=!1}}var nu=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class su{constructor(e,t){this._config=e,this.props={},this._campaign_params_saved=!1,this._name=(e=>{var t="";return e.token&&(t=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),e.persistence_name?"ph_"+e.persistence_name:"ph_"+t+"_posthog"})(e),this._storage=this._buildStorage(e),this.load(),e.debug&&Zs.info("Persistence loaded",e.persistence,ps({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this._disabled}_buildStorage(e){-1===nu.indexOf(e.persistence.toLowerCase())&&(Zs.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return"localstorage"===t&&Qo._is_supported()?Qo:"localstorage+cookie"===t&&Ko._is_supported()?Ko:"sessionstorage"===t&&ia._is_supported()?ia:"memory"===t?ea:"cookie"===t?Yo:Ko._is_supported()?Ko:Yo}properties(){var e={};return nr(this.props,function(t,i){if(i===zr&&js(t))for(var n=Object.keys(t),s=0;s<n.length;s++)e["$feature/"+n[s]]=t[n[s]];else o=i,a=!1,(Ws(r=Zr)?a:ys&&r.indexOf===ys?-1!=r.indexOf(o):(nr(r,function(e){if(a||(a=e===o))return tr}),a))||(e[i]=t);var r,o,a}),e}load(){if(!this._disabled){var e=this._storage._parse(this._name);e&&(this.props=sr({},e))}}save(){this._disabled||this._storage._set(this._name,this.props,this._expire_days,this._cross_subdomain,this._secure,this._config.debug)}remove(){this._storage._remove(this._name,!1),this._storage._remove(this._name,!0)}clear(){this.remove(),this.props={}}register_once(e,t,i){if(js(e)){Us(t)&&(t="None"),this._expire_days=Us(i)?this._default_expiry:i;var n=!1;if(nr(e,(e,i)=>{this.props.hasOwnProperty(i)&&this.props[i]!==t||(this.props[i]=e,n=!0)}),n)return this.save(),!0}return!1}register(e,t){if(js(e)){this._expire_days=Us(t)?this._default_expiry:t;var i=!1;if(nr(e,(t,n)=>{e.hasOwnProperty(n)&&this.props[n]!==t&&(this.props[n]=t,i=!0)}),i)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this._campaign_params_saved){var e=Ad(this._config.custom_campaign_params,this._config.mask_personal_data_properties,this._config.custom_personal_data_properties);Ns(cr(e))||this.register(e),this._campaign_params_saved=!0}}update_search_keyword(){var e;this.register((e=null==ws?void 0:ws.referrer)?Bd(e):{})}update_referrer_info(){var e;this.register_once({$referrer:jd(),$referring_domain:null!=ws&&ws.referrer&&(null==(e=Mo(ws.referrer))?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[Wr]||this.props[Yr]||this.register_once({[Xr]:Nd(this._config.mask_personal_data_properties,this._config.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};nr([Yr,Wr],t=>{var i=this.props[t];i&&nr(i,function(t,i){e["$initial_"+Ds(i)]=t})});var t,i,n=this.props[Xr];if(n){var s=(t=Ud(n),i={},nr(t,function(e,t){i["$initial_"+Ds(t)]=e}),i);sr(e,s)}return e}safe_merge(e){return nr(this.props,function(t,i){i in e||(e[i]=t)}),e}update_config(e,t,i){if(this._default_expiry=this._expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!i),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var n=this._buildStorage(e),s=this.props;this.clear(),this._storage=n,this.props=s,this.save()}}set_disabled(e){this._disabled=e,this._disabled?this.remove():this.save()}set_cross_subdomain(e){e!==this._cross_subdomain&&(this._cross_subdomain=e,this.remove(),this.save())}set_secure(e){e!==this._secure&&(this._secure=e,this.remove(),this.save())}set_event_timer(e,t){var i=this.props[vr]||{};i[e]=t,this.props[vr]=i,this.save()}remove_event_timer(e){var t=(this.props[vr]||{})[e];return Us(t)||(delete this.props[vr][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}class ru{constructor(){this._events={},this._events={}}on(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),()=>{this._events[e]=this._events[e].filter(e=>e!==t)}}emit(e,t){for(var i of this._events[e]||[])i(t);for(var n of this._events["*"]||[])n(e,t)}}class ou{constructor(e){this._debugEventEmitter=new ru,this._checkStep=(e,t)=>this._checkStepEvent(e,t)&&this._checkStepUrl(e,t)&&this._checkStepElement(e,t),this._checkStepEvent=(e,t)=>null==t||!t.event||(null==e?void 0:e.event)===(null==t?void 0:t.event),this._instance=e,this._actionEvents=new Set,this._actionRegistry=new Set}init(){var e,t;Us(null==(e=this._instance)?void 0:e._addCaptureHook)||null==(t=this._instance)||t._addCaptureHook((e,t)=>{this.on(e,t)})}register(e){var t,i;if(!Us(null==(t=this._instance)?void 0:t._addCaptureHook)&&(e.forEach(e=>{var t,i;null==(t=this._actionRegistry)||t.add(e),null==(i=e.steps)||i.forEach(e=>{var t;null==(t=this._actionEvents)||t.add((null==e?void 0:e.event)||"")})}),null!=(i=this._instance)&&i.autocapture)){var n,s=new Set;e.forEach(e=>{var t;null==(t=e.steps)||t.forEach(e=>{null!=e&&e.selector&&s.add(null==e?void 0:e.selector)})}),null==(n=this._instance)||n.autocapture.setElementSelectors(s)}}on(e,t){var i;null!=t&&0!=e.length&&(this._actionEvents.has(e)||this._actionEvents.has(null==t?void 0:t.event))&&this._actionRegistry&&(null==(i=this._actionRegistry)?void 0:i.size)>0&&this._actionRegistry.forEach(e=>{this._checkAction(t,e)&&this._debugEventEmitter.emit("actionCaptured",e.name)})}_addActionHook(e){this.onAction("actionCaptured",t=>e(t))}_checkAction(e,t){if(null==(null==t?void 0:t.steps))return!1;for(var i of t.steps)if(this._checkStep(e,i))return!0;return!1}onAction(e,t){return this._debugEventEmitter.on(e,t)}_checkStepUrl(e,t){if(null!=t&&t.url){var i,n=null==e||null==(i=e.properties)?void 0:i.$current_url;if(!n||"string"!=typeof n)return!1;if(!ou._matchString(n,null==t?void 0:t.url,(null==t?void 0:t.url_matching)||"contains"))return!1}return!0}static _matchString(e,t,i){switch(i){case"regex":return!!gs&&Fc(e,t);case"exact":return t===e;case"contains":var n=ou._escapeStringRegexp(t).replace(/_/g,".").replace(/%/g,".*");return Fc(e,n);default:return!1}}static _escapeStringRegexp(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}_checkStepElement(e,t){if((null!=t&&t.href||null!=t&&t.tag_name||null!=t&&t.text)&&!this._getElementsList(e).some(e=>!(null!=t&&t.href&&!ou._matchString(e.href||"",null==t?void 0:t.href,(null==t?void 0:t.href_matching)||"exact")||null!=t&&t.tag_name&&e.tag_name!==(null==t?void 0:t.tag_name)||null!=t&&t.text&&!ou._matchString(e.text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact")&&!ou._matchString(e.$el_text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact"))))return!1;if(null!=t&&t.selector){var i,n=null==e||null==(i=e.properties)?void 0:i.$element_selectors;if(!n)return!1;if(!n.includes(null==t?void 0:t.selector))return!1}return!0}_getElementsList(e){return null==(null==e?void 0:e.properties.$elements)?[]:null==e?void 0:e.properties.$elements}}var au=er("[Surveys]"),lu="seenSurvey_",cu=(e,t)=>{var i="$survey_"+t+"/"+e.id;return e.current_iteration&&e.current_iteration>0&&(i="$survey_"+t+"/"+e.id+"/"+e.current_iteration),i};class du{constructor(e){this._instance=e,this._eventToSurveys=new Map,this._actionToSurveys=new Map}register(e){var t;Us(null==(t=this._instance)?void 0:t._addCaptureHook)||(this._setupEventBasedSurveys(e),this._setupActionBasedSurveys(e))}_setupActionBasedSurveys(e){var t=e.filter(e=>{var t,i;return(null==(t=e.conditions)?void 0:t.actions)&&(null==(i=e.conditions)||null==(i=i.actions)||null==(i=i.values)?void 0:i.length)>0});0!==t.length&&(null==this._actionMatcher&&(this._actionMatcher=new ou(this._instance),this._actionMatcher.init(),this._actionMatcher._addActionHook(e=>{this.onAction(e)})),t.forEach(e=>{var t,i,n,s,r;e.conditions&&null!=(t=e.conditions)&&t.actions&&null!=(i=e.conditions)&&null!=(i=i.actions)&&i.values&&(null==(n=e.conditions)||null==(n=n.actions)||null==(n=n.values)?void 0:n.length)>0&&(null==(s=this._actionMatcher)||s.register(e.conditions.actions.values),null==(r=e.conditions)||null==(r=r.actions)||null==(r=r.values)||r.forEach(t=>{if(t&&t.name){var i=this._actionToSurveys.get(t.name);i&&i.push(e.id),this._actionToSurveys.set(t.name,i||[e.id])}}))}))}_setupEventBasedSurveys(e){var t;0!==e.filter(e=>{var t,i;return(null==(t=e.conditions)?void 0:t.events)&&(null==(i=e.conditions)||null==(i=i.events)||null==(i=i.values)?void 0:i.length)>0}).length&&(null==(t=this._instance)||t._addCaptureHook((e,t)=>{this.onEvent(e,t)}),e.forEach(e=>{var t;null==(t=e.conditions)||null==(t=t.events)||null==(t=t.values)||t.forEach(t=>{if(t&&t.name){var i=this._eventToSurveys.get(t.name);i&&i.push(e.id),this._eventToSurveys.set(t.name,i||[e.id])}})}))}onEvent(e,t){var i,n=(null==(i=this._instance)||null==(i=i.persistence)?void 0:i.props[jr])||[];if("survey shown"===e&&t&&n.length>0){var s;au.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:n});var r=null==t||null==(s=t.properties)?void 0:s.$survey_id;if(r){var o=n.indexOf(r);o>=0&&(n.splice(o,1),this._updateActivatedSurveys(n))}}else this._eventToSurveys.has(e)&&(au.info("survey event matched, updating activated surveys",{event:e,surveys:this._eventToSurveys.get(e)}),this._updateActivatedSurveys(n.concat(this._eventToSurveys.get(e)||[])))}onAction(e){var t,i=(null==(t=this._instance)||null==(t=t.persistence)?void 0:t.props[jr])||[];this._actionToSurveys.has(e)&&this._updateActivatedSurveys(i.concat(this._actionToSurveys.get(e)||[]))}_updateActivatedSurveys(e){var t;null==(t=this._instance)||null==(t=t.persistence)||t.register({[jr]:[...new Set(e)]})}getSurveys(){var e;return(null==(e=this._instance)||null==(e=e.persistence)?void 0:e.props[jr])||[]}getEventToSurveys(){return this._eventToSurveys}_getActionMatcher(){return this._actionMatcher}}class uu{constructor(e){this._isSurveysEnabled=void 0,this._surveyManager=null,this._isFetchingSurveys=!1,this._isInitializingSurveys=!1,this._surveyCallbacks=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){var t=e.surveys;if(Ys(t))return au.warn("Flags not loaded yet. Not loading surveys.");var i=Bs(t);this._isSurveysEnabled=i?t.length>0:t,au.info("flags response received, isSurveysEnabled: "+this._isSurveysEnabled),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var i=localStorage.key(t);(null!=i&&i.startsWith(lu)||null!=i&&i.startsWith("inProgressSurvey_"))&&e.push(i)}e.forEach(e=>localStorage.removeItem(e))}loadIfEnabled(){if(!this._surveyManager)if(this._isInitializingSurveys)au.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)au.info("Disabled. Not loading surveys.");else{var e=null==Es?void 0:Es.__PosthogExtensions__;if(e){var t=this._isSurveysEnabled;if(!Us(t)){this._isInitializingSurveys=!0;try{var i=e.generateSurveys;if(i)return void this._completeSurveyInitialization(i,t);var n=e.loadExternalDependency;if(!n)return void this._handleSurveyLoadError("PostHog loadExternalDependency extension not found.");n(this._instance,"surveys",i=>{i||!e.generateSurveys?this._handleSurveyLoadError("Could not load surveys script",i):this._completeSurveyInitialization(e.generateSurveys,t)})}catch(e){throw this._handleSurveyLoadError("Error initializing surveys",e),e}finally{this._isInitializingSurveys=!1}}}else au.error("PostHog Extensions not found.")}}_completeSurveyInitialization(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new du(this._instance),au.info("Surveys loaded successfully"),this._notifySurveyCallbacks({isLoaded:!0})}_handleSurveyLoadError(e,t){au.error(e,t),this._notifySurveyCallbacks({isLoaded:!1,error:e})}onSurveysLoaded(e){return this._surveyCallbacks.push(e),this._surveyManager&&this._notifySurveyCallbacks({isLoaded:!0}),()=>{this._surveyCallbacks=this._surveyCallbacks.filter(t=>t!==e)}}getSurveys(e,t){if(void 0===t&&(t=!1),this._instance.config.disable_surveys)return au.info("Disabled. Not loading surveys."),e([]);var i=this._instance.get_property(qr);if(i&&!t)return e(i,{isLoaded:!0});if(this._isFetchingSurveys)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this._isFetchingSurveys=!0,this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:t=>{var i;this._isFetchingSurveys=!1;var n=t.statusCode;if(200!==n||!t.json){var s="Surveys API could not be loaded, status: "+n;return au.error(s),e([],{isLoaded:!1,error:s})}var r,o=t.json.surveys||[],a=o.filter(e=>function(e){return!(!e.start_date||e.end_date)}(e)&&(function(e){var t;return!(null==(t=e.conditions)||null==(t=t.events)||null==(t=t.values)||!t.length)}(e)||function(e){var t;return!(null==(t=e.conditions)||null==(t=t.actions)||null==(t=t.values)||!t.length)}(e)));return a.length>0&&(null==(r=this._surveyEventReceiver)||r.register(a)),null==(i=this._instance.persistence)||i.register({[qr]:o}),e(o,{isLoaded:!0})}})}catch(e){throw this._isFetchingSurveys=!1,e}}_notifySurveyCallbacks(e){for(var t of this._surveyCallbacks)try{e.isLoaded?this.getSurveys(t):t([],e)}catch(e){au.error("Error in survey callback",e)}}getActiveMatchingSurveys(e,t){if(void 0===t&&(t=!1),!Ys(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);au.warn("init was not called")}_getSurveyById(e){var t=null;return this.getSurveys(i=>{var n;t=null!==(n=i.find(t=>t.id===e))&&void 0!==n?n:null}),t}_checkSurveyEligibility(e){if(Ys(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t="string"==typeof e?this._getSurveyById(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(Ys(this._surveyManager))return au.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this._checkSurveyEligibility(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return Ys(this._surveyManager)?(au.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(i=>{this.getSurveys(t=>{var n,s=null!==(n=t.find(t=>t.id===e))&&void 0!==n?n:null;if(s){var r=this._checkSurveyEligibility(s);i({visible:r.eligible,disabledReason:r.reason})}else i({visible:!1,disabledReason:"Survey not found"})},t)})}renderSurvey(e,t){if(Ys(this._surveyManager))au.warn("init was not called");else{var i=this._getSurveyById(e),n=null==ws?void 0:ws.querySelector(t);i?n?this._surveyManager.renderSurvey(i,n):au.warn("Survey element not found"):au.warn("Survey not found")}}}(function(e){e.Button="button",e.Tab="tab",e.Selector="selector"})({}),function(e){e.TopLeft="top_left",e.TopRight="top_right",e.TopCenter="top_center",e.MiddleLeft="middle_left",e.MiddleRight="middle_right",e.MiddleCenter="middle_center",e.Left="left",e.Center="center",e.Right="right",e.NextToTrigger="next_to_trigger"}({}),function(e){e.Popover="popover",e.API="api",e.Widget="widget"}({}),function(e){e.Open="open",e.MultipleChoice="multiple_choice",e.SingleChoice="single_choice",e.Rating="rating",e.Link="link"}({}),function(e){e.NextQuestion="next_question",e.End="end",e.ResponseBased="response_based",e.SpecificQuestion="specific_question"}({}),function(e){e.Once="once",e.Recurring="recurring",e.Always="always"}({});var hu=function(e){return e.SHOWN="survey shown",e.DISMISSED="survey dismissed",e.SENT="survey sent",e}({}),pu=function(e){return e.SURVEY_ID="$survey_id",e.SURVEY_NAME="$survey_name",e.SURVEY_RESPONSE="$survey_response",e.SURVEY_ITERATION="$survey_iteration",e.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",e.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",e.SURVEY_SUBMISSION_ID="$survey_submission_id",e.SURVEY_QUESTIONS="$survey_questions",e.SURVEY_COMPLETED="$survey_completed",e}({}),fu=er("[RateLimiter]");class gu{constructor(e){var t,i;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=e=>{var t=e.text;if(t&&t.length)try{(JSON.parse(t).quota_limited||[]).forEach(e=>{fu.info((e||"events")+" is quota limited."),this.serverLimits[e]=(new Date).getTime()+6e4})}catch(e){return void fu.warn('could not rate limit - continuing. Error: "'+(null==e?void 0:e.message)+'"',{text:t})}},this.instance=e,this.captureEventsPerSecond=(null==(t=e.config.rate_limiting)?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null==(i=e.config.rate_limiting)?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,i,n;void 0===e&&(e=!1);var s=(new Date).getTime(),r=null!==(t=null==(i=this.instance.persistence)?void 0:i.get_property(Vr))&&void 0!==t?t:{tokens:this.captureEventsBurstLimit,last:s};r.tokens+=(s-r.last)/1e3*this.captureEventsPerSecond,r.last=s,r.tokens>this.captureEventsBurstLimit&&(r.tokens=this.captureEventsBurstLimit);var o=r.tokens<1;return o||e||(r.tokens=Math.max(0,r.tokens-1)),!o||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,null==(n=this.instance.persistence)||n.set_property(Vr,r),{isRateLimited:o,remainingTokens:r.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return!1!==t&&(new Date).getTime()<t}}var vu=er("[RemoteConfig]");class _u{constructor(e){this._instance=e}get remoteConfig(){var e;return null==(e=Es._POSTHOG_REMOTE_CONFIG)||null==(e=e[this._instance.config.token])?void 0:e.config}_loadRemoteConfigJs(e){var t,i;null!=(t=Es.__PosthogExtensions__)&&t.loadExternalDependency?null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(vu.error("PostHog Extensions not found. Cannot load remote config."),e())}_loadRemoteConfigJSON(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return vu.info("Using preloaded remote config",this.remoteConfig),void this._onRemoteConfig(this.remoteConfig);if(this._instance._shouldDisableFlags())return void vu.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs(e=>{if(!e)return vu.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON(e=>{this._onRemoteConfig(e)});this._onRemoteConfig(e)})}catch(e){vu.error("Error loading remote config",e)}}_onRemoteConfig(e){e?this._instance.config.__preview_remote_config?(this._instance._onRemoteConfig(e),!1!==e.hasFeatureFlags&&this._instance.featureFlags.ensureFlagsLoaded()):vu.info("__preview_remote_config is disabled. Logging config instead",e):vu.error("Failed to fetch remote config from PostHog.")}}var mu=3e3;class yu{constructor(e,t){this._isPaused=!0,this._queue=[],this._flushTimeoutMs=ca((null==t?void 0:t.flush_interval_ms)||mu,250,5e3,"flush interval",mu),this._sendRequest=e}enqueue(e){this._queue.push(e),this._flushTimeout||this._setFlushTimeout()}unload(){this._clearFlushTimeout();var e=this._queue.length>0?this._formatQueue():{},t=Object.values(e);[...t.filter(e=>0===e.url.indexOf("/e")),...t.filter(e=>0!==e.url.indexOf("/e"))].map(e=>{this._sendRequest(ps({},e,{transport:"sendBeacon"}))})}enable(){this._isPaused=!1,this._setFlushTimeout()}_setFlushTimeout(){var e=this;this._isPaused||(this._flushTimeout=setTimeout(()=>{if(this._clearFlushTimeout(),this._queue.length>0){var t=this._formatQueue(),i=function(){var i=t[n],s=(new Date).getTime();i.data&&Bs(i.data)&&nr(i.data,e=>{e.offset=Math.abs(e.timestamp-s),delete e.timestamp}),e._sendRequest(i)};for(var n in t)i()}},this._flushTimeoutMs))}_clearFlushTimeout(){clearTimeout(this._flushTimeout),this._flushTimeout=void 0}_formatQueue(){var e={};return nr(this._queue,t=>{var i,n=t,s=(n?n.batchKey:null)||n.url;Us(e[s])&&(e[s]=ps({},n,{data:[]})),null==(i=e[s].data)||i.push(n.data)}),this._queue=[],e}}var bu=["retriesPerformedSoFar"];class wu{constructor(e){this._isPolling=!1,this._pollIntervalMs=3e3,this._queue=[],this._instance=e,this._queue=[],this._areWeOnline=!0,!Us(gs)&&"onLine"in gs.navigator&&(this._areWeOnline=gs.navigator.onLine,pr(gs,"online",()=>{this._areWeOnline=!0,this._flush()}),pr(gs,"offline",()=>{this._areWeOnline=!1}))}get length(){return this._queue.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,i=fs(e,bu);Xs(t)&&t>0&&(i.url=Cc(i.url,{retry_count:t})),this._instance._send_request(ps({},i,{callback:e=>{200!==e.statusCode&&(e.statusCode<400||e.statusCode>=500)&&(null!=t?t:0)<10?this._enqueue(ps({retriesPerformedSoFar:t},i)):null==i.callback||i.callback(e)}}))}_enqueue(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var i=function(e){var t=3e3*Math.pow(2,e),i=t/2,n=Math.min(18e5,t),s=(Math.random()-.5)*(n-i);return Math.ceil(n+s)}(t),n=Date.now()+i;this._queue.push({retryAt:n,requestOptions:e});var s="Enqueued failed request for retry in "+i;navigator.onLine||(s+=" (Browser is offline)"),Zs.warn(s),this._isPolling||(this._isPolling=!0,this._poll())}_poll(){this._poller&&clearTimeout(this._poller),this._poller=setTimeout(()=>{this._areWeOnline&&this._queue.length>0&&this._flush(),this._poll()},this._pollIntervalMs)}_flush(){var e=Date.now(),t=[],i=this._queue.filter(i=>i.retryAt<e||(t.push(i),!1));if(this._queue=t,i.length>0)for(var{requestOptions:n}of i)this.retriableRequest(n)}unload(){for(var{requestOptions:e}of(this._poller&&(clearTimeout(this._poller),this._poller=void 0),this._queue))try{this._instance._send_request(ps({},e,{transport:"sendBeacon"}))}catch(e){Zs.error(e)}this._queue=[]}}class xu{constructor(e){this._updateScrollData=()=>{var e,t,i,n;this._context||(this._context={});var s=this.scrollElement(),r=this.scrollY(),o=s?Math.max(0,s.scrollHeight-s.clientHeight):0,a=r+((null==s?void 0:s.clientHeight)||0),l=(null==s?void 0:s.scrollHeight)||0;this._context.lastScrollY=Math.ceil(r),this._context.maxScrollY=Math.max(r,null!==(e=this._context.maxScrollY)&&void 0!==e?e:0),this._context.maxScrollHeight=Math.max(o,null!==(t=this._context.maxScrollHeight)&&void 0!==t?t:0),this._context.lastContentY=a,this._context.maxContentY=Math.max(a,null!==(i=this._context.maxContentY)&&void 0!==i?i:0),this._context.maxContentHeight=Math.max(l,null!==(n=this._context.maxContentHeight)&&void 0!==n?n:0)},this._instance=e}getContext(){return this._context}resetContext(){var e=this._context;return setTimeout(this._updateScrollData,0),e}startMeasuringScrollPosition(){pr(gs,"scroll",this._updateScrollData,{capture:!0}),pr(gs,"scrollend",this._updateScrollData,{capture:!0}),pr(gs,"resize",this._updateScrollData)}scrollElement(){if(!this._instance.config.scroll_root_selector)return null==gs?void 0:gs.document.documentElement;var e=Bs(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var i=null==gs?void 0:gs.document.querySelector(t);if(i)return i}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return gs&&(gs.scrollY||gs.pageYOffset||gs.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return gs&&(gs.scrollX||gs.pageXOffset||gs.document.documentElement.scrollLeft)||0}}var ku=e=>Nd(null==e?void 0:e.config.mask_personal_data_properties,null==e?void 0:e.config.custom_personal_data_properties);class Su{constructor(e,t,i,n){this._onSessionIdCallback=e=>{var t=this._getStored();if(!t||t.sessionId!==e){var i={sessionId:e,props:this._sessionSourceParamGenerator(this._instance)};this._persistence.register({[Hr]:i})}},this._instance=e,this._sessionIdManager=t,this._persistence=i,this._sessionSourceParamGenerator=n||ku,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStored(){return this._persistence.props[Hr]}getSetOnceProps(){var e,t=null==(e=this._getStored())?void 0:e.props;return t?"r"in t?Ud(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return nr(cr(this.getSetOnceProps()),(t,i)=>{"$current_url"===i&&(i="url"),e["$session_entry_"+Ds(i)]=t}),e}}var Pu=er("[SessionId]");class Tu{constructor(e,t,i){var n;if(this._sessionIdChangedHandlers=[],!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this._config=e.config,this._persistence=e.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=t||Uo,this._windowIdGenerator=i||Uo;var s=this._config.persistence_name||this._config.token,r=this._config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*ca(r,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this._resetIdleTimer(),this._window_id_storage_key="ph_"+s+"_window_id",this._primary_window_exists_storage_key="ph_"+s+"_primary_window_exists",this._canUseSessionStorage()){var o=ia._parse(this._window_id_storage_key),a=ia._parse(this._primary_window_exists_storage_key);o&&!a?this._windowId=o:ia._remove(this._window_id_storage_key),ia._set(this._primary_window_exists_storage_key,!0)}if(null!=(n=this._config.bootstrap)&&n.sessionID)try{var l=(()=>{var e=this._config.bootstrap.sessionID.replace(/-/g,"");if(32!==e.length)throw new Error("Not a valid UUID");if("7"!==e[12])throw new Error("Not a UUIDv7");return parseInt(e.substring(0,12),16)})();this._setSessionId(this._config.bootstrap.sessionID,(new Date).getTime(),l)}catch(e){Pu.error("Invalid sessionID in bootstrap",e)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Us(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter(t=>t!==e)}}_canUseSessionStorage(){return"memory"!==this._config.persistence&&!this._persistence._disabled&&ia._is_supported()}_setWindowId(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&ia._set(this._window_id_storage_key,e))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?ia._parse(this._window_id_storage_key):null}_setSessionId(e,t,i){e===this._sessionId&&t===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=t,this._sessionId=e,this._persistence.register({[Fr]:[t,e,i]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this._persistence.props[Fr];return Bs(e)&&2===e.length&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}_listenToReloadWindow(){pr(gs,"beforeunload",()=>{this._canUseSessionStorage()&&ia._remove(this._primary_window_exists_storage_key)},{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=null),this._config.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var i=t||(new Date).getTime(),[n,s,r]=this._getSessionId(),o=this._getWindowId(),a=Xs(r)&&r>0&&Math.abs(i-r)>864e5,l=!1,c=!s,d=!e&&Math.abs(i-n)>this.sessionTimeoutMs;c||d||a?(s=this._sessionIdGenerator(),o=this._windowIdGenerator(),Pu.info("new session ID generated",{sessionId:s,windowId:o,changeReason:{noSessionId:c,activityTimeout:d,sessionPastMaximumLength:a}}),r=i,l=!0):o||(o=this._windowIdGenerator(),l=!0);var u=0===n||!e||a?i:n,h=0===r?(new Date).getTime():r;return this._setWindowId(o),this._setSessionId(s,u,h),e||this._resetIdleTimer(),l&&this._sessionIdChangedHandlers.forEach(e=>e(s,o,l?{noSessionId:c,activityTimeout:d,sessionPastMaximumLength:a}:void 0)),{sessionId:s,windowId:o,sessionStartTimestamp:h,changeReason:l?{noSessionId:c,activityTimeout:d,sessionPastMaximumLength:a}:void 0,lastActivityTimestamp:n}}_resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var Eu=["$set_once","$set"],Cu=er("[SiteApps]");class Iu{constructor(e){this._instance=e,this._bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}_eventCollector(e,t){if(t){var i=this.globalsForEvent(t);this._bufferedInvocations.push(i),this._bufferedInvocations.length>1e3&&(this._bufferedInvocations=this._bufferedInvocations.slice(10))}}get siteAppLoaders(){var e;return null==(e=Es._POSTHOG_REMOTE_CONFIG)||null==(e=e[this._instance.config.token])?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this._eventCollector.bind(this));this._stopBuffering=()=>{e(),this._bufferedInvocations=[],this._stopBuffering=void 0}}}globalsForEvent(e){var t,i,n,s,r,o,a;if(!e)throw new Error("Event payload is required");var l={},c=this._instance.get_property("$groups")||[],d=this._instance.get_property("$stored_group_properties")||{};for(var[u,h]of Object.entries(d))l[u]={id:c[u],type:u,properties:h};var{$set_once:p,$set:f}=e;return{event:ps({},fs(e,Eu),{properties:ps({},e.properties,f?{$set:ps({},null!==(t=null==(i=e.properties)?void 0:i.$set)&&void 0!==t?t:{},f)}:{},p?{$set_once:ps({},null!==(n=null==(s=e.properties)?void 0:s.$set_once)&&void 0!==n?n:{},p)}:{}),elements_chain:null!==(r=null==(o=e.properties)?void 0:o.$elements_chain)&&void 0!==r?r:"",distinct_id:null==(a=e.properties)?void 0:a.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:l}}setupSiteApp(e){var t=this.apps[e.id],i=()=>{var i;!t.errored&&this._bufferedInvocations.length&&(Cu.info("Processing "+this._bufferedInvocations.length+" events for site app with id "+e.id),this._bufferedInvocations.forEach(e=>null==t.processEvent?void 0:t.processEvent(e)),t.processedBuffer=!0),Object.values(this.apps).every(e=>e.processedBuffer||e.errored)&&(null==(i=this._stopBuffering)||i.call(this))},n=!1,s=s=>{t.errored=!s,t.loaded=!0,Cu.info("Site app with id "+e.id+" "+(s?"loaded":"errored")),n&&i()};try{var{processEvent:r}=e.init({posthog:this._instance,callback:e=>{s(e)}});r&&(t.processEvent=r),n=!0}catch(t){Cu.error("Error while initializing PostHog app with config id "+e.id,t),s(!1)}if(n&&t.loaded)try{i()}catch(i){Cu.error("Error while processing buffered events PostHog app with config id "+e.id,i),t.errored=!0}}_setupSiteApps(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var i of e)this.setupSiteApp(i)}_onCapturedEvent(e){if(0!==Object.keys(this.apps).length){var t=this.globalsForEvent(e);for(var i of Object.values(this.apps))try{null==i.processEvent||i.processEvent(t)}catch(t){Cu.error("Error while processing event "+e.event+" for site app "+i.id,t)}}}onRemoteConfig(e){var t,i,n,s=this;if(null!=(t=this.siteAppLoaders)&&t.length)return this.isEnabled?(this._setupSiteApps(),void this._instance.on("eventCaptured",e=>this._onCapturedEvent(e))):void Cu.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if(null==(i=this._stopBuffering)||i.call(this),null!=(n=e.siteApps)&&n.length)if(this.isEnabled){var r=function(e){var t;Es["__$$ph_site_app_"+e]=s._instance,null==(t=Es.__PosthogExtensions__)||null==t.loadSiteApp||t.loadSiteApp(s._instance,a,t=>{if(t)return Cu.error("Error while initializing PostHog app with config id "+e,t)})};for(var{id:o,url:a}of e.siteApps)r(o)}else Cu.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var Mu=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],Ru=function(e,t){if(!e)return!1;var i=e.toLowerCase();return Mu.concat(t||[]).some(e=>{var t=e.toLowerCase();return-1!==i.indexOf(t)})},Fu=function(e,t){if(!e)return!1;var i=e.userAgent;if(i&&Ru(i,t))return!0;try{var n=null==e?void 0:e.userAgentData;if(null!=n&&n.brands&&n.brands.some(e=>Ru(null==e?void 0:e.brand,t)))return!0}catch(e){}return!!e.webdriver},Ou=function(e){return e.US="us",e.EU="eu",e.CUSTOM="custom",e}({}),Lu="i.posthog.com";class Du{constructor(e){this._regionCache={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===e?"https://us.i.posthog.com":e}get uiHost(){var e,t=null==(e=this.instance.config.ui_host)?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+Lu,".posthog.com")),"https://app.posthog.com"===t?"https://us.posthog.com":t}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Ou.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Ou.EU:this._regionCache[this.apiHost]=Ou.CUSTOM),this._regionCache[this.apiHost]}endpointFor(e,t){if(void 0===t&&(t=""),t&&(t="/"===t[0]?t:"/"+t),"ui"===e)return this.uiHost+t;if(this.region===Ou.CUSTOM)return this.apiHost+t;var i=Lu+t;switch(e){case"assets":return"https://"+this.region+"-assets."+i;case"api":return"https://"+this.region+"."+i}}}var zu={icontains:(e,t)=>!!gs&&t.href.toLowerCase().indexOf(e.toLowerCase())>-1,not_icontains:(e,t)=>!!gs&&-1===t.href.toLowerCase().indexOf(e.toLowerCase()),regex:(e,t)=>!!gs&&Fc(t.href,e),not_regex:(e,t)=>!!gs&&!Fc(t.href,e),exact:(e,t)=>t.href===e,is_not:(e,t)=>t.href!==e};class Gu{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(e){void 0===e&&(e=!1),t.getWebExperiments(e=>{Gu._logInfo("retrieved web experiments from the server"),t._flagToExperiments=new Map,e.forEach(e=>{if(e.feature_flag_key){var i;t._flagToExperiments&&(Gu._logInfo("setting flag key ",e.feature_flag_key," to web experiment ",e),null==(i=t._flagToExperiments)||i.set(e.feature_flag_key,e));var n=t._instance.getFeatureFlag(e.feature_flag_key);Hs(n)&&e.variants[n]&&t._applyTransforms(e.name,n,e.variants[n].transforms)}else if(e.variants)for(var s in e.variants){var r=e.variants[s];Gu._matchesTestVariant(r)&&t._applyTransforms(e.name,s,r.transforms)}})},e)},this._instance=e,this._instance.onFeatureFlags(e=>{this.onFeatureFlags(e)})}onFeatureFlags(e){if(this._is_bot())Gu._logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(Ys(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Gu._logInfo("applying feature flags",e),e.forEach(e=>{var t;if(this._flagToExperiments&&null!=(t=this._flagToExperiments)&&t.has(e)){var i,n=this._instance.getFeatureFlag(e),s=null==(i=this._flagToExperiments)?void 0:i.get(e);n&&null!=s&&s.variants[n]&&this._applyTransforms(s.name,n,s.variants[n].transforms)}})}}previewWebExperiment(){var e=Gu.getWindowLocation();if(null!=e&&e.search){var t=Ro(null==e?void 0:e.search,"__experiment_id"),i=Ro(null==e?void 0:e.search,"__experiment_variant");t&&i&&(Gu._logInfo("previewing web experiments "+t+" && "+i),this.getWebExperiments(e=>{this._showPreviewWebExperiment(parseInt(t),i,e)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,i){if(this._instance.config.disable_web_experiments&&!i)return e([]);var n=this._instance.get_property("$web_experiments");if(n&&!t)return e(n);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:t=>{if(200!==t.statusCode||!t.json)return e([]);var i=t.json.experiments||[];return e(i)}})}_showPreviewWebExperiment(e,t,i){var n=i.filter(t=>t.id===e);n&&n.length>0&&(Gu._logInfo("Previewing web experiment ["+n[0].name+"] with variant ["+t+"]"),this._applyTransforms(n[0].name,t,n[0].variants[t].transforms))}static _matchesTestVariant(e){return!Ys(e.conditions)&&Gu._matchUrlConditions(e)&&Gu._matchUTMConditions(e)}static _matchUrlConditions(e){var t;if(Ys(e.conditions)||Ys(null==(t=e.conditions)?void 0:t.url))return!0;var i,n,s,r=Gu.getWindowLocation();return!!r&&(null==(i=e.conditions)||!i.url||zu[null!==(n=null==(s=e.conditions)?void 0:s.urlMatchType)&&void 0!==n?n:"icontains"](e.conditions.url,r))}static getWindowLocation(){return null==gs?void 0:gs.location}static _matchUTMConditions(e){var t;if(Ys(e.conditions)||Ys(null==(t=e.conditions)?void 0:t.utm))return!0;var i=Ad();if(i.utm_source){var n,s,r,o,a,l,c,d,u=null==(n=e.conditions)||null==(n=n.utm)||!n.utm_campaign||(null==(s=e.conditions)||null==(s=s.utm)?void 0:s.utm_campaign)==i.utm_campaign,h=null==(r=e.conditions)||null==(r=r.utm)||!r.utm_source||(null==(o=e.conditions)||null==(o=o.utm)?void 0:o.utm_source)==i.utm_source,p=null==(a=e.conditions)||null==(a=a.utm)||!a.utm_medium||(null==(l=e.conditions)||null==(l=l.utm)?void 0:l.utm_medium)==i.utm_medium,f=null==(c=e.conditions)||null==(c=c.utm)||!c.utm_term||(null==(d=e.conditions)||null==(d=d.utm)?void 0:d.utm_term)==i.utm_term;return u&&p&&f&&h}return!1}static _logInfo(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];Zs.info("[WebExperiments] "+e,i)}_applyTransforms(e,t,i){this._is_bot()?Gu._logInfo("Refusing to render web experiment since the viewer is a likely bot"):"control"!==t?i.forEach(i=>{if(i.selector){var n;Gu._logInfo("applying transform of variant "+t+" for experiment "+e+" ",i);var s=null==(n=document)?void 0:n.querySelectorAll(i.selector);null==s||s.forEach(e=>{var t=e;i.html&&(t.innerHTML=i.html),i.css&&t.setAttribute("style",i.css)})}}):Gu._logInfo("Control variants leave the page unmodified.")}_is_bot(){return bs&&this._instance?Fu(bs,this._instance.config.custom_blocked_useragents):void 0}}var Au=er("[PostHog ExternalIntegrations]"),$u={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class Bu{constructor(e){this._instance=e}_loadScript(e,t){var i;null==(i=Es.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,e,e=>{if(e)return Au.error("failed to load script",e);t()})}startIfEnabledOrStop(){var e=this,t=function(t){var i,s,r;!n||null!=(i=Es.__PosthogExtensions__)&&null!=(i=i.integrations)&&i[t]||e._loadScript($u[t],()=>{var i;null==(i=Es.__PosthogExtensions__)||null==(i=i.integrations)||null==(i=i[t])||i.start(e._instance)}),!n&&null!=(s=Es.__PosthogExtensions__)&&null!=(s=s.integrations)&&s[t]&&(null==(r=Es.__PosthogExtensions__)||null==(r=r.integrations)||null==(r=r[t])||r.stop())};for(var[i,n]of Object.entries(null!==(s=this._instance.config.integrations)&&void 0!==s?s:{})){var s;t(i)}}}var qu={},ju=()=>{},Nu="posthog",Uu=!Tc&&-1===(null==Ts?void 0:Ts.indexOf("MSIE"))&&-1===(null==Ts?void 0:Ts.indexOf("Mozilla")),Hu=e=>{var t;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:ur(null==ws?void 0:ws.location),persistence:"localStorage+cookie",persistence_name:"",loaded:ju,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:"2025-05-24"!==e||"history_change",capture_pageleave:"if_capture_pageview",defaults:null!=e?e:"unset",debug:xs&&Hs(null==xs?void 0:xs.search)&&-1!==xs.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==gs||null==(t=gs.location)?void 0:t.protocol),ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:e=>{var t="Bad HTTP status: "+e.statusCode+" "+e.text;Zs.error(t)},get_device_id:e=>e,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:mu},error_tracking:{},_onCapture:ju}},Vu=e=>{var t={};Us(e.process_person)||(t.person_profiles=e.process_person),Us(e.xhr_headers)||(t.request_headers=e.xhr_headers),Us(e.cookie_name)||(t.persistence_name=e.cookie_name),Us(e.disable_cookie)||(t.disable_persistence=e.disable_cookie),Us(e.store_google)||(t.save_campaign_params=e.store_google),Us(e.verbose)||(t.debug=e.verbose);var i=sr({},t,e);return Bs(e.property_blacklist)&&(Us(e.property_denylist)?i.property_denylist=e.property_blacklist:Bs(e.property_denylist)?i.property_denylist=[...e.property_blacklist,...e.property_denylist]:Zs.error("Invalid value for property_denylist config: "+e.property_denylist)),i};class Wu{constructor(){this.__forceAllowLocalhost=!1}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(e){Zs.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Yu{get decideEndpointWasHit(){var e,t;return null!==(e=null==(t=this.featureFlags)?void 0:t.hasLoadedFlags)&&void 0!==e&&e}get flagsEndpointWasHit(){var e,t;return null!==(e=null==(t=this.featureFlags)?void 0:t.hasLoadedFlags)&&void 0!==e&&e}constructor(){this.webPerformance=new Wu,this._personProcessingSetOncePropertiesSent=!1,this.version=Cs.LIB_VERSION,this._internalEventEmitter=new ru,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=Hu(),this.SentryIntegration=uc,this.sentryIntegration=e=>function(e,t){var i=dc(e,t);return{name:cc,processEvent:e=>i(e)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._visibilityStateListener=null,this._initialPersonProfilesConfig=null,this._cachedPersonProperties=null,this.featureFlags=new iu(this),this.toolbar=new vc(this),this.scrollManager=new xu(this),this.pageViewManager=new Pc(this),this.surveys=new uu(this),this.experiments=new Gu(this),this.exceptions=new Gc(this),this.rateLimiter=new gu(this),this.requestRouter=new Du(this),this.consent=new sa(this),this.externalIntegrations=new Bu(this),this.people={set:(e,t,i)=>{var n=Hs(e)?{[e]:t}:e;this.setPersonProperties(n),null==i||i({})},set_once:(e,t,i)=>{var n=Hs(e)?{[e]:t}:e;this.setPersonProperties(void 0,n),null==i||i({})}},this.on("eventCaptured",e=>Zs.info('send "'+(null==e?void 0:e.event)+'"',e))}init(e,t,i){if(i&&i!==Nu){var n,s=null!==(n=qu[i])&&void 0!==n?n:new Yu;return s._init(e,t,i),qu[i]=s,qu[Nu][i]=s,s}return this._init(e,t,i)}_init(e,t,i){var n,s;if(void 0===t&&(t={}),Us(e)||Vs(e))return Zs.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return Zs.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this._originalUserConfig=t,this._triggered_notifs=[],t.person_profiles&&(this._initialPersonProfilesConfig=t.person_profiles),this.set_config(sr({},Hu(t.defaults),Vu(t),{name:i,token:e})),this.config.on_xhr_error&&Zs.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Rs.GZipJS;var r=this._is_persistence_disabled();this.persistence=new su(this.config,r),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new su(ps({},this.config,{persistence:"sessionStorage"}),r);var o=ps({},this.persistence.props),a=ps({},this.sessionPersistence.props);if(this.register({$initialization_time:(new Date).toISOString()}),this._requestQueue=new yu(e=>this._send_retriable_request(e),this.config.request_queue_config),this._retryQueue=new wu(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new Tu(this),this.sessionPropsManager=new Su(this,this.sessionManager,this.persistence)),new mc(this).startIfEnabledOrStop(),this.siteApps=new Iu(this),null==(n=this.siteApps)||n.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new ac(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new Go(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Sc(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new wc(this),this.exceptionObserver=new ha(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new la(this,aa),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new Ba(this),this.historyAutocapture.startIfEnabled(),Cs.DEBUG=Cs.DEBUG||this.config.debug,Cs.DEBUG&&Zs.info("Starting in debug mode",{this:this,config:t,thisC:ps({},this.config),p:o,s:a}),void 0!==(null==(s=t.bootstrap)?void 0:s.distinctID)){var l,c,d=this.config.get_device_id(Uo()),u=null!=(l=t.bootstrap)&&l.isIdentifiedID?d:t.bootstrap.distinctID;this.persistence.set_property(Ur,null!=(c=t.bootstrap)&&c.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:u})}if(this._hasBootstrappedFeatureFlags()){var h,p,f=Object.keys((null==(h=t.bootstrap)?void 0:h.featureFlags)||{}).filter(e=>{var i;return!(null==(i=t.bootstrap)||null==(i=i.featureFlags)||!i[e])}).reduce((e,i)=>{var n;return e[i]=(null==(n=t.bootstrap)||null==(n=n.featureFlags)?void 0:n[i])||!1,e},{}),g=Object.keys((null==(p=t.bootstrap)?void 0:p.featureFlagPayloads)||{}).filter(e=>f[e]).reduce((e,i)=>{var n,s;return null!=(n=t.bootstrap)&&null!=(n=n.featureFlagPayloads)&&n[i]&&(e[i]=null==(s=t.bootstrap)||null==(s=s.featureFlagPayloads)?void 0:s[i]),e},{});this.featureFlags.receivedFeatureFlags({featureFlags:f,featureFlagPayloads:g})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Kr,$device_id:null},"");else if(!this.get_distinct_id()){var v=this.config.get_device_id(Uo());this.register_once({distinct_id:v,$device_id:v},""),this.persistence.set_property(Ur,"anonymous")}return pr(gs,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?function(e,t){var i=e.config.segment;if(!i)return t();!function(e,t){var i=e.config.segment;if(!i)return t();var n=i=>{var n=()=>i.anonymousId()||Uo();e.config.get_device_id=n,i.id()&&(e.register({distinct_id:i.id(),$device_id:n()}),e.persistence.set_property(Ur,"identified")),t()},s=i.user();"then"in s&&qs(s.then)?s.then(e=>n(e)):n(s)}(e,()=>{i.register((e=>{Promise&&Promise.resolve||lc.warn("This browser does not have Promise support, and can not use the segment integration");var t=(t,i)=>{if(!i)return t;t.event.userId||t.event.anonymousId===e.get_distinct_id()||(lc.info("No userId set, resetting PostHog"),e.reset()),t.event.userId&&t.event.userId!==e.get_distinct_id()&&(lc.info("UserId set, identifying with PostHog"),e.identify(t.event.userId));var n=e.calculateEventProperties(i,t.event.properties);return t.event.properties=Object.assign({},n,t.event.properties),t};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:e=>t(e,e.event.event),page:e=>t(e,"$pageview"),identify:e=>t(e,"$identify"),screen:e=>t(e,"$screen")}})(e)).then(()=>{t()})})}(this,()=>this._loaded()):this._loaded(),qs(this.config._onCapture)&&this.config._onCapture!==ju&&(Zs.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",e=>this.config._onCapture(e.event,e))),this.config.ip&&Zs.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}_onRemoteConfig(e){var t,i,n,s,r,o,a,l;if(!ws||!ws.body)return Zs.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this._onRemoteConfig(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=Os(e.supportedCompression,Rs.GZipJS)?Rs.GZipJS:Os(e.supportedCompression,Rs.Base64)?Rs.Base64:void 0),null!=(t=e.analytics)&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:"identified_only"}),null==(i=this.siteApps)||i.onRemoteConfig(e),null==(n=this.sessionRecording)||n.onRemoteConfig(e),null==(s=this.autocapture)||s.onRemoteConfig(e),null==(r=this.heatmaps)||r.onRemoteConfig(e),this.surveys.onRemoteConfig(e),null==(o=this.webVitalsAutocapture)||o.onRemoteConfig(e),null==(a=this.exceptionObserver)||a.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),null==(l=this.deadClicksAutocapture)||l.onRemoteConfig(e)}_loaded(){try{this.config.loaded(this)}catch(e){Zs.critical("`loaded` function failed",e)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this._captureInitialPageview()},1),new _u(this).load(),this.featureFlags.flags()}_start_queue_if_opted_in(){var e;this.has_opted_out_capturing()||this.config.request_batching&&(null==(e=this._requestQueue)||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||ir(this.__request_queue,e=>this._send_retriable_request(e)),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var e,t;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),null==(e=this._requestQueue)||e.unload(),null==(t=this._retryQueue)||t.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(Uu?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Cc(e.url,{ip:this.config.ip?1:0}),e.headers=ps({},this.config.request_headers),e.compression="best-available"===e.compression?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(e=>{var t,i,n,s=ps({},e);s.timeout=s.timeout||6e4,s.url=Cc(s.url,{_:(new Date).getTime().toString(),ver:Cs.LIB_VERSION,compression:s.compression});var r=null!==(t=s.transport)&&void 0!==t?t:"fetch",o=null!==(i=null==(n=hr(Rc,e=>e.transport===r))?void 0:n.method)&&void 0!==i?i:Rc[0].method;if(!o)throw new Error("No available transport method");o(s)})(ps({},e,{callback:t=>{var i,n;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&(null==(i=(n=this.config).on_request_error)||i.call(n,t)),null==e.callback||e.callback(t)}}))))}_send_retriable_request(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,i=[],n=[],s=[];ir(e,e=>{e&&(t=e[0],Bs(t)?s.push(e):qs(e)?e.call(this):Bs(e)&&"alias"===t?i.push(e):Bs(e)&&-1!==t.indexOf("capture")&&qs(this[t])?s.push(e):n.push(e))});var r=function(e,t){ir(e,function(e){if(Bs(e[0])){var i=t;nr(e,function(e){i=i[e[0]].apply(i,e.slice(1))})}else this[e[0]].apply(this,e.slice(1))},t)};r(i,this),r(n,this),r(s,this)}_hasBootstrappedFeatureFlags(){var e,t;return(null==(e=this.config.bootstrap)?void 0:e.featureFlags)&&Object.keys(null==(t=this.config.bootstrap)?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,i){var n;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(!this.consent.isOptedOut())if(!Us(e)&&Hs(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var s=null!=i&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==s||!s.isRateLimited){null!=t&&t.$current_url&&!Hs(null==t?void 0:t.$current_url)&&(Zs.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),null==t||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var r=new Date,o=(null==i?void 0:i.timestamp)||r,a=Uo(),l={uuid:a,event:e,properties:this.calculateEventProperties(e,t||{},o,a)};s&&(l.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),(null==i?void 0:i.$set)&&(l.$set=null==i?void 0:i.$set);var c,d,u=this._calculate_set_once_properties(null==i?void 0:i.$set_once);if(u&&(l.$set_once=u),(l=function(e,t){return i=e,n=e=>Hs(e)&&!Ws(t)?e.slice(0,t):e,s=new Set,function e(t,i){return t!==Object(t)?n?n(t):t:s.has(t)?void 0:(s.add(t),Bs(t)?(r=[],ir(t,t=>{r.push(e(t))})):(r={},nr(t,(t,i)=>{s.has(t)||(r[i]=e(t))})),r);var r}(i);var i,n,s}(l,null!=i&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=o,Us(null==i?void 0:i.timestamp)||(l.properties.$event_time_override_provided=!0,l.properties.$event_time_override_system_time=r),e===hu.DISMISSED||e===hu.SENT){var h=null==t?void 0:t[pu.SURVEY_ID],p=null==t?void 0:t[pu.SURVEY_ITERATION];localStorage.setItem((d=""+lu+(c={id:h,current_iteration:p}).id,c.current_iteration&&c.current_iteration>0&&(d=""+lu+c.id+"_"+c.current_iteration),d),"true"),l.$set=ps({},l.$set,{[cu({id:h,current_iteration:p},e===hu.SENT?"responded":"dismissed")]:!0})}var f=ps({},l.properties.$set,l.$set);if(Ns(f)||this.setPersonPropertiesForFlags(f),!Ys(this.config.before_send)){var g=this._runBeforeSend(l);if(!g)return;l=g}this._internalEventEmitter.emit("eventCaptured",l);var v={method:"POST",url:null!==(n=null==i?void 0:i._url)&&void 0!==n?n:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:l,compression:"best-available",batchKey:null==i?void 0:i._batchKey};return!this.config.request_batching||i&&(null==i||!i._batchKey)||null!=i&&i.send_instantly?this._send_retriable_request(v):this._requestQueue.enqueue(v),l}Zs.critical("This capture call is ignored due to client rate limiting.")}}else Zs.error("No event name provided to posthog.capture")}else Zs.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",t=>e(t.event,t))}calculateEventProperties(e,t,i,n,s){if(i=i||new Date,!this.persistence||!this.sessionPersistence)return t;var r=s?void 0:this.persistence.remove_event_timer(e),o=ps({},t);if(o.token=this.config.token,o.$config_defaults=this.config.defaults,this.config.__preview_experimental_cookieless_mode&&(o.$cookieless_mode=!0),"$snapshot"===e){var a=ps({},this.persistence.properties(),this.sessionPersistence.properties());return o.distinct_id=a.distinct_id,(!Hs(o.distinct_id)&&!Xs(o.distinct_id)||Vs(o.distinct_id))&&Zs.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),o}var l,c=Wd(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:d,windowId:u}=this.sessionManager.checkAndGetSessionAndWindowId(s,i.getTime());o.$session_id=d,o.$window_id=u}this.sessionPropsManager&&sr(o,this.sessionPropsManager.getSessionProps());try{var h;this.sessionRecording&&sr(o,this.sessionRecording.sdkDebugProperties),o.$sdk_debug_retry_queue_size=null==(h=this._retryQueue)?void 0:h.length}catch(e){o.$sdk_debug_error_capturing_properties=String(e)}if(this.requestRouter.region===Ou.CUSTOM&&(o.$lib_custom_api_host=this.config.api_host),l="$pageview"!==e||s?"$pageleave"!==e||s?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(i):this.pageViewManager.doPageView(i,n),o=sr(o,l),"$pageview"===e&&ws&&(o.title=ws.title),!Us(r)){var p=i.getTime()-r;o.$duration=parseFloat((p/1e3).toFixed(3))}Ts&&this.config.opt_out_useragent_filter&&(o.$browser_type=this._is_bot()?"bot":"browser"),(o=sr({},c,this.persistence.properties(),this.sessionPersistence.properties(),o)).$is_identified=this._isIdentified(),Bs(this.config.property_denylist)?nr(this.config.property_denylist,function(e){delete o[e]}):Zs.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var f=this.config.sanitize_properties;f&&(Zs.error("sanitize_properties is deprecated. Use before_send instead"),o=f(o,e));var g=this._hasPersonProcessing();return o.$process_person_profile=g,g&&!s&&this._requirePersonProcessing("_calculate_event_properties"),o}_calculate_set_once_properties(e){var t;if(!this.persistence||!this._hasPersonProcessing())return e;if(this._personProcessingSetOncePropertiesSent)return e;var i=this.persistence.get_initial_props(),n=null==(t=this.sessionPropsManager)?void 0:t.getSetOnceProps(),s=sr({},i,n||{},e||{}),r=this.config.sanitize_properties;return r&&(Zs.error("sanitize_properties is deprecated. Use before_send instead"),s=r(s,"$set_once")),this._personProcessingSetOncePropertiesSent=!0,Ns(s)?void 0:s}register(e,t){var i;null==(i=this.persistence)||i.register(e,t)}register_once(e,t,i){var n;null==(n=this.persistence)||n.register_once(e,t,i)}register_for_session(e){var t;null==(t=this.sessionPersistence)||t.register(e)}unregister(e){var t;null==(t=this.persistence)||t.unregister(e)}unregister_for_session(e){var t;null==(t=this.sessionPersistence)||t.unregister(e)}_register_single(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch(e){return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}getEarlyAccessFeatures(e,t,i){return void 0===t&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,i)}on(e,t){return this._internalEventEmitter.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,i;return null!==(t=null==(i=this.sessionManager)?void 0:i.onSessionId(e))&&void 0!==t?t:()=>{}}getSurveys(e,t){void 0===t&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){void 0===t&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return void 0===t&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,i){if(!this.__loaded||!this.persistence)return Zs.uninitializedWarning("posthog.identify");if(Xs(e)&&(e=e.toString(),Zs.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Zs.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Kr){if(this._requirePersonProcessing("posthog.identify")){var n=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=n;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==n&&e!==this.get_property(gr)&&(this.unregister(gr),this.register({distinct_id:e}));var r="anonymous"===(this.persistence.get_property(Ur)||"anonymous");e!==n&&r?(this.persistence.set_property(Ur,"identified"),this.setPersonPropertiesForFlags(ps({},i||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:n},{$set:t||{},$set_once:i||{}}),this._cachedPersonProperties=Oc(e,t,i),this.featureFlags.setAnonymousDistinctId(n)):(t||i)&&this.setPersonProperties(t,i),e!==n&&(this.reloadFeatureFlags(),this.unregister(Nr))}}else Zs.critical('The string "'+Kr+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Zs.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this._requirePersonProcessing("posthog.setPersonProperties")){var i=Oc(this.get_distinct_id(),e,t);this._cachedPersonProperties!==i?(this.setPersonPropertiesForFlags(ps({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this._cachedPersonProperties=i):Zs.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,i){if(e&&t){if(this._requirePersonProcessing("posthog.group")){var n=this.getGroups();n[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:ps({},n,{[e]:t})}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:i}),this.setGroupPropertiesForFlags({[e]:i})),n[e]===t||i||this.reloadFeatureFlags()}}else Zs.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){void 0===t&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){void 0===t&&(t=!0),this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,i,n,s;if(Zs.info("reset"),!this.__loaded)return Zs.uninitializedWarning("posthog.reset");var r=this.get_property("$device_id");if(this.consent.reset(),null==(t=this.persistence)||t.clear(),null==(i=this.sessionPersistence)||i.clear(),this.surveys.reset(),this.featureFlags.reset(),null==(n=this.persistence)||n.set_property(Ur,"anonymous"),null==(s=this.sessionManager)||s.resetSessionId(),this._cachedPersonProperties=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Kr,$device_id:null},"");else{var o=this.config.get_device_id(Uo());this.register_once({distinct_id:o,$device_id:e?o:r},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return null!==(e=null==(t=this.sessionManager)?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==e?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0),n=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(null!=e&&e.withTimestamp&&i){var s,r=null!==(s=e.timestampLookBack)&&void 0!==s?s:10;if(!i)return n;n+="?t="+Math.max(Math.floor(((new Date).getTime()-i)/1e3)-r,0)}return n}alias(e,t){return e===this.get_property(fr)?(Zs.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(Us(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(gr,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(Zs.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=ps({},this.config);if(js(e)){var i,n,s,r,o;sr(this.config,Vu(e));var a=this._is_persistence_disabled();null==(i=this.persistence)||i.update_config(this.config,t,a),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new su(ps({},this.config,{persistence:"sessionStorage"}),a),Qo._is_supported()&&"true"===Qo._get("ph_debug")&&(this.config.debug=!0),this.config.debug&&(Cs.DEBUG=!0,Zs.info("set_config",{config:e,oldConfig:t,newConfig:ps({},this.config)})),null==(n=this.sessionRecording)||n.startIfEnabledOrStop(),null==(s=this.autocapture)||s.startIfEnabled(),null==(r=this.heatmaps)||r.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence(),null==(o=this.externalIntegrations)||o.startIfEnabledOrStop()}}startSessionRecording(e){var t,i,n,s,r,o=!0===e,a={sampling:o||!(null==e||!e.sampling),linked_flag:o||!(null==e||!e.linked_flag),url_trigger:o||!(null==e||!e.url_trigger),event_trigger:o||!(null==e||!e.event_trigger)};Object.values(a).some(Boolean)&&(null==(t=this.sessionManager)||t.checkAndGetSessionAndWindowId(),a.sampling&&(null==(i=this.sessionRecording)||i.overrideSampling()),a.linked_flag&&(null==(n=this.sessionRecording)||n.overrideLinkedFlag()),a.url_trigger&&(null==(s=this.sessionRecording)||s.overrideTrigger("url")),a.event_trigger&&(null==(r=this.sessionRecording)||r.overrideTrigger("event"))),this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!(null==(e=this.sessionRecording)||!e.started)}captureException(e,t){var i=new Error("PostHog syntheticException");return this.exceptions.sendExceptionEvent(ps({},function(e,t){var{error:i,event:n}=e,s={$exception_list:[]},r=i||n;if(_a(r)||function(e){return va(e,"DOMException")}(r)){var o=r;if(function(e){return"stack"in e}(r))s=za(r,t);else{var a=o.name||(_a(o)?"DOMError":"DOMException"),l=o.message?a+": "+o.message:a;s=Ga(l,ps({},t,{overrideExceptionType:_a(o)?"DOMError":"DOMException",defaultExceptionMessage:l}))}return"code"in o&&(s.$exception_DOMException_code=""+o.code),s}if(function(e){return va(e,"ErrorEvent")}(r)&&r.error)return za(r.error,t);if(ga(r))return za(r,t);if(function(e){return va(e,"Object")}(r)||pa(r))return function(e,t){var i,n,s=null===(i=null==t?void 0:t.handled)||void 0===i||i,r=null===(n=null==t?void 0:t.synthetic)||void 0===n||n,o=null!=t&&t.overrideExceptionType?t.overrideExceptionType:pa(e)?e.constructor.name:"Error",a="Non-Error 'exception' captured with keys: "+function(e,t){void 0===t&&(t=40);var i=Object.keys(e);if(i.sort(),!i.length)return"[object has no keys]";for(var n=i.length;n>0;n--){var s=i.slice(0,n).join(", ");if(!(s.length>t))return n===i.length||s.length<=t?s:s.slice(0,t)+"..."}return""}(e),l={type:o,value:a,mechanism:{handled:s,synthetic:r}};if(null!=t&&t.syntheticException){var c=Oa(null==t?void 0:t.syntheticException,1);c.length&&(l.stacktrace={frames:c,type:"raw"})}return{$exception_list:[l],$exception_level:Aa(e.level)?e.level:"error"}}(r,t);if(Us(i)&&Hs(n)){var c="Error",d=n,u=n.match(Fa);return u&&(c=u[1],d=u[2]),Ga(d,ps({},t,{overrideExceptionType:c,defaultExceptionMessage:d}))}return Ga(r,t)}((e=>e instanceof Error)(e)?{error:e,event:e.message}:{event:e},{syntheticException:i}),t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return null==(t=this.persistence)?void 0:t.props[e]}getSessionProperty(e){var t;return null==(t=this.sessionPersistence)?void 0:t.props[e]}toString(){var e,t=null!==(e=this.config.name)&&void 0!==e?e:Nu;return t!==Nu&&(t=Nu+"."+t),t}_isIdentified(){var e,t;return"identified"===(null==(e=this.persistence)?void 0:e.get_property(Ur))||"identified"===(null==(t=this.sessionPersistence)?void 0:t.get_property(Ur))}_hasPersonProcessing(){var e,t;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&Ns(this.getGroups())&&(null==(e=this.persistence)||null==(e=e.props)||!e[gr])&&(null==(t=this.persistence)||null==(t=t.props)||!t[Qr]))}_shouldCapturePageleave(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&(!0===this.config.capture_pageview||"history_change"===this.config.capture_pageview)}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(e){return"never"===this.config.person_profiles?(Zs.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(Qr,!0),!0)}_is_persistence_disabled(){var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default;return this.config.disable_persistence||e&&!!t}_sync_opt_out_with_persistence(){var e,t,i,n,s=this._is_persistence_disabled();return(null==(e=this.persistence)?void 0:e._disabled)!==s&&(null==(i=this.persistence)||i.set_disabled(s)),(null==(t=this.sessionPersistence)?void 0:t._disabled)!==s&&(null==(n=this.sessionPersistence)||n.set_disabled(s)),s}opt_in_capturing(e){var t;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(Us(null==e?void 0:e.captureEventName)||null!=e&&e.captureEventName)&&this.capture(null!==(t=null==e?void 0:e.captureEventName)&&void 0!==t?t:"$opt_in",null==e?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()}opt_out_capturing(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return bs?Fu(bs,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){ws&&("visible"===ws.visibilityState?this._initialPageviewCaptured||(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:ws.title},{send_instantly:!0}),this._visibilityStateListener&&(ws.removeEventListener("visibilitychange",this._visibilityStateListener),this._visibilityStateListener=null)):this._visibilityStateListener||(this._visibilityStateListener=this._captureInitialPageview.bind(this),pr(ws,"visibilitychange",this._visibilityStateListener)))}debug(e){!1===e?(null==gs||gs.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==gs||gs.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}_shouldDisableFlags(){var e,t,i,n,s,r,o=this._originalUserConfig||{};return"advanced_disable_flags"in o?!!o.advanced_disable_flags:!1!==this.config.advanced_disable_flags?!!this.config.advanced_disable_flags:!0===this.config.advanced_disable_decide?(Zs.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(i="advanced_disable_decide",n=Zs,s=(t="advanced_disable_flags")in(e=o)&&!Us(e[t]),r=i in e&&!Us(e[i]),s?e[t]:!!r&&(n&&n.warn("Config field '"+i+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[i]))}_runBeforeSend(e){if(Ys(this.config.before_send))return e;var t=Bs(this.config.before_send)?this.config.before_send:[this.config.before_send],i=e;for(var n of t){if(i=n(i),Ys(i)){var s="Event '"+e.event+"' was rejected in beforeSend function";return Js(e.event)?Zs.warn(s+". This can cause unexpected behavior."):Zs.info(s),null}i.properties&&!Ns(i.properties)||Zs.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return i}getPageViewId(){var e;return null==(e=this.pageViewManager._currentPageview)?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,i){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(i)})}}!function(e,t){for(var i=0;i<t.length;i++)e.prototype[t[i]]=lr(e.prototype[t[i]])}(Yu,["identify"]);var Xu,Qu=(Xu=qu[Nu]=new Yu,function(){function e(){e.done||(e.done=!0,Uu=!1,nr(qu,function(e){e._dom_loaded()}))}null!=ws&&ws.addEventListener?"complete"===ws.readyState?e():pr(ws,"DOMContentLoaded",e,{capture:!1}):gs&&Zs.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),Xu);Qu.init(r.XJ,{api_host:r.ix});var Ju=i(216),Ku=i(807);function Zu(e){return Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(e)}function eh(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function r(i,n,s,r){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return th(c,"_invoke",function(i,n,s){var r,a,l,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,a=0,l=e,h.n=i,o}};function p(i,n){for(a=i,l=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(l=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(a=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,a=0))}if(s||i>1)return o;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),a=d,l=f;(t=a<2?e:l)||!u;){r||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,r){if(a||(s="next"),t=r[s]){if(!(t=t.call(r,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=r.return)&&t.call(r),a<2&&(l=TypeError("The iterator does not provide a '"+s+"' method"),a=1);r=e}else if((t=(u=h.n<0)?l:i.call(n,h))!==o)break}catch(t){r=e,a=1,l=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),c}var o={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(th(t={},n,function(){return this}),t),u=c.prototype=a.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,th(e,s,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,th(u,"constructor",c),th(c,"constructor",l),l.displayName="GeneratorFunction",th(c,s,"GeneratorFunction"),th(u),th(u,s,"Generator"),th(u,n,function(){return this}),th(u,"toString",function(){return"[object Generator]"}),(eh=function(){return{w:r,m:h}})()}function th(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}th=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){th(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},th(e,t,i,n)}function ih(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function nh(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){ih(r,n,s,o,a,"next",e)}function a(e){ih(r,n,s,o,a,"throw",e)}o(void 0)})}}function sh(){return rh.apply(this,arguments)}function rh(){return(rh=nh(eh().m(function e(){var t,i;return eh().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,lh(r.i3);case 1:return t=e.v,i=t+1,e.n=2,ch(r.i3,i);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function oh(){return ah.apply(this,arguments)}function ah(){return(ah=nh(eh().m(function e(){var t,i;return eh().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,lh(r.xt);case 1:return t=e.v,i=t+1,e.n=2,ch(r.xt,i);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function lh(e){return new Promise(function(t,i){chrome.storage.local.get(e,function(n){if(chrome.runtime.lastError)return i(chrome.runtime.lastError);var s=n[e];t("number"==typeof s?s:0)})})}function ch(e,t){return new Promise(function(i,n){chrome.storage.local.set(function(e,t,i){return(t=function(e){var t=function(e){if("object"!=Zu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=Zu(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Zu(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}({},e,t),function(){if(chrome.runtime.lastError)return n(chrome.runtime.lastError);i()})})}function dh(e){return dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dh(e)}function uh(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function r(i,n,s,r){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return hh(c,"_invoke",function(i,n,s){var r,a,l,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,a=0,l=e,h.n=i,o}};function p(i,n){for(a=i,l=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(l=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(a=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,a=0))}if(s||i>1)return o;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),a=d,l=f;(t=a<2?e:l)||!u;){r||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,r){if(a||(s="next"),t=r[s]){if(!(t=t.call(r,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=r.return)&&t.call(r),a<2&&(l=TypeError("The iterator does not provide a '"+s+"' method"),a=1);r=e}else if((t=(u=h.n<0)?l:i.call(n,h))!==o)break}catch(t){r=e,a=1,l=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),c}var o={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(hh(t={},n,function(){return this}),t),u=c.prototype=a.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,hh(e,s,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,hh(u,"constructor",c),hh(c,"constructor",l),l.displayName="GeneratorFunction",hh(c,s,"GeneratorFunction"),hh(u),hh(u,s,"Generator"),hh(u,n,function(){return this}),hh(u,"toString",function(){return"[object Generator]"}),(uh=function(){return{w:r,m:h}})()}function hh(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}hh=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){hh(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},hh(e,t,i,n)}function ph(e,t,i){return(t=function(e){var t=function(e){if("object"!=dh(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=dh(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==dh(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function fh(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function gh(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){fh(r,n,s,o,a,"next",e)}function a(e){fh(r,n,s,o,a,"throw",e)}o(void 0)})}}function vh(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return _h(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function _h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}var mh=["openings-trial","country-not-match","active-payment-found","success-payment"],yh=!1,bh={countryMatch:!0},wh={saveAsPdf:chrome.i18n.getMessage("saveAsPdf"),saveChatGptMessagesOnly:chrome.i18n.getMessage("saveChatGptMessagesOnly"),selectMessagesToSave:chrome.i18n.getMessage("selectMessagesToSave"),theme:chrome.i18n.getMessage("theme"),light:chrome.i18n.getMessage("light"),dark:chrome.i18n.getMessage("dark"),manageSubscription:chrome.i18n.getMessage("manageSubscription"),contactSupport:chrome.i18n.getMessage("contactSupport"),logOut:chrome.i18n.getMessage("logOut"),reportAnIssue:chrome.i18n.getMessage("reportAnIssue"),rateUs:chrome.i18n.getMessage("rateUs"),clickOnMessagesToSelect:chrome.i18n.getMessage("clickOnMessagesToSelect"),cancelSelection:chrome.i18n.getMessage("cancelSelection"),subscriptionIsRequired:chrome.i18n.getMessage("subscriptionIsRequired"),needHelp:chrome.i18n.getMessage("needHelp")};function xh(){if(!(document.querySelectorAll(".chatGptToPdf-convert").length>0)){var e;(e=document.createElement("style")).textContent='\n    /* CSS Variables for ChatGPT theme compatibility */\n    :root {\n      --surface-primary: #ffffff;\n      --surface-secondary: #f7f7f8;\n      --surface-tertiary: #ffffff;\n      --text-primary: #0d0d0d;\n      --border-light: #e5e5e5;\n      --border-medium: #e5e5e5;\n      --border-heavy: #c9c9c9;\n      --primary-green: #059669;\n      --primary-green-light: #059669;\n    }\n\n    html[style*="color-scheme: dark"] {\n      --surface-primary: #212121;\n      --surface-secondary: #2f2f2f;\n      --surface-tertiary: #212121;\n      --text-primary: #ececec;\n      --border-light: #4e4e4f;\n      --border-medium: #4e4e4f;\n      --border-heavy: #6e6e6f;\n      --primary-green: #059669;\n      --primary-green-light: #0d2e25;\n    }\n\n    .my-extension-toast {\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background-color: indianred;\n      color: white;\n      padding: 10px 20px;\n      border-radius: 5px;\n      font-size: 16px;\n      z-index: 9999;\n      opacity: 0;\n      transition: opacity 0.3s ease-in-out;\n    }\n    .my-extension-toast.show {\n      opacity: 1;\n    }\n    /* Styles for the PDF button and loader */\n    .chatGptToPdf-block {\n      display: inline-flex;\n      align-items: center;\n      height: 36px;\n      margin-right: 8px; /* Consistent gap to the Share button on the right */\n    }\n\n    /* Fixed positioning fallback when not inserted in header */\n    .chatGptToPdf-block.chatGptToPdf-fixed-position {\n      position: fixed;\n      top: 9px;\n      right: 165px;\n      margin: 0;\n    }\n\n    .chatGptToPdf-glow-effect {\n      position: absolute;\n      inset: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 1.125rem; /* Match button border-radius */\n      filter: blur(8px); /* Softer blur */\n      animation: chatGptToPdf-glow-pulse 4s ease-in-out infinite alternate; /* Slower, pulsing animation */\n      pointer-events: none; /* Ensure it doesn\'t interfere with button clicks */\n      z-index: -1; /* Place it behind the button content */\n      opacity: 0.7; /* Slightly more subtle */\n    }\n\n    #chatGptToPdf-convert-main:active .chatGptToPdf-glow-effect,\n    #chatGptToPdf-dropdown-toggle:active .chatGptToPdf-glow-effect {\n      display: none;\n    }\n\n    .chatGptToPdf-block.chatGptToPdf-glow-permanently-disabled .chatGptToPdf-glow-effect {\n        display: none !important; /* Ensure this overrides other display states */\n    }\n\n    @keyframes chatGptToPdf-glow-pulse {\n      0% {\n        background: conic-gradient(from 0deg at 50% 50%, #90EE90, #33FF57, #2E8B57, #33FF57, #90EE90);\n        transform: scale(1);\n      }\n      50% {\n        background: conic-gradient(from 180deg at 50% 50%, #2E8B57, #33FF57, #90EE90, #33FF57, #2E8B57);\n        transform: scale(1.05);\n      }\n      100% {\n        background: conic-gradient(from 360deg at 50% 50%, #90EE90, #33FF57, #2E8B57, #33FF57, #90EE90);\n        transform: scale(1);\n      }\n    }\n\n    @media (min-width: 768px) {\n    }\n\n    @media (max-width: 767px) {\n      .chatGptToPdf-block.chatGptToPdf-fixed-position {\n        top: 15px;\n        right: 56px;\n      }\n    }\n\n    .chatGptToPdf-btn-group {\n      display: inline-flex;\n      position: relative;\n      align-items: center;\n    }\n\n    /* ChatGPT\'s button styles */\n    .btn {\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      position: relative;\n      transition: box-shadow .15s ease,transform .15s ease,background-color .15s ease;\n    }\n\n    .btn-secondary {\n      background-color: var(--surface-tertiary);\n      color: var(--text-primary);\n      border: 1px solid var(--border-medium);\n    }\n\n    .btn-secondary:hover {\n      background-color: var(--surface-secondary);\n    }\n\n    .btn-small {\n      padding: 0.375rem 0.75rem;\n      font-size: .875rem;\n      border-radius: 1.125rem;\n    }\n\n    .chatGptToPdf-h-9 {\n      height: 2.25rem;\n    }\n\n    .chatGptToPdf-fs-small {\n      font-size: .875rem;\n    }\n\n    .chatGptToPdf-convert {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: auto;\n      min-width: 7.7rem;\n      height: 2.25rem;\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0;\n      border-right: none;\n    }\n\n    .chatGptToPdf-convert:hover {\n      background-color: var(--surface-secondary);\n    }\n\n    .chatGptToPdf-convert:disabled {\n      cursor: not-allowed;\n      opacity: 0.5;\n    }\n\n    .chatGptToPdf-dropdown-toggle {\n      width: 2.5rem;\n      height: 2.25rem;\n      background-color: var(--surface-tertiary);\n      color: var(--text-primary);\n      border: 1px solid var(--border-medium);\n      border-left: none;\n      border-radius: 0 1.125rem 1.125rem 0;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      transition: background-color 0.15s ease;\n      padding: 0;\n    }\n\n    .chatGptToPdf-dropdown-toggle:hover {\n      background-color: var(--surface-secondary);\n    }\n\n    .chatGptToPdf-btn-arrow {\n      width: 16px;\n      height: 16px;\n      color: var(--text-primary);\n    }\n    \n    /* Ensure buttons appear connected */\n    .chatGptToPdf-btn-group .btn + .btn {\n      margin-left: -1px;\n    }\n    \n    .chatGptToPdf-new-feature-indicator::after {\n      content: \'!\';\n      position: absolute;\n      top: -3px;\n      right: -2px;\n      background-color: green;\n      color: white;\n      font-size: 12px;\n      width: 16px;\n      height: 16px;\n      text-align: center;\n      border-radius: 50%;\n      line-height: 16px;\n    }\n\n    #chatGptToPdf-convert-main {\n      padding-right: 0;\n      position: relative;\n    }\n\n    #chatGptToPdf-convert-main:disabled {\n      cursor: wait;\n      filter: none;\n      opacity: 1;\n    }\n\n    .chatGptToPdf-btn-container {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: relative;\n    }\n\n    .chatGptToPdf-btn-content {\n      display: flex;\n      align-items: center;\n    }\n\n    .chatGptToPdf-mr-1 {\n      margin-right: 0.25rem;\n    }\n\n    .chatGptToPdf-icon-sm {\n      margin-right: 0.5rem;  /* Match ChatGPT\'s native button icon spacing */\n    }\n\n    .chatGptToPdf-hidden {\n      display: none;\n    }\n\n    .loader {\n      border: 2px solid #f3f3f3;\n      border-top: 2px solid #10a37f;\n      width: 16px;\n      height: 16px;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n    }\n\n    @-webkit-keyframes spin {\n      0% { -webkit-transform: rotate(0deg); }\n      100% { -webkit-transform: rotate(360deg); }\n    }\n\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n\n    /* Improved Dropdown Menu Styles - ChatGPT Style with Left Alignment */\n    .chatGptToPdf-dropdown-menu {\n      position: fixed;\n      z-index: 10000;\n      min-width: 280px;\n      background: #ffffff;\n      border: 1px solid #d1d5db;\n      border-radius: 8px;\n      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n      padding: 8px 0;\n      font-size: 14px;\n      overflow: hidden;\n    }\n\n    /* Dark theme support based on ChatGPT\'s theme setting */\n    html[style*="color-scheme: dark"] .chatGptToPdf-dropdown-menu {\n      background: #303030; /* --bg-elevated-primary */\n      border-color: #ffffff26; /* --border-default */\n      color: #f3f3f3; /* --text-secondary */\n    }\n\n    .chatGptToPdf-menu-separator {\n      height: 1px;\n      background-color: #e5e7eb; /* Light theme */\n      margin: 8px 20px; /* Consistent with item padding/margins */\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-menu-separator {\n      background-color: #ffffff26; /* --border-default */\n    }\n\n    .chatGptToPdf-menu-section {\n      padding: 4px 0;\n    }\n\n    .chatGptToPdf-menu-section:first-child {\n      background-color: var(--primary-green);\n      padding: 8px 0;\n      margin: -8px 0 8px 0;\n    }\n\n    .chatGptToPdf-menu-section:not(:last-child) {\n      border-bottom: 1px solid #e5e7eb;\n      margin-bottom: 8px;\n      padding-bottom: 8px;\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-menu-section:not(:last-child) {\n      border-bottom-color: #ffffff26; /* --border-default */\n    }\n\n    .chatGptToPdf-dropdown-item {\n      display: flex;\n      align-items: center;\n      padding: 10px 20px; /* Default padding */\n      cursor: pointer;\n      border-radius: 4px;\n      color: #374151; /* Restored original color */\n      font-size: 14px; /* Restored original font size */\n      font-weight: 400; /* Restored original font weight */\n      transition: background-color 0.15s ease;\n      white-space: nowrap;\n      width: 100%; /* Restored original width */\n      text-align: left; /* Restored original text-align */\n      background: none; /* Restored original background */\n      border: none; /* Restored original border */\n      margin: 0; /* Restored original margin */\n      gap: 0; /* Restored original gap */\n    }\n\n    /* Dark theme for dropdown items */\n    html[style*="color-scheme: dark"] .chatGptToPdf-dropdown-item {\n      color: #f3f3f3; /* --text-secondary */\n    }\n\n    .chatGptToPdf-dropdown-item:hover {\n      background-color: #f3f4f6;\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-dropdown-item:hover {\n      background-color: #ffffff1a; /* --interactive-bg-secondary-hover */\n    }\n\n    .chatGptToPdf-dropdown-item:active {\n      transform: translateY(0);\n      background-color: var(--main-surface-secondary, #e5e7eb);\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-dropdown-item:active {\n      background-color: #ffffff0d; /* --interactive-bg-secondary-press */\n    }\n\n    /* Green highlighted primary actions */\n    .chatGptToPdf-primary-action {\n      background: linear-gradient(135deg, #10a37f 0%, #059669 100%);\n      color: #ffffff;\n      border: none;\n      /* Animation properties */\n      position: relative; /* Needed for ::before pseudo-element positioning */\n      overflow: hidden;   /* Keep shimmer within button bounds */\n      animation: subtlePulse 3s ease-in-out infinite; /* Restore subtle pulse */\n      padding: 12px 20px !important; /* Increased padding for primary actions, kept original horizontal padding */\n      font-weight: 500; /* Make primary actions slightly bolder */\n    }\n\n    .chatGptToPdf-primary-action::before {\n      content: \'\';\n      position: absolute;\n      top: 0;\n      left: -100%; /* Start shimmer off-screen */\n      width: 100%;\n      height: 100%;\n      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); /* Shimmer effect */\n      transition: left 0.6s ease; /* Shimmer animation */\n    }\n\n    .chatGptToPdf-primary-action:hover::before {\n      left: 100%; /* Move shimmer across on hover */\n    }\n\n    .chatGptToPdf-primary-action:hover {\n      background: linear-gradient(135deg, #0d8f6f 0%, #047857 100%);\n      box-shadow: 0 4px 12px rgba(16, 163, 127, 0.3);\n    }\n\n    /* Make sure icons inherit white color inside green buttons */\n    .chatGptToPdf-primary-action .chatGptToPdf-icon {\n      stroke: currentColor;\n      margin-left: 0; /* Ensure no additional left margin */\n    }\n\n    /* Theme toggle visibility and layout */\n    .chatGptToPdf-theme-toggle {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 10px 20px; /* Restored original padding */\n      cursor: pointer;\n      border-radius: 4px;\n      color: #374151; /* Restored original color */\n      font-size: 14px; /* Restored original font size */\n      transition: background-color 0.15s ease;\n      margin: 0; /* Restored original margin */\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-theme-toggle {\n      color: #f3f3f3; /* --text-secondary */\n    }\n\n    .chatGptToPdf-theme-toggle:hover {\n      background-color: #f3f4f6;\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-theme-toggle:hover {\n      background-color: #ffffff1a; /* --interactive-bg-secondary-hover */\n    }\n\n    /* New theme toggle switch design with icons */\n    .chatGptToPdf-toggle-switch {\n      display: flex;\n      width: 64px;\n      height: 32px;\n      padding: 4px;\n      border-radius: 16px;\n      cursor: pointer;\n      transition: all 0.3s;\n      position: relative;\n      background-color: #ffffff;\n      border: 1px solid #e5e7eb;\n    }\n\n    .chatGptToPdf-toggle-switch.active {\n      background-color: #18181b;\n      border-color: #3f3f46;\n    }\n\n    .chatGptToPdf-toggle-icons {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      width: 100%;\n      position: relative;\n    }\n\n    .chatGptToPdf-toggle-icon-active {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      position: absolute;\n      transition: transform 0.3s;\n      transform: translateX(0);\n      background-color: #e5e7eb;\n    }\n\n    .chatGptToPdf-toggle-switch.active .chatGptToPdf-toggle-icon-active {\n      transform: translateX(32px);\n      background-color: #3f3f46;\n    }\n\n    .chatGptToPdf-toggle-icon-inactive {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      width: 100%;\n      padding: 0 4px;\n      pointer-events: none; /* Prevent click interference */\n      position: relative; /* For absolute positioning of children */\n    }\n\n    /* Icon visibility based on theme */\n    .chatGptToPdf-moon-icon,\n    .chatGptToPdf-sun-icon {\n      width: 16px;\n      height: 16px;\n      display: none;\n    }\n\n    /* Light theme: show sun in active button */\n    .chatGptToPdf-toggle-switch:not(.active) .chatGptToPdf-toggle-icon-active .chatGptToPdf-sun-icon {\n      display: block;\n      color: #a8a29e;\n    }\n\n    /* Dark theme: show moon in active button */\n    .chatGptToPdf-toggle-switch.active .chatGptToPdf-toggle-icon-active .chatGptToPdf-moon-icon {\n      display: block;\n      color: #ffffff;\n    }\n\n    /* Inactive icons */\n    .chatGptToPdf-sun-icon-inactive,\n    .chatGptToPdf-moon-icon-inactive {\n      width: 16px;\n      height: 16px;\n      transition: opacity 0.3s;\n      position: absolute;\n    }\n\n    /* Light theme: show moon on right (inactive) */\n    .chatGptToPdf-toggle-switch:not(.active) .chatGptToPdf-moon-icon-inactive {\n      display: block;\n      color: #6b7280;\n      opacity: 0.6;\n      right: 4px;\n    }\n\n    .chatGptToPdf-toggle-switch:not(.active) .chatGptToPdf-sun-icon-inactive {\n      display: none;\n    }\n\n    /* Dark theme: show sun on left (inactive) */\n    .chatGptToPdf-toggle-switch.active .chatGptToPdf-sun-icon-inactive {\n      display: block;\n      color: #a8a29e;\n      opacity: 0.6;\n      left: 4px;\n    }\n\n    .chatGptToPdf-toggle-switch.active .chatGptToPdf-moon-icon-inactive {\n      display: none;\n    }\n\n    /* Uniform dropdown item paddings & margins */\n    .chatGptToPdf-dropdown-item,\n    .chatGptToPdf-theme-toggle {\n      padding: 10px 20px;\n      margin: 0;\n    }\n\n    .chatGptToPdf-flex-group {\n      display: flex;\n      justify-content: space-between;\n      padding: 8px 16px;\n      background-color: #f9fafb;\n      margin: 4px 8px;\n      border-radius: 6px;\n      gap: 8px;\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-flex-group {\n      background-color: #414141; /* --bg-tertiary */\n    }\n\n    .chatGptToPdf-flex-group > div {\n      flex-grow: 1;\n      flex-shrink: 1;\n      flex-basis: auto; /* Allow width based on content */\n      min-width: 0; /* Help with text overflow in flex */\n      text-align: center;\n      color: #6b7280; /* Explicitly set default color */\n      cursor: pointer;\n      font-size: 13px;\n      font-weight: 500;\n      transition: color 0.15s ease, background-color 0.15s ease;\n      padding: 10px 8px; /* Increased vertical padding */\n      border-radius: 4px;\n      overflow-wrap: break-word;\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-flex-group > div {\n      color: #afafaf; /* --text-tertiary */\n    }\n\n    .chatGptToPdf-flex-group > div:hover {\n      color: #10a37f;\n      background-color: rgba(16, 163, 127, 0.1);\n    }\n\n    .chatGptToPdf-rate-us-standalone {\n      display: block; /* Ensure it takes full width available within its horizontal margins */\n      margin: 8px 8px; /* Consistent horizontal margins with other grouped elements, vertical margin for spacing */\n      padding: 10px 20px; /* Consistent padding with other items */\n      background-color: #FFFBEB; /* Light creamy yellow */\n      color: #78350F; /* Dark amber for text */\n      font-weight: 500;\n      border-radius: 6px;\n      cursor: pointer;\n      transition: background-color 0.15s ease, transform 0.15s ease, border-color 0.15s ease;\n      text-align: center;\n      border: 1px solid #FDE68A; /* Golden border */\n      font-size: 14px; /* Match other dropdown items */\n    }\n    \n    .chatGptToPdf-rate-us-standalone:hover {\n      background-color: #FFF8E1; /* Slightly deeper cream */\n      border-color: #FCD34D; /* Brighter golden border on hover */\n      transform: translateY(-1px);\n    }\n    \n    .chatGptToPdf-rate-us-standalone::after {\n      content: \' \';\n      margin-left: 4px;\n      font-size: 13px; /* Slightly smaller than button text */\n    }\n\n    /* Dark theme adjustments for Rate Us button */\n    html[style*="color-scheme: dark"] .chatGptToPdf-rate-us-standalone {\n      background-color: #4B3800; /* Dark gold/amber for background */\n      color: #FFFBEB; /* Light creamy text */\n      border-color: #785A00; /* Darker gold border */\n    }\n\n    html[style*="color-scheme: dark"] .chatGptToPdf-rate-us-standalone:hover {\n      background-color: #5F4700; /* Slightly lighter dark gold on hover */\n      border-color: #A17700; /* Brighter gold border for dark theme hover */\n    }\n    \n    .chatGptToPdf-icon {\n      width: 16px;\n      height: 16px;\n      margin-right: 12px;\n      flex-shrink: 0;\n      stroke: currentColor;\n      fill: none;\n      stroke-width: 1.5;\n    }\n    \n    .rate-us-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.5);\n        z-index: 10000;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n        \n    .rate-us-popup {\n        background-color: #fff;\n        padding: 20px;\n        border-radius: 8px;\n        text-align: center;\n        width: 300px;\n    }\n        \n     .rate-us-popup h2 {\n        color: #000000;\n        margin-top: 0;\n     }\n     \n     .rate-us-popup p {\n        color: #000000;\n        margin-top: 10px;\n     }\n        \n     .star-container {\n        display: flex;\n        justify-content: center;\n        margin: 10px 0;\n     }\n        \n     .star {\n        font-size: 30px;\n        color: #ccc;\n        cursor: pointer;\n        margin: 0 5px;\n        transition: color 0.2s;\n     }\n        \n      .star.hover,\n        .star.selected {\n        color: gold;\n      }\n        \n      .later-button {\n        background-color: transparent;\n        border: none;\n        color: #cccccc;\n        cursor: pointer;\n        font-size: 16px;\n        font-weight: normal;\n        text-transform: none;\n        margin-top: 10px;\n        padding: 5px 10px;\n        border-radius: 5px;\n        transition: background-color 0.2s;\n      }\n      \n      .later-button:hover {\n        background-color: #e0e0e0; \n        color: #999999;\n      }\n      \n      .chatGptToPdf-selectable-message {\n        cursor: pointer;\n        background-color: rgba(30, 144, 255, 0.1); /* Light blue overlay */\n        transition: background-color 0.2s ease;\n      }\n        \n      .chatGptToPdf-selected-message {\n        background-color: rgba(30, 144, 255, 0.35); /* More opaque blue */\n        transition: background-color 0.2s ease;\n      }\n    \n      .chatGptToPdf-selectable-message:not(.chatGptToPdf-selected-message):hover {\n        background-color: rgba(30, 144, 255, 0.15); /* Slightly increase opacity on hover */\n      }\n          \n      .chatGptToPdf-cancel-selection {\n        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%) !important;\n        color: white !important;\n        font-weight: 600;\n      }\n\n      .chatGptToPdf-cancel-selection::after {\n        content: \'\';\n        font-size: 16px;\n        flex-shrink: 0;\n      }\n\n      .chatGptToPdf-cancel-selection:hover {\n        background: linear-gradient(135deg, #ff5252 0%, #d32f2f 100%) !important;\n        transform: translateY(-2px);\n        box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);\n      }\n      \n      #chatGptToPdf-select-messages.chatGptToPdf-new-feature-indicator::after {\n        top: 37%;\n        left: 90%;\n      }\n      \n/* Overlay: same look as .rate-us-overlay */\n.happy-news-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 10000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* Popup container: same style as .rate-us-popup */\n.happy-news-popup {\n  background-color: #fff;\n  padding: 20px;\n  border-radius: 8px;\n  text-align: center;\n  min-width: 500px;\n  width: 500px;\n  box-sizing: border-box;\n}\n\n/* Headings and paragraphs in this popup */\n.happy-news-popup h2 {\n  color: #000;\n  margin-top: 0;\n}\n\n.happy-news-popup p {\n  color: #000;\n  margin-top: 10px;\n}\n\n/* Slides: hide by default; only one is active at a time */\n.popup-slide {\n  display: none;\n}\n\n/* Show the active slide */\n.popup-slide.active {\n  display: block;\n}\n\n/* Light text near the bottom of slide 1 */\n.light-text {\n  font-size: 12px;\n  color: hsl(0, 0%, 60%) !important;\n  margin-top: 15px !important;\n}\n\n/* Buttons: match the style of .later-button from rate-us popup */\n.happy-news-button {\n  background-color: #fff;\n  border: 2px solid #007BFF;\n  color: #007BFF;\n  cursor: pointer;\n  font-size: 16px;\n  margin-top: 10px;\n  padding: 5px 15px;\n  border-radius: 5px;\n  transition: background-color 0.3s, color 0.3s;\n}\n\n.happy-news-button:hover {\n  background-color: #007BFF;\n  color: #fff;\n}\n\n#confetti {\n  pointer-events:none;\n}\n\n/* Animation for dropdown appearance */\n@keyframes dropdownSlideIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px) scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.chatGptToPdf-dropdown-menu:not(.chatGptToPdf-hidden) {\n  animation: dropdownSlideIn 0.2s ease-out;\n}\n\n/* Pulse animation for primary actions */\n@keyframes subtlePulse {\n  0%, 100% {\n    box-shadow: 0 4px 15px rgba(16, 163, 127, 0.2); /* Updated shadow color */\n  }\n  50% {\n    box-shadow: 0 6px 20px rgba(16, 163, 127, 0.3); /* Updated shadow color */\n  }\n}\n\n#chatGptToPdf-save-ai-text-only,\n#chatGptToPdf-select-messages {\n  animation: subtlePulse 3s ease-in-out infinite;\n}\n\n/* Fix icon alignment in dropdown items */\n.chatGptToPdf-dropdown-item {\n  display: flex;\n  align-items: center;\n  gap: 0; /* Reset any gap that might affect spacing */\n}\n\n/* Ensure consistent icon positioning in all dropdown items */\n.chatGptToPdf-dropdown-item .chatGptToPdf-icon,\n.chatGptToPdf-theme-toggle .chatGptToPdf-icon {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: 0; /* Ensure no left margin */\n  margin-right: 12px; /* Consistent right margin */\n  flex-shrink: 0; /* Prevent icon from shrinking */\n}\n\n.chatGptToPdf-menu-section:has(.chatGptToPdf-primary-action) {\n    padding-top: 8px !important;\n    padding-bottom: 8px !important;\n}\n\n/* Font Selection Styles */\n.chatGptToPdf-font-selector,\n.chatGptToPdf-font-size-selector {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px 20px;\n  cursor: pointer;\n  border-radius: 4px;\n  color: #374151;\n  font-size: 14px;\n  transition: background-color 0.15s ease;\n  margin: 0;\n}\n\nhtml[style*="color-scheme: dark"] .chatGptToPdf-font-selector,\nhtml[style*="color-scheme: dark"] .chatGptToPdf-font-size-selector {\n  color: #f3f3f3;\n}\n\n.chatGptToPdf-font-selector:hover,\n.chatGptToPdf-font-size-selector:hover {\n  background-color: #f3f4f6;\n}\n\nhtml[style*="color-scheme: dark"] .chatGptToPdf-font-selector:hover,\nhtml[style*="color-scheme: dark"] .chatGptToPdf-font-size-selector:hover {\n  background-color: #ffffff1a;\n}\n\n.chatGptToPdf-font-dropdown,\n.chatGptToPdf-font-size-dropdown {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.chatGptToPdf-select {\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  background: transparent;\n  border: 1px solid var(--border-medium);\n  border-radius: 6px;\n  padding: 6px 30px 6px 12px;\n  font-size: 13px;\n  color: var(--text-primary);\n  cursor: pointer;\n  min-width: 120px;\n  transition: all 0.15s ease;\n  outline: none;\n}\n\n.chatGptToPdf-select:hover {\n  border-color: var(--border-heavy);\n  background-color: var(--surface-secondary);\n}\n\n.chatGptToPdf-select:focus {\n  border-color: var(--primary-green);\n  box-shadow: 0 0 0 2px rgba(16, 163, 127, 0.1);\n}\n\n/* Dark theme for select */\nhtml[style*="color-scheme: dark"] .chatGptToPdf-select {\n  background-color: var(--surface-secondary);\n  border-color: var(--border-medium);\n  color: var(--text-primary);\n}\n\nhtml[style*="color-scheme: dark"] .chatGptToPdf-select:hover {\n  background-color: var(--surface-tertiary);\n  border-color: var(--border-heavy);\n}\n\nhtml[style*="color-scheme: dark"] .chatGptToPdf-select option {\n  background-color: var(--surface-secondary);\n  color: var(--text-primary);\n}\n\n.chatGptToPdf-select-arrow {\n  position: absolute;\n  right: 8px;\n  top: 50%;\n  transform: translateY(-50%);\n  pointer-events: none;\n  color: var(--text-primary);\n  opacity: 0.7;\n}\n\n/* Font family preview in options */\n.chatGptToPdf-select option[value="times"] {\n  font-family: \'Times New Roman\', serif;\n}\n\n.chatGptToPdf-select option[value="arial"] {\n  font-family: \'Arial\', sans-serif;\n}\n\n.chatGptToPdf-select option[value="calibri"] {\n  font-family: \'Calibri\', sans-serif;\n}\n\n.chatGptToPdf-select option[value="helvetica"] {\n  font-family: \'Helvetica\', sans-serif;\n}\n\n/* Ensure proper spacing and alignment */\n.chatGptToPdf-font-selector .chatGptToPdf-icon,\n.chatGptToPdf-font-size-selector .chatGptToPdf-icon {\n  margin-right: 12px;\n  flex-shrink: 0;\n}\n\n/* Make the font section consistent with other sections */\n.chatGptToPdf-menu-section:has(.chatGptToPdf-font-selector) {\n  padding: 4px 0;\n}\n\n/* Responsive adjustments for smaller screens */\n@media (max-width: 480px) {\n  .chatGptToPdf-select {\n    min-width: 100px;\n    font-size: 12px;\n    padding: 5px 25px 5px 10px;\n  }\n  \n  .chatGptToPdf-font-selector,\n  .chatGptToPdf-font-size-selector {\n    padding: 8px 16px;\n  }\n}\n\n/* Per-message PDF export button styles */\n.chatGptToPdf-message-button-container {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    gap: 8px;\n    margin-top: 8px;\n}\n\n.chatGptToPdf-message-export-btn {\n    position: relative;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    padding: 6px;\n    border-radius: 6px;\n    border: none;\n    background-color: transparent;\n    color: var(--text-secondary, #6e6e80);\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    gap: 6px;\n}\n\n/* Dark mode button */\nhtml.dark .chatGptToPdf-message-export-btn,\nhtml[style*="color-scheme: dark"] .chatGptToPdf-message-export-btn {\n    color: var(--text-secondary, #8e8ea0);\n}\n\n/* Hover effect */\n.chatGptToPdf-message-export-btn:hover {\n    background-color: var(--surface-secondary, #f7f7f8);\n    color: var(--text-primary, #0d0d0d);\n}\n\nhtml.dark .chatGptToPdf-message-export-btn:hover,\nhtml[style*="color-scheme: dark"] .chatGptToPdf-message-export-btn:hover {\n    background-color: var(--surface-secondary, #2f2f2f);\n    color: var(--text-primary, #ececec);\n}\n\n/* Active/Click effect */\n.chatGptToPdf-message-export-btn:active {\n    transform: scale(0.98);\n}\n\n/* SVG Icon styling */\n.chatGptToPdf-message-export-btn svg {\n    width: 18px;\n    height: 18px;\n    stroke: currentColor;\n    stroke-width: 1.5;\n    fill: none;\n}\n\n/* Tooltip */\n.chatGptToPdf-tooltip {\n    position: absolute;\n    bottom: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n    margin-bottom: 8px;\n    padding: 6px 12px;\n    background-color: rgba(0, 0, 0, 0.9);\n    color: white;\n    font-size: 12px;\n    font-weight: normal;\n    white-space: nowrap;\n    border-radius: 6px;\n    opacity: 0;\n    visibility: hidden;\n    transition: opacity 0.2s, visibility 0.2s;\n    pointer-events: none;\n    z-index: 10000;\n}\n\n/* Tooltip arrow */\n.chatGptToPdf-tooltip::after {\n    content: \'\';\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 0;\n    height: 0;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n    border-top: 6px solid rgba(0, 0, 0, 0.9);\n}\n\n/* Show tooltip on hover */\n.chatGptToPdf-message-export-btn:hover .chatGptToPdf-tooltip {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* Loading state */\n.chatGptToPdf-message-export-btn.loading {\n    pointer-events: none;\n    opacity: 0.7;\n}\n\n.chatGptToPdf-message-export-btn.loading svg {\n    animation: spin 1s linear infinite;\n}\n\n/* Spinner animation */\n@keyframes chatGptToPdf-spin {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(360deg);\n    }\n}\n\n.chatGptToPdf-spinner-icon {\n    animation: chatGptToPdf-spin 1s linear infinite;\n}\n\n.chatGptToPdf-spinner-circle {\n    opacity: 0.25;\n}\n\n.chatGptToPdf-spinner-path {\n    opacity: 0.75;\n}\n\n/* Message highlight on button hover */\n.chatGptToPdf-message-highlight {\n    background-color: rgba(0, 0, 0, 0.03) !important;\n    border-radius: 8px;\n    transition: background-color 0.2s ease;\n}\n\nhtml.dark .chatGptToPdf-message-highlight,\nhtml[style*="color-scheme: dark"] .chatGptToPdf-message-highlight {\n    background-color: rgba(255, 255, 255, 0.05) !important;\n}\n\n/* Responsive adjustments for mobile */\n@media (max-width: 768px) {\n    .chatGptToPdf-message-export-btn {\n        padding: 8px 12px;\n    }\n\n    .chatGptToPdf-tooltip {\n        display: none;\n    }\n}\n  ',document.head.appendChild(e);var t='\n    <div class="chatGptToPdf-block chatGptToPdf-glow-permanently-disabled">\n      <div class="chatGptToPdf-btn-group">\n        <button id="chatGptToPdf-convert-main" type="button" role="button" tabindex="0" aria-label="'.concat(wh.saveAsPdf,'" class="btn btn-secondary btn-small chatGptToPdf-h-9 chatGptToPdf-convert chatGptToPdf-fs-small">\n          <div class="chatGptToPdf-glow-effect"></div>\n          <div class="chatGptToPdf-btn-container">\n            <svg class="chatGptToPdf-icon-sm chatGptToPdf-btn-content" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" width="16" height="16" stroke-width="1.5" stroke="currentColor">\n              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />\n            </svg>\n            <div class="chatGptToPdf-lg chatGptToPdf-btn-content">').concat(wh.saveAsPdf,'</div>\n            <div class="loader chatGptToPdf-hidden"></div>\n          </div>\n        </button>\n        <button id="chatGptToPdf-dropdown-toggle" type="button" class="btn btn-secondary btn-small chatGptToPdf-dropdown-toggle">\n          <div class="chatGptToPdf-glow-effect"></div>\n          <svg class="chatGptToPdf-btn-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n          </svg>\n        </button>\n        <div id="chatGptToPdf-dropdown-menu" class="chatGptToPdf-dropdown-menu chatGptToPdf-hidden">\n          \x3c!-- Primary Actions --\x3e\n          <div class="chatGptToPdf-menu-section">\n            <div id="chatGptToPdf-save-ai-text-only" class="chatGptToPdf-dropdown-item chatGptToPdf-primary-action">\n              <svg class="chatGptToPdf-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/>\n                <path d="M20 3v4"/>\n                <path d="M22 5h-4"/>\n                <path d="M4 17v2"/>\n                <path d="M5 18H3"/>\n              </svg>\n              ').concat(wh.saveChatGptMessagesOnly,'\n            </div>\n            <div id="chatGptToPdf-select-messages" class="chatGptToPdf-dropdown-item chatGptToPdf-primary-action">\n              <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />\n              </svg>\n              ').concat(wh.selectMessagesToSave,'\n            </div>\n          </div>\n          \x3c!-- Theme --\x3e\n          <div class="chatGptToPdf-menu-section">\n            <div class="chatGptToPdf-theme-toggle" id="chatGptToPdf-theme-toggle">\n              <div style="display:flex;align-items:center;">\n                <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />\n                </svg>\n                ').concat(wh.theme,'\n              </div>\n              <div class="chatGptToPdf-toggle-switch" id="chatGptToPdf-toggle">\n                <div class="chatGptToPdf-toggle-icons">\n                  <div class="chatGptToPdf-toggle-icon-active">\n                    <svg class="chatGptToPdf-moon-icon" viewBox="0 0 24 24" fill="none">\n                      <path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                    </svg>\n                    <svg class="chatGptToPdf-sun-icon" viewBox="0 0 24 24" fill="none">\n                      <path d="M12 2V4M12 20V22M4 12H2M6.31412 6.31412L4.8999 4.8999M17.6859 6.31412L19.1001 4.8999M6.31412 17.69L4.8999 19.1042M17.6859 17.69L19.1001 19.1042M22 12H20M17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                    </svg>\n                  </div>\n                  <div class="chatGptToPdf-toggle-icon-inactive">\n                    <svg class="chatGptToPdf-sun-icon-inactive" viewBox="0 0 24 24" fill="none">\n                      <path d="M12 2V4M12 20V22M4 12H2M6.31412 6.31412L4.8999 4.8999M17.6859 6.31412L19.1001 4.8999M6.31412 17.69L4.8999 19.1042M17.6859 17.69L19.1001 19.1042M22 12H20M17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                    </svg>\n                    <svg class="chatGptToPdf-moon-icon-inactive" viewBox="0 0 24 24" fill="none">\n                      <path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class="chatGptToPdf-dropdown-item chatGptToPdf-font-selector" id="chatGptToPdf-font-selector">\n              <div style="display:flex;align-items:center;">\n                <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" d="M4.098 19.902a3.75 3.75 0 005.304 0l6.401-6.402M6.75 21A3.75 3.75 0 013 17.25V4.125C3 3.504 3.504 3 4.125 3h5.25c.621 0 1.125.504 1.125 1.125v4.072M6.75 21a3.75 3.75 0 003.75-3.75V8.197m0 0V4.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v13.125c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125V8.197z"/>\n                </svg>\n                Font\n              </div>\n              <div class="chatGptToPdf-font-dropdown">\n                <select id="chatGptToPdf-font-select" class="chatGptToPdf-select">\n                  <option value="default" selected="selected">Default</option>\n                  <option value="timesNewRoman">Times New Roman</option>\n                  <option value="arial">Arial</option>\n                  <option value="calibri">Calibri</option>\n                  <option value="helvetica">Helvetica</option>\n                </select>\n                <svg class="chatGptToPdf-select-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                  <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                </svg>\n              </div>\n            </div>\n            <div class="chatGptToPdf-dropdown-item chatGptToPdf-font-size-selector" id="chatGptToPdf-font-size-selector">\n              <div style="display:flex;align-items:center;">\n                <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"/>\n                </svg>\n                Font Size\n              </div>\n              <div class="chatGptToPdf-font-size-dropdown">\n                <select id="chatGptToPdf-font-size-select" class="chatGptToPdf-select">\n                  <option value="small">Small</option>\n                  <option value="normal" selected="selected">Normal</option>\n                  <option value="large">Large</option>\n                  <option value="extraLarge">Extra Large</option>\n                </select>\n                <svg class="chatGptToPdf-select-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                  <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                </svg>\n              </div>\n            </div>\n          </div>\n          \x3c!-- Account --\x3e\n          <div class="chatGptToPdf-menu-section">\n            <div id="chatGptToPdf-manage-subscription" class="chatGptToPdf-dropdown-item">\n              <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" />\n                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />\n              </svg>\n              ').concat(wh.manageSubscription,'\n            </div>\n            <div id="chatGptToPdf-contact-support" class="chatGptToPdf-dropdown-item">\n              <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n              </svg>\n              ').concat(wh.contactSupport,'\n            </div>\n            <div id="chatGptToPdf-manage-subscription-separator" class="chatGptToPdf-menu-separator" style="display: none;"></div>\n            <div id="chatGptToPdf-logout-subscription" class="chatGptToPdf-dropdown-item">\n              <svg class="chatGptToPdf-icon" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />\n              </svg>\n              ').concat(wh.logOut,'\n            </div>\n          </div>\n          \x3c!-- Support + Rate --\x3e\n          <div class="chatGptToPdf-menu-section">\n            <div class="chatGptToPdf-flex-group">\n              <div id="chatGptToPdf-needHelp">').concat(wh.needHelp,'</div>\n              <div id="chatGptToPdf-report-issue">').concat(wh.reportAnIssue,'</div>\n            </div>\n            <div id="chatGptToPdf-rate-us" class="chatGptToPdf-rate-us-standalone">\n              ').concat(wh.rateUs,"\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    "),i=a();window.addEventListener("message",function(e){var t,i,n,s;"state"===(null===(t=e.data)||void 0===t?void 0:t.type)&&["https://onlineapp.pro","https://onlineapp.live","https://onlineapp.stream"].includes(e.origin)&&(null!==(i=null==bh?void 0:bh.id)&&void 0!==i?i:null)!==(null!==(n=null===(s=e.data)||void 0===s||null===(s=s.state)||void 0===s||null===(s=s.user)||void 0===s?void 0:s.id)&&void 0!==n?n:null)&&c()}),setInterval(function(){i&&(document.querySelector('main div[role="presentation"]')?i.classList.remove("chatGptToPdf-hidden"):i.classList.add("chatGptToPdf-hidden"))},1e3),setInterval(function(){var e=document.querySelector(".chatGptToPdf-block");if(window.location.href.startsWith("https://chatgpt.com/gpts"))e&&e.remove();else{var t=document.querySelector('button[data-testid="share-chat-button"]'),i=document.querySelector('button[data-testid="profile-button"]');if(e)if(t){if(t.previousElementSibling!==e)return e.remove(),void a();e.classList.remove("chatGptToPdf-fixed-position"),e.style.right=""}else{var n;i&&null!==(n=i.parentNode)&&void 0!==n&&n.contains(e)?(e.classList.remove("chatGptToPdf-fixed-position"),e.style.right=""):e.classList.contains("chatGptToPdf-fixed-position")?function(){var e=document.querySelector("div.flex.flex-col.text-sm.md\\:pb-9");if(e){var t=e.parentElement;if(t)return t.scrollHeight>t.clientHeight}return!1}()?e.style.right="180px":e.style.right="165px":(e.remove(),a())}else a()}},1e3)}function a(){var e,i,a,d,u,h;if(!window.location.href.startsWith("https://chatgpt.com/gpts")){var p=document.createElement("div");p.innerHTML=t.trim();var f=p.firstElementChild,g=document.getElementById("conversation-header-actions"),v=document.querySelector('button[data-testid="share-chat-button"]');if(g&&v){var _;null===(_=v.parentNode)||void 0===_||_.insertBefore(f,v)}else{var m=document.querySelector('button[data-testid="profile-button"]');m&&m.parentNode?m.parentNode.insertBefore(f,m):(f.classList.add("chatGptToPdf-fixed-position"),document.body.appendChild(f))}var y=document.getElementById("chatGptToPdf-convert-main"),b=y.querySelector(".loader"),w=y.querySelector("svg"),x=y.querySelector(".chatGptToPdf-lg"),k=document.getElementById("chatGptToPdf-dropdown-toggle"),S=document.getElementById("chatGptToPdf-dropdown-menu"),P=document.getElementById("chatGptToPdf-toggle"),T=document.getElementById("chatGptToPdf-theme-toggle"),E=document.getElementById("chatGptToPdf-font-select"),C=document.getElementById("chatGptToPdf-font-size-select"),I=document.getElementById("chatGptToPdf-save-ai-text-only"),M=document.getElementById("chatGptToPdf-select-messages");chrome.storage.sync.get(r.FE,function(e){if(!e[r.FE]){var t=document.querySelector(".chatGptToPdf-block");t&&t.classList.remove("chatGptToPdf-glow-permanently-disabled")}});var R=!1,F="light",O="default",L="normal";chrome.storage.sync.get("theme",function(e){"dark"===(F=e.theme||"light")&&P.classList.add("active")}),null==T||T.addEventListener("click",function(){P.classList.toggle("active"),F=P.classList.contains("active")?"dark":"light",chrome.storage.sync.set({theme:F})}),chrome.storage.sync.get("font",function(e){O=e.font||"default";var t,i=vh(E.getElementsByTagName("option"));try{for(i.s();!(t=i.n()).done;){var n=t.value;n.selected=n.value===O}}catch(e){i.e(e)}finally{i.f()}}),null==E||E.addEventListener("change",function(e){var t=e.target;O=t.value,chrome.storage.sync.set({font:O})}),chrome.storage.sync.get("fontSize",function(e){L=e.fontSize||"normal";var t,i=vh(C.getElementsByTagName("option"));try{for(i.s();!(t=i.n()).done;){var n=t.value;n.selected=n.value===L}}catch(e){i.e(e)}finally{i.f()}}),null==C||C.addEventListener("change",function(e){var t=e.target;L=t.value,chrome.storage.sync.set({fontSize:L})}),M.addEventListener("click",function(){R?z():(R=!0,M.textContent=wh.cancelSelection,M.classList.add("chatGptToPdf-cancel-selection"),S.classList.add("chatGptToPdf-hidden"),document.querySelectorAll('div[class*="group/turn-messages"]').forEach(function(e){e.classList.add("chatGptToPdf-selectable-message"),e.addEventListener("click",G)}),(0,n.D)(wh.clickOnMessagesToSelect,!1))}),null===(e=document.getElementById("chatGptToPdf-manage-subscription"))||void 0===e||e.addEventListener("click",function(){window.open(r.qQ,"_blank")}),null===(i=document.getElementById("chatGptToPdf-contact-support"))||void 0===i||i.addEventListener("click",function(){window.open(r.qQ+"?tab=support","_blank")}),null===(a=document.getElementById("chatGptToPdf-logout-subscription"))||void 0===a||a.addEventListener("click",function(){paywall.signOut(),kh("chatGptToPdf-logout-subscription"),kh("chatGptToPdf-logout-subscription-separator")}),null===(d=document.getElementById("chatGptToPdf-needHelp"))||void 0===d||d.addEventListener("click",function(){window.open(r.ZD,"_blank")}),null===(u=document.getElementById("chatGptToPdf-report-issue"))||void 0===u||u.addEventListener("click",function(){window.open(r.bd,"_blank")}),null===(h=document.getElementById("chatGptToPdf-rate-us"))||void 0===h||h.addEventListener("click",function(){l()}),(0,Ju.F6)().then(function(e){var t;t=e.toString(),Qu.identify(t)}),c();var D=function(){chrome.storage.sync.get(r.FE,function(e){e[r.FE]||chrome.storage.sync.set(ph({},r.FE,!0),function(){var e=document.querySelector(".chatGptToPdf-block");e&&e.classList.add("chatGptToPdf-glow-permanently-disabled")})})};return y.addEventListener("click",gh(uh().m(function e(){return uh().w(function(e){for(;;)switch(e.n){case 0:return D(),y.setAttribute("disabled","true"),I.classList.add("disabled"),b.classList.remove("chatGptToPdf-hidden"),w.classList.add("chatGptToPdf-hidden"),x.classList.add("chatGptToPdf-hidden"),e.n=1,$(!1,R);case 1:return e.a(2)}},e)}))),I.addEventListener("click",gh(uh().m(function e(){return uh().w(function(e){for(;;)switch(e.n){case 0:if(!I.classList.contains("disabled")){e.n=1;break}return e.a(2);case 1:return I.classList.add("disabled"),y.setAttribute("disabled","true"),S.classList.add("chatGptToPdf-hidden"),b.classList.remove("chatGptToPdf-hidden"),w.classList.add("chatGptToPdf-hidden"),x.classList.add("chatGptToPdf-hidden"),e.n=2,$(!0,R);case 2:return e.a(2)}},e)}))),k.addEventListener("click",function(e){if(D(),e.stopPropagation(),S.classList.toggle("chatGptToPdf-hidden"),!S.classList.contains("chatGptToPdf-hidden")){var t=k.getBoundingClientRect();S.style.top="".concat(t.bottom+8,"px"),S.style.right="".concat(window.innerWidth-t.right,"px")}}),document.addEventListener("click",function(){S.classList.add("chatGptToPdf-hidden")}),S.addEventListener("click",function(e){e.stopPropagation()}),f.getElementsByClassName("chatGptToPdf-block")[0]}function z(){R=!1,M.textContent=wh.selectMessagesToSave,M.classList.remove("chatGptToPdf-cancel-selection"),S.classList.add("chatGptToPdf-hidden"),document.querySelectorAll('div[class*="group/turn-messages"]').forEach(function(e){e.classList.remove("chatGptToPdf-selectable-message"),e.removeEventListener("click",G),e.classList.remove("chatGptToPdf-selected-message")})}function G(e){var t;e.stopPropagation(),(t=e.currentTarget).classList.contains("chatGptToPdf-selected-message")?t.classList.remove("chatGptToPdf-selected-message"):t.classList.add("chatGptToPdf-selected-message")}function A(){y.removeAttribute("disabled"),I.classList.remove("disabled"),b.classList.add("chatGptToPdf-hidden"),w.classList.remove("chatGptToPdf-hidden"),x.classList.remove("chatGptToPdf-hidden")}function $(){return B.apply(this,arguments)}function B(){return B=gh(uh().m(function e(){var t,i,a,d,u,h,p,f,g,v,_,m,y,b,w,x,k,S,P,T,E,C=arguments;return uh().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=C.length>0&&void 0!==C[0]&&C[0],i=C.length>1&&void 0!==C[1]&&C[1],a=C.length>2&&void 0!==C[2]?C[2]:1,e.n=1,(0,Ju.F6)();case 1:return d=e.v,e.p=2,e.n=3,c();case 3:if(bh.paid){e.n=5;break}return e.n=4,paywall.open({resolveEvent:"success-purchase"});case 4:bh.paid=!0;case 5:e.n=17;break;case 6:if(e.p=6,(E=e.v).visibility_status_reason){e.n=10;break}if(3!=a){e.n=7;break}return A(),(0,n.D)("An error occurred, try again later"),e.a(2);case 7:return u=E.message,chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"paywallUnknownError",properties:{paywallUserId:bh.id,email:bh.email,statusReason:u}}}),e.n=8,new Promise(function(e){return setTimeout(e,300)});case 8:return e.n=9,$(t,i,a+1);case 9:return e.a(2);case 10:if("error"!=(h=E.visibility_status_reason)){e.n=14;break}if(3!=a){e.n=11;break}return A(),(0,n.D)("An error occurred, try again later"),chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"paywallFatalError",properties:{paywallUserId:bh.id,email:bh.email,statusReason:h}}}),e.a(2);case 11:return chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"paywallError",properties:{paywallUserId:bh.id,email:bh.email,statusReason:h}}}),e.n=12,new Promise(function(e){return setTimeout(e,300)});case 12:return e.n=13,$(t,i,a+1);case 13:return e.a(2);case 14:if(mh.includes(h)){e.n=16;break}return A(),(0,n.D)(wh.subscriptionIsRequired,!1),e.n=15,chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"noSubscriptionRequest",properties:{paywallUserId:bh.id,email:bh.email,statusReason:h}}});case 15:return e.a(2);case 16:"openings-trial"==h&&(bh.paid=!1);case 17:return e.n=18,(0,s.B)(t,i);case 18:p=e.v,f=p.title,g=p.html,v=p.textDocMessages,_="full",i&&(_="selected"),t&&(_="aiTextOnly"),m={title:f,html:g,textDocMessages:Object.fromEntries(v)},y={theme:F,font:O,fontSize:L,showWatermark:yh},b=0,w=vh(v.values());try{for(w.s();!(x=w.n()).done;){k=x.value,S=vh(k);try{for(S.s();!(P=S.n()).done;)T=P.value,b+=T.length}catch(e){S.e(e)}finally{S.f()}}}catch(e){w.e(e)}finally{w.f()}if(!(Math.floor((g.length+f.length+b)/1024)<2e3)||(0,s.M)(g)){e.n=19;break}chrome.runtime.sendMessage({action:r.bL,data:{contentData:m,params:y,userInfo:bh,metricInfo:{pdfPrintType:_,font:O,fontSize:L}}},function(e){A(),e&&e.error?(0,n.D)(e.error):(R&&z(),o(function(e){e&&l()}))}),e.n=23;break;case 19:return e.n=20,chrome.storage.sync.get(r.RB);case 20:if(e.v[r.RB]){e.n=22;break}return e.n=21,chrome.storage.sync.set(ph({},r.RB,!0));case 21:return e.n=22,us();case 22:chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"startGeneratePdf",properties:{paywallUserId:bh.id,email:bh.email}}}),(0,Ku.j)(f,g,v).then(gh(uh().m(function e(){return uh().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,sh();case 1:A(),R&&z(),o(function(e){e&&l()}),chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"successGeneratePdf",properties:{paywallUserId:bh.id,email:bh.email}}});case 2:return e.a(2)}},e)}))).catch(function(){var e=gh(uh().m(function e(t){return uh().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,oh();case 1:A(),(0,n.D)("Failed to generate PDF"),chrome.runtime.sendMessage({action:r.Xd,data:{userId:d,eventType:"failedGeneratePdf",properties:{paywallUserId:bh.id,email:bh.email,statusReason:t.message}}});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 23:return e.a(2)}},e,null,[[2,6]])})),B.apply(this,arguments)}}function c(){return d.apply(this,arguments)}function d(){return(d=gh(uh().m(function e(){var t,i,n;return uh().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,paywall.getUser();case 1:n=e.v,bh.countryMatch=n.countryMatch,bh.country=n.country,bh.id=null!==(t=null===(i=n.user)||void 0===i?void 0:i.id)&&void 0!==t?t:null,n.error?(kh("chatGptToPdf-logout-subscription"),kh("chatGptToPdf-logout-subscription-separator"),n.countryMatch||(yh=!0,kh("chatGptToPdf-manage-subscription"),kh("chatGptToPdf-contact-support"),kh("chatGptToPdf-manage-subscription-separator"))):(Sh("chatGptToPdf-logout-subscription"),Sh("chatGptToPdf-logout-subscription-separator"),bh.email=n.user.email,bh.paid=n.paid,n.subscriptions&&n.subscriptions.length>0?(bh.currentPeriodStart=n.subscriptions[0].current_period_start,bh.currentPeriodEnd=n.subscriptions[0].current_period_end,bh.cancelAtPeriodEnd=n.subscriptions[0].cancel_at_period_end,bh.isLifetime=!1):bh.isLifetime=!0);case 2:return e.a(2)}},e)}))).apply(this,arguments)}}function kh(e){var t=document.getElementById(e);t&&(t.style.display="none")}function Sh(e){var t=document.getElementById(e);t&&"none"===t.style.display&&(t.style.display="")}},167:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(407),s=i(823),r=null,o=null,a=0;const l=function(e,t,i){e=e||{};var l=t&&i||0,c=t||new Uint8Array(16),d=e.random||(e.rng||n.A)(),u=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.seq?e.seq:null,p=o,f=r;return u>a&&void 0===e.msecs&&(a=u,null!==h&&(p=null,f=null)),null!==h&&(h>2147483647&&(h=2147483647),p=h>>>19&4095,f=524287&h),null!==p&&null!==f||(p=(p=127&d[6])<<8|d[7],f=(f=(f=63&d[8])<<8|d[9])<<5|d[10]>>>3),u+1e4>a&&null===h?++f>524287&&(f=0,++p>4095&&(p=0,a++)):a=u,o=p,r=f,c[l++]=a/1099511627776&255,c[l++]=a/4294967296&255,c[l++]=a/16777216&255,c[l++]=a/65536&255,c[l++]=a/256&255,c[l++]=255&a,c[l++]=p>>>4&15|112,c[l++]=255&p,c[l++]=f>>>13&63|128,c[l++]=f>>>5&255,c[l++]=f<<3&255|7&d[10],c[l++]=d[11],c[l++]=d[12],c[l++]=d[13],c[l++]=d[14],c[l++]=d[15],t||(0,s.k)(c)}},216:(e,t,i)=>{i.d(t,{F6:()=>r});var n=i(664),s=i(167);function r(){return new Promise(function(e,t){chrome.storage.local.get(n.iw,function(i){if(chrome.runtime.lastError)return t(chrome.runtime.lastError);var n=i.userId;n?e(n):(n=(0,s.A)(),chrome.storage.local.set({userId:n},function(){if(chrome.runtime.lastError)return t(chrome.runtime.lastError);e(n)}))})})}},382:(e,t,i)=>{function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=document.createElement("div");i.className="my-extension-toast",i.textContent=e,t||(i.style.background="green"),document.body.appendChild(i),requestAnimationFrame(function(){i.classList.add("show")}),setTimeout(function(){i.classList.remove("show"),i.addEventListener("transitionend",function(){i.remove()})},2e3)}i.d(t,{D:()=>n})},407:(e,t,i)=>{var n;i.d(t,{A:()=>r});var s=new Uint8Array(16);function r(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)}},554:(e,t,i)=>{i.a(e,async(e,t)=>{try{var n=i(36),s=i(865);function r(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function a(i,n,s,r){var a=n&&n.prototype instanceof c?n:c,d=Object.create(a.prototype);return o(d,"_invoke",function(i,n,s){var r,o,a,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,o=0,a=e,h.n=i,l}};function p(i,n){for(o=i,a=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(a=r[(o=r[4])?5:(o=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(o=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,o=0))}if(s||i>1)return l;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),o=d,a=f;(t=o<2?e:a)||!u;){r||(o?o<3?(o>1&&(h.n=-1),p(o,a)):h.n=a:h.v=a);try{if(c=2,r){if(o||(s="next"),t=r[s]){if(!(t=t.call(r,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,o<2&&(o=0)}else 1===o&&(t=r.return)&&t.call(r),o<2&&(a=TypeError("The iterator does not provide a '"+s+"' method"),o=1);r=e}else if((t=(u=h.n<0)?a:i.call(n,h))!==l)break}catch(t){r=e,o=1,a=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),d}var l={};function c(){}function d(){}function u(){}t=Object.getPrototypeOf;var h=[][n]?t(t([][n]())):(o(t={},n,function(){return this}),t),p=u.prototype=c.prototype=Object.create(h);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,o(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,o(p,"constructor",u),o(u,"constructor",d),d.displayName="GeneratorFunction",o(u,s,"GeneratorFunction"),o(p),o(p,s,"Generator"),o(p,n,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:a,m:f}})()}function o(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}o=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){o(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},o(e,t,i,n)}function a(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function l(e){return c.apply(this,arguments)}function c(){var e;return e=r().m(function e(t){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){return setTimeout(e,t)}))},e)}),c=function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){a(r,n,s,o,l,"next",e)}function l(e){a(r,n,s,o,l,"throw",e)}o(void 0)})},c.apply(this,arguments)}await l(1e3),setTimeout(function(){(0,n.T)(),(0,s.I)()},500),t()}catch(d){t(d)}},1)},664:(e,t,i)=>{i.d(t,{Dn:()=>m,FE:()=>v,Oq:()=>p,RB:()=>g,VE:()=>f,XJ:()=>c,Xd:()=>y,ZD:()=>o,ae:()=>n,bL:()=>_,bd:()=>r,i3:()=>u,iw:()=>d,ix:()=>l,qQ:()=>s,uk:()=>a,xt:()=>h});var n="https://chromewebstore.google.com/detail/chatgpt-to-pdf/hiiildgldbpfbegcfgemoliikibfhaeh/reviews",s="https://onlineapp.pro/paywall/343/customer-portal/get",r="https://forms.gle/NFitTYaDEbcVbdMa7",o="https://www.chatgpt2pdf.app/faq",a="https://www.chatgpt2pdf.app/improve",l="https://eu.i.posthog.com",c="phc_QsGf4ScUul0ZSUq6uWGb3xOLtegD6pGD4rTI0Scz8B8",d="userId",u="successCount",h="failureCount",p="hasRated",f="lastRatePrompt",g="showPopupNewsDownloadBigFiles",v="glowEffectDisabled",_="generate_pdf_from_html",m="open_new_tab",y="send_event"},807:(e,t,i)=>{function n(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"light";return new Promise(function(s,r){var o,a,l=document.createElement("iframe");l.style.position="absolute",l.style.left="-10000px",l.style.top="0",l.style.width="0",l.style.height="0",l.style.border="none",document.body.appendChild(l);var c=l.contentDocument||(null===(o=l.contentWindow)||void 0===o?void 0:o.document);if(!c){var d=new Error("Unable to access iframe document");return document.body.removeChild(l),r(d)}var u="dark"===n?"#FFFFFF":"#000000",h="\n  @media print {\n    body {\n      -webkit-print-color-adjust: exact;\n      margin: 0;\n    }\n    @page {\n      background-color: ".concat("dark"===n?"#212121":"#FFFFFF",'; \n      margin: 0.5in 0.5in 0.5in 0.5in; /* top, right, bottom, left */\n      @bottom-center {\n        content: counter(page) "/" counter(pages);\n        font-size: 10pt;\n        color: ').concat(u,";\n      }\n    }\n  }\n  "),p='\n  <div class="content-wrapper">\n    '.concat(t,"\n  </div>\n  ");c.open(),c.write("<!DOCTYPE html>\n  <html>\n    <head>\n      <title>".concat(e,"</title>\n      <style>\n        ").concat(h,"\n      </style>\n    </head>\n    <body>\n      ").concat(p,"\n    </body>\n  </html>\n  ")),c.close(),null===(a=l.contentWindow)||void 0===a||a.addEventListener("afterprint",function(){try{document.body.removeChild(l)}catch(e){}s(null)}),l.onload=function(){try{var e,t,s=c.documentElement;if(s.hasAttribute("dir")||s.setAttribute("dir","ltr"),c.querySelectorAll('div[class*="group/turn-messages"]').forEach(function(e){e.classList.remove("chatGptToPdf-selected-message","chatGptToPdf-selectable-message")}),s.classList.remove("light","dark"),"light"===n?(s.classList.add("light"),s.style.colorScheme="light",c.querySelectorAll(".dark").forEach(function(e){e.classList.remove("dark"),e.classList.add("light")})):(s.classList.add("dark"),s.style.colorScheme="dark",c.querySelectorAll(".light").forEach(function(e){e.classList.remove("light"),e.classList.add("dark")})),c.querySelectorAll("button").forEach(function(e){e.querySelector("img")||e.remove()}),c.querySelectorAll("code").forEach(function(e){e.style.setProperty("white-space","pre-wrap","important")}),i){var o=new Map(Object.entries(i));c.querySelectorAll('div[role="button"][id^="textdoc-message"]').forEach(function(e){var t=e.querySelector(".cm-content");if(t){var i=o.get(e.id);i&&(t.innerHTML=i.join(""));var n=c.createElement("div");n.className="cm-line",n.innerHTML=" ",t.appendChild(n)}e.querySelectorAll(".cm-gutters").forEach(function(e){return e.remove()});var s=e.lastElementChild;s&&s.classList.contains("transition-colors")&&s.remove(),e.style.height="auto"})}null===(e=l.contentWindow)||void 0===e||e.focus(),null===(t=l.contentWindow)||void 0===t||t.print()}catch(e){try{document.body.removeChild(l)}catch(e){}r(e)}}})}i.d(t,{j:()=>n})},823:(e,t,i)=>{i.d(t,{k:()=>r});for(var n=[],s=0;s<256;++s)n.push((s+256).toString(16).slice(1));function r(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}},865:(e,t,i)=>{i.d(t,{I:()=>R});var n=i(382),s=i(807),r=i(976),o=i(664),a=i(216);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],i=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}throw new TypeError(l(e)+" is not iterable")}function d(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return u(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function h(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function r(i,n,s,r){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return p(c,"_invoke",function(i,n,s){var r,a,l,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,a=0,l=e,h.n=i,o}};function p(i,n){for(a=i,l=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(l=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(a=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,a=0))}if(s||i>1)return o;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),a=d,l=f;(t=a<2?e:l)||!u;){r||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,r){if(a||(s="next"),t=r[s]){if(!(t=t.call(r,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=r.return)&&t.call(r),a<2&&(l=TypeError("The iterator does not provide a '"+s+"' method"),a=1);r=e}else if((t=(u=h.n<0)?l:i.call(n,h))!==o)break}catch(t){r=e,a=1,l=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),c}var o={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(p(t={},n,function(){return this}),t),u=c.prototype=a.prototype=Object.create(d);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,p(e,s,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,p(u,"constructor",c),p(c,"constructor",l),l.displayName="GeneratorFunction",p(c,s,"GeneratorFunction"),p(u),p(u,s,"Generator"),p(u,n,function(){return this}),p(u,"toString",function(){return"[object Generator]"}),(h=function(){return{w:r,m:f}})()}function p(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}p=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){p(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},p(e,t,i,n)}function f(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function g(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){f(r,n,s,o,a,"next",e)}function a(e){f(r,n,s,o,a,"throw",e)}o(void 0)})}}var v=["openings-trial","country-not-match","active-payment-found","success-payment"],_={id:"",email:"",paid:!1,countryMatch:!0};function m(){return y.apply(this,arguments)}function y(){return(y=g(h().m(function e(){var t,i;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,paywall.getUser();case 1:t=e.v,_.id=t.id,_.email=t.email,_.paid=t.paid,e.n=3;break;case 2:e.p=2,i=e.v,console.error("Error updating user info:",i);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}var b=!1,w=null;function x(){var e="";return document.querySelectorAll('link[rel="stylesheet"]').forEach(function(t){var i=t.getAttribute("href");if(i)try{var n=new XMLHttpRequest;n.open("GET",i,!1),n.send(null),200===n.status&&(e+=n.responseText)}catch(e){console.log("Could not fetch stylesheet:",i)}}),document.querySelectorAll("style").forEach(function(t){e+=t.innerHTML}),e}function k(e,t){var i=e.querySelector(".chatGptToPdf-download-icon"),n=e.querySelector(".chatGptToPdf-spinner-icon"),s=e;t?(i.style.display="none",n.style.display="block",s.disabled=!0,s.style.cursor="not-allowed"):(i.style.display="block",n.style.display="none",s.disabled=!1,s.style.cursor="pointer")}function S(e){return P.apply(this,arguments)}function P(){return(P=g(h().m(function e(t){var i,n,s,r,o,a,l;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:i=new DOMParser,n=i.parseFromString(t,"text/html"),s=n.querySelectorAll("img"),r=d(s),e.p=1,a=h().m(function e(){var t,i,n,s,r,a,l;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=o.value,!(i=t.getAttribute("src"))||!i.includes("chatgpt.com/backend-api")){e.n=7;break}return e.p=1,e.n=2,fetch(i,{credentials:"include",mode:"cors"});case 2:if(!(n=e.v).ok){e.n=5;break}return e.n=3,n.blob();case 3:return s=e.v,r=new FileReader,e.n=4,new Promise(function(e){r.onloadend=function(){return e(r.result)},r.readAsDataURL(s)});case 4:a=e.v,t.setAttribute("src",a);case 5:e.n=7;break;case 6:e.p=6,l=e.v,console.warn("Failed to convert image:",i,l);case 7:return e.a(2)}},e,null,[[1,6]])}),r.s();case 2:if((o=r.n()).done){e.n=4;break}return e.d(c(a()),3);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,l=e.v,r.e(l);case 6:return e.p=6,r.f(),e.f(6);case 7:return e.a(2,n.documentElement.outerHTML)}},e,null,[[1,5,6,7]])}))).apply(this,arguments)}function T(e){var t=e.cloneNode(!0);t.querySelectorAll(".chatGptToPdf-message-export-btn").forEach(function(e){return e.remove()}),t.querySelectorAll(".chatGptToPdf-message-button-container").forEach(function(e){return e.remove()}),t.querySelectorAll("h6.sr-only").forEach(function(e){return e.remove()});var i,n=t.querySelector('[data-message-author-role="assistant"]');return i=n&&n.parentElement?n.parentElement.outerHTML:t.outerHTML,{title:((null==n?void 0:n.textContent)||t.textContent||"").substring(0,50).replace(/[^a-zA-Z0-9 ]/g,"")+"...",html:i}}function E(e,t){return C.apply(this,arguments)}function C(){return C=g(h().m(function e(t,i){var l,c,d,u,p,f,g,y,b,w,P,C,I,M,R,F,O,L,D,z,G,A,$=arguments;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=$.length>2&&void 0!==$[2]?$[2]:1,e.n=1,(0,a.F6)();case 1:return c=e.v,k(i,!0),e.p=2,e.n=3,m();case 3:if(_.paid){e.n=17;break}return e.p=4,e.n=5,paywall.open({resolveEvent:"success-purchase"});case 5:_.paid=!0,e.n=17;break;case 6:if(e.p=6,(G=e.v).visibility_status_reason){e.n=10;break}if(!(l>=3)){e.n=7;break}return k(i,!1),(0,n.D)("An error occurred, try again later"),e.a(2);case 7:return chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"paywallUnknownError_messageExport",properties:{paywallUserId:_.id,email:_.email,statusReason:G.message}}}),e.n=8,new Promise(function(e){return setTimeout(e,300)});case 8:return e.n=9,E(t,i,l+1);case 9:return e.a(2);case 10:if("error"!==(u=G.visibility_status_reason)){e.n=14;break}if(!(l>=3)){e.n=11;break}return k(i,!1),(0,n.D)("An error occurred, try again later"),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"paywallFatalError_messageExport",properties:{paywallUserId:_.id,email:_.email,statusReason:u}}}),e.a(2);case 11:return chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"paywallError_messageExport",properties:{paywallUserId:_.id,email:_.email,statusReason:u}}}),e.n=12,new Promise(function(e){return setTimeout(e,300)});case 12:return e.n=13,E(t,i,l+1);case 13:return e.a(2);case 14:if("user-exited"!==u){e.n=15;break}return k(i,!1),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"paywallUserExited_messageExport",properties:{paywallUserId:_.id,email:_.email}}}),e.a(2);case 15:if(v.includes(u)){e.n=16;break}return k(i,!1),(0,n.D)("Get unlimited access with Pro! ",!1),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"noSubscriptionRequest_messageExport",properties:{paywallUserId:_.id,email:_.email,statusReason:u}}}),e.a(2);case 16:"openings-trial"===u&&(_.paid=!1);case 17:return p=T(t),f=p.title,g=p.html,e.n=18,S(g);case 18:return y=e.v,e.n=19,chrome.storage.sync.get("theme");case 19:return b=e.v,w=b.theme||"light",e.n=20,chrome.storage.sync.get(["font","fontSize"]);case 20:P=e.v,C=P.font||"default",I=P.fontSize||"normal",M=x(),R=null!==(d=document.documentElement.getAttribute("dir"))&&void 0!==d?d:"ltr",F='\n            <!DOCTYPE html>\n            <html dir="'.concat(R,'" class="').concat(w,'">\n              <head>\n                <meta charSet="utf-8"/>\n                <title>').concat(f,"</title>\n                <style>\n                    ").concat(M,'\n                    /* Remove borders and lines that appear above images */\n                    [data-message-author-role="assistant"],\n                    [data-message-author-role="assistant"] > div:first-child,\n                    div[class*="group/turn-messages"] {\n                        border-top: none !important;\n                        border-bottom: none !important;\n                    }\n                    [data-message-author-role="assistant"]::before,\n                    [data-message-author-role="assistant"]::after,\n                    div[class*="group/turn-messages"]::before,\n                    div[class*="group/turn-messages"]::after {\n                        display: none !important;\n                    }\n                    /* Remove any horizontal rules or dividers */\n                    hr {\n                        display: none !important;\n                    }\n                </style>\n              </head>\n              <body>\n                <div class="markdown prose w-full break-words dark:prose-invert light">\n                    ').concat(y,"\n                </div>\n              </body>\n            </html>\n        "),O=Math.floor((F.length+f.length)/1024),L=(0,r.M)(F),O<2e3&&!L?(D={title:"ChatGPT Response - "+f,html:F,textDocMessages:{}},z={theme:w,font:C,fontSize:I,showWatermark:!1},chrome.runtime.sendMessage({action:o.bL,data:{contentData:D,params:z,userInfo:{paid:!0},metricInfo:{pdfPrintType:"singleMessage",font:C,fontSize:I}}},function(e){k(i,!1),e&&e.error?((0,n.D)(e.error),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"messageExportFailed_remote",properties:{error:e.error,theme:w,font:C,fontSize:I}}})):((0,n.D)("PDF exported successfully",!1),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"messageExportSuccess_remote",properties:{theme:w,font:C,fontSize:I,contentSize:O}}}))})):(0,s.j)("ChatGPT Response - "+f,F,void 0,w).then(function(){k(i,!1),(0,n.D)("PDF exported successfully",!1),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"messageExportSuccess_local",properties:{theme:w,font:C,fontSize:I,contentSize:O}}})}).catch(function(e){k(i,!1),(0,n.D)("Failed to generate PDF"),console.error("PDF generation error:",e),chrome.runtime.sendMessage({action:o.Xd,data:{userId:c,eventType:"messageExportFailed_local",properties:{error:e.message,theme:w,font:C,fontSize:I}}})}),e.n=22;break;case 21:e.p=21,A=e.v,k(i,!1),console.error("Error exporting message:",A),(0,n.D)("Failed to export message");case 22:return e.a(2)}},e,null,[[4,6],[2,21]])})),C.apply(this,arguments)}function I(e){if(e.querySelector('[data-message-author-role="assistant"]')&&!e.querySelector(".chatGptToPdf-message-button-container")){var t=e.querySelector('[data-message-author-role="assistant"]');if(t){var i=document.createElement("div");i.className="chatGptToPdf-message-button-container";var n,s=((n=document.createElement("button")).className="chatGptToPdf-message-export-btn",n.innerHTML='\n        <svg class="chatGptToPdf-download-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" width="20" height="20" stroke-width="1.5" stroke="currentColor">\n            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />\n        </svg>\n        <svg class="chatGptToPdf-spinner-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" width="20" height="20">\n            <circle class="chatGptToPdf-spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n            <path class="chatGptToPdf-spinner-path" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n        </svg>\n        <span class="chatGptToPdf-tooltip">Export Message as PDF</span>\n    ',n);s.addEventListener("click",function(t){t.stopPropagation(),E(e,s)}),s.addEventListener("mouseenter",function(){e.classList.add("chatGptToPdf-message-highlight")}),s.addEventListener("mouseleave",function(){e.classList.remove("chatGptToPdf-message-highlight")}),i.appendChild(s);var r=t.parentElement;r&&r.appendChild(i)}}}function M(){for(var e=null,t=0,i=['article[data-testid*="conversation-turn"]','div[class*="group/conversation-turn"]',"div[data-turn-id]","article[data-turn-id]","div.group\\/conversation-turn",".text-base"];t<i.length;t++){var n=i[t];if((e=document.querySelectorAll(n)).length>0){console.log("ChatGPT to PDF: Found ".concat(e.length," messages with selector: ").concat(n));break}}e&&e.length>0?(e.forEach(function(e){I(e)}),b=!0):console.log("ChatGPT to PDF: No message containers found")}function R(){M(),function(){w&&w.disconnect(),w=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(e.nodeType===Node.ELEMENT_NODE){var t,i,n,s,r=e;((null===(t=r.matches)||void 0===t?void 0:t.call(r,'article[data-testid*="conversation-turn"]'))||(null===(i=r.matches)||void 0===i?void 0:i.call(r,'div[class*="group/conversation-turn"]'))||(null===(n=r.matches)||void 0===n?void 0:n.call(r,"article[data-turn-id]"))||(null===(s=r.matches)||void 0===s?void 0:s.call(r,"div[data-turn-id]")))&&I(r),['article[data-testid*="conversation-turn"]','div[class*="group/conversation-turn"]',"article[data-turn-id]","div[data-turn-id]"].forEach(function(e){r.querySelectorAll(e).forEach(function(e){I(e)})})}})})});var e=document.querySelector("main")||document.body;e&&w.observe(e,{childList:!0,subtree:!0})}(),setInterval(function(){b&&0!==document.querySelectorAll(".chatGptToPdf-message-export-btn").length||M()},2e3)}},976:(e,t,i)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function s(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],i=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}throw new TypeError(n(e)+" is not iterable")}function r(){var e,t,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function a(i,n,s,r){var a=n&&n.prototype instanceof c?n:c,d=Object.create(a.prototype);return o(d,"_invoke",function(i,n,s){var r,o,a,c=0,d=s||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return r=t,o=0,a=e,h.n=i,l}};function p(i,n){for(o=i,a=n,t=0;!u&&c&&!s&&t<d.length;t++){var s,r=d[t],p=h.p,f=r[2];i>3?(s=f===n)&&(a=r[(o=r[4])?5:(o=3,3)],r[4]=r[5]=e):r[0]<=p&&((s=i<2&&p<r[1])?(o=0,h.v=n,h.n=r[1]):p<f&&(s=i<3||r[0]>n||n>f)&&(r[4]=i,r[5]=n,h.n=f,o=0))}if(s||i>1)return l;throw u=!0,n}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,f),o=d,a=f;(t=o<2?e:a)||!u;){r||(o?o<3?(o>1&&(h.n=-1),p(o,a)):h.n=a:h.v=a);try{if(c=2,r){if(o||(s="next"),t=r[s]){if(!(t=t.call(r,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,o<2&&(o=0)}else 1===o&&(t=r.return)&&t.call(r),o<2&&(a=TypeError("The iterator does not provide a '"+s+"' method"),o=1);r=e}else if((t=(u=h.n<0)?a:i.call(n,h))!==l)break}catch(t){r=e,o=1,a=t}finally{c=1}}return{value:t,done:u}}}(i,s,r),!0),d}var l={};function c(){}function d(){}function u(){}t=Object.getPrototypeOf;var h=[][n]?t(t([][n]())):(o(t={},n,function(){return this}),t),p=u.prototype=c.prototype=Object.create(h);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,o(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,o(p,"constructor",u),o(u,"constructor",d),d.displayName="GeneratorFunction",o(u,s,"GeneratorFunction"),o(p),o(p,s,"Generator"),o(p,n,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:a,m:f}})()}function o(e,t,i,n){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}o=function(e,t,i,n){if(t)s?s(e,t,{value:i,enumerable:!n,configurable:!n,writable:!n}):e[t]=i;else{var r=function(t,i){o(e,t,function(e){return this._invoke(t,i,e)})};r("next",0),r("throw",1),r("return",2)}},o(e,t,i,n)}function a(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return l(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function c(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}function d(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function o(e){c(r,n,s,o,a,"next",e)}function a(e){c(r,n,s,o,a,"throw",e)}o(void 0)})}}function u(){return h.apply(this,arguments)}function h(){return h=d(r().m(function e(){var t,i,n,o,l,c,u,h,p,f,g,v,_,m,y=arguments;return r().w(function(e){for(;;)switch(e.n){case 0:return u=function(){return(u=d(r().m(function e(){var t,i,n,o,l,c,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:t=new Map,i=document.querySelectorAll('div[id^="textdoc-message"]'),n=a(i),e.p=1,l=r().m(function e(){var i,n,a,l,c,d;return r().w(function(e){for(;;)switch(e.n){case 0:if(i=o.value,n=i.querySelector(".cm-content")){e.n=1;break}return e.a(2,1);case 1:return n.firstElementChild&&n.firstElementChild.scrollIntoView(),e.n=2,new Promise(function(e){return setTimeout(e,100)});case 2:a=new Set,l=0,c=30,d=r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.n){case 0:if(Array.from(n.children).forEach(function(e){e.classList.contains("cm-gap")?e===n.lastElementChild&&(t=e):a.has(e)||a.add(e)}),t){e.n=1;break}return e.a(2,0);case 1:if(a.size!==l){e.n=2;break}return e.a(2,0);case 2:l=a.size;case 3:return t.scrollIntoView(),e.n=4,new Promise(function(e){return setTimeout(e,100)});case 4:c--;case 5:return e.a(2)}},e)});case 3:if(!(c>0)){e.n=6;break}return e.d(s(d()),4);case 4:if(0!==e.v){e.n=5;break}return e.a(3,6);case 5:e.n=3;break;case 6:i.id&&t.set(i.id,Array.from(a).map(function(e){return e.outerHTML}));case 7:return e.a(2)}},e)}),n.s();case 2:if((o=n.n()).done){e.n=5;break}return e.d(s(l()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,4);case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,d=e.v,n.e(d);case 7:return e.p=7,n.f(),e.f(7);case 8:return i&&i.length>0&&(null===(c=document.querySelector('div[class*="group/turn-messages"]'))||void 0===c||c.scrollIntoView()),e.a(2,t)}},e,null,[[1,6,7,8]])}))).apply(this,arguments)},c=function(){return u.apply(this,arguments)},l=function(){var e="";return document.querySelectorAll('link[rel="stylesheet"]').forEach(function(t){var i=t.getAttribute("href");if(i){var n=new XMLHttpRequest;n.open("GET",i,!1),n.send(null),200===n.status&&(e+=n.responseText)}}),document.querySelectorAll("style").forEach(function(t){e+=t.innerHTML}),e},o=function(){var e="ChatGPT",t=document.querySelector("head > title");t&&(e=t.innerText);var s,r=null,o=a(document.querySelectorAll("nav div.bg-token-sidebar-surface-secondary"));try{for(o.s();!(s=o.n()).done;){var l,c=null===(l=s.value.querySelector("div.relative.grow"))||void 0===l||null===(l=l.textContent)||void 0===l?void 0:l.trim();if(c){r=c;break}}}catch(e){o.e(e)}finally{o.f()}var d=r&&r!==e?"".concat(e," - ").concat(r):e,u='div[class*="group/turn-messages"]';return i&&(u+='[class*="agent-turn"]'),n&&(u+=".chatGptToPdf-selected-message"),{title:d,content:Array.from(document.querySelectorAll(u)).map(function(e){return e.outerHTML})}},i=y.length>0&&void 0!==y[0]&&y[0],n=y.length>1&&void 0!==y[1]&&y[1],h=o(),p=h.title,f=h.content,g=l(),e.n=1,c();case 1:return v=e.v,_=null!==(t=document.documentElement.getAttribute("dir"))&&void 0!==t?t:"ltr",m='\n    <!DOCTYPE html>\n    <html dir="'.concat(_,'">\n      <head>\n        <meta charSet="utf-8"/>\n        <title>').concat(p,"</title>\n        <style>").concat(g,'</style>\n      </head>\n      <body>\n        <h1 class="main-title">').concat(p,"</h1>\n        <br>\n        ").concat(f.join(""),"\n      </body>\n    </html>\n  "),e.a(2,{title:p,html:m,textDocMessages:v})}},e)})),h.apply(this,arguments)}function p(e){return null!==(new DOMParser).parseFromString(e,"text/html").querySelector("img")}i.d(t,{B:()=>u,M:()=>p})}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return r[e](i,i.exports,a),i.exports}e="function"==typeof Symbol,t=e?Symbol("webpack queues"):"__webpack_queues__",i=e?Symbol("webpack exports"):"__webpack_exports__",n=e?Symbol("webpack error"):"__webpack_error__",s=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},a.a=(e,r,o)=>{var a;o&&((a=[]).d=-1);var l,c,d,u=new Set,h=e.exports,p=new Promise((e,t)=>{d=t,c=e});p[i]=h,p[t]=e=>(a&&e(a),u.forEach(e),p.catch(e=>{})),e.exports=p,r(e=>{var r;l=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[t])return e;if(e.then){var r=[];r.d=0,e.then(e=>{o[i]=e,s(r)},e=>{o[n]=e,s(r)});var o={};return o[t]=e=>e(r),o}}var a={};return a[t]=e=>{},a[i]=e,a}))(e);var o=()=>l.map(e=>{if(e[n])throw e[n];return e[i]}),c=new Promise(e=>{(r=()=>e(o)).r=0;var i=e=>e!==a&&!u.has(e)&&(u.add(e),e&&!e.d&&(r.r++,e.push(r)));l.map(e=>e[t](i))});return r.r?c:o()},e=>(e?d(p[n]=e):c(h),s(a))),a&&a.d<0&&(a.d=0)},a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a(554)})();